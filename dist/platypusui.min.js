"use strict";var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},platui;!function(a){var b="$",c=b+"Promise",d=b+"Compat",e=b+"Regex",f=b+"Window",g=b+"Document",h=b+"Animator",i=b+"DomEventInstance",j=b+"TemplateControlFactory",k=b+"NodeManagerStatic",l="context",m="plat",n=m+"-",o=n+"button",p=n+"checkbox",q=n+"drawer",r=q+"-controller",s=n+"modal",t=n+"progress",u=n+"ring",v=n+"radio",w=n+"toggle",x=n+"slider",y=n+"range",z=n+"select",A=n+"input",B=n+"file",C=n+"carousel",D=n+"listview",E=n+"navbar",F=n+"image",G=n+"hide",H=n+"hidden",I=n+l,J=n+"foreach",K=n+"html",L=n+"disabled",M=m+"Checked",N=m+"Bind",O=m+"Src",P={index:"index",even:"even",odd:"odd",first:"first",last:"last",group:"group"},Q=n+"transition",R=n+"enter",S=n+"leave",T="$tap",U="$touchstart",V="$touchend",W="$touchcancel",X="$swipe",Y="$track",Z="$trackend",$="__plat-button-",_="__plat-radio-",aa="__platDrawerControllerFetch",ba="__platDrawerFound",ca="-reversed",da="literal",ea={right:"left",left:"right",up:"down",down:"up"},fa="src",ga=function(a){return a.preventDefault(),!1},ha=function(){};"undefined"!=typeof window&&("undefined"==typeof window.platui&&(window.platui=a),"undefined"==typeof window.module&&(window.module={}));var ia=function(a){function b(){a.apply(this,arguments),this.replaceWith="button",this._isSelected=!1}return __extends(b,a),b.prototype.setClasses=function(a,b){this.dom.addClass(b||this.element,o+" "+(a||""))},b.prototype.initialize=function(){this.setClasses()},b.prototype.setTemplate=function(){for(var a,b,c=this._document,d=this.element,e=Array.prototype.slice.call(d.childNodes),f=this.utils.isEmpty;e.length>0;)a=e.shift(),a.nodeType===Node.TEXT_NODE?f(a.textContent.trim().match(/[^\r\n]/g))||(b=c.createElement("span"),b.insertBefore(a,null),d.insertBefore(b,null)):d.insertBefore(a,null)},b.prototype.loaded=function(){var a=this.element,b=this.options||{},c=b.value||{},d=c.group,e=this.utils.isString;return e(d)?(this._group=d,this.dom.hasClass(a,n+"selected")&&this._onTap(),void this._addEventListeners()):(d=this.attributes[N],void(e(d)&&(this._group=d,this.dom.hasClass(a,n+"selected")&&this._onTap(),this._addEventListeners())))},b.prototype.observeProperties=function(a){a.observeProperty(this._setBoundProperty)},b.prototype._setBoundProperty=function(a,b,c,d){this.utils.isString(a)&&a===this.element.textContent&&this._onTap()},b.prototype._addEventListeners=function(){var a=this;this.addEventListener(this.element,T,this._onTap,!1),this.on($+this._group,function(){a._isSelected&&(a.dom.removeClass(a.element,n+"selected"),a._isSelected=!1)})},b.prototype._onTap=function(){if(!this._isSelected){var a=this.element;this.dom.addClass(a,n+"selected"),this.dispatchEvent($+this._group,plat.events.EventManager.DIRECT),this._isSelected=!0,this.inputChanged(a.textContent)}},b._inject={_document:g},b}(plat.ui.BindControl);a.Button=ia,plat.register.control(o,ia);var ja=function(a){function b(){a.apply(this,arguments),this.templateString='<div class="plat-toggle-container">\n    <div class="plat-knob"></div>\n</div>\n',this.isActive=!1,this._targetType="slide"}return __extends(b,a),b.prototype.setClasses=function(a,b){this.dom.addClass(b||this.element,w+" "+(a||""))},b.prototype.initialize=function(){this.setClasses()},b.prototype.loaded=function(){var a=this.element;this._targetElement=a.firstElementChild,this.addEventListener(a,T,this._onTap),this._convertChecked()},b.prototype.observeProperties=function(a){a.observeProperty(this._setBoundProperty)},b.prototype._setBoundProperty=function(a,b,c,d){if(a!==b){if(d===!0&&this.utils.isNull(a))return void this.inputChanged(this.isActive);var e=!!a;e!==this.isActive&&this._toggle(d)}},b.prototype._convertChecked=function(){var a=this.element;this.utils.isNull(this.attributes[M])?a.hasAttribute("checked")&&this._convertAttribute(!0):(this._convertAttribute(this.attributes[M]),this.attributes.observe(this._convertAttribute,M))},b.prototype._convertAttribute=function(a,b){var c=this.utils;return c.isBoolean(a)?this._setBoundProperty(a,b,null,!0):void(c.isString(a)&&this._setBoundProperty("true"===a,"true"===b,null,!0))},b.prototype._onTap=function(a){this._toggle(!0),this._trigger("change")},b.prototype._trigger=function(a){var b=plat.acquire(i);b.initialize(this.element,a),b.trigger()},b.prototype._toggle=function(a){var b=this.isActive,c=!b,d=this.element;this._activate(this._targetElement||(this._targetElement=d.firstElementChild)),this.isActive=d.checked=c,c?d.setAttribute("checked","checked"):d.removeAttribute("checked"),a===!0&&this.inputChanged(c,b)},b.prototype._activate=function(a){this.dom.toggleClass(a,n+this._targetType)},b}(plat.ui.BindControl);a.Toggle=ja,plat.register.control(w,ja);var ka=function(a){function b(){a.apply(this,arguments),this.templateString='<div class="plat-checkbox-container">\n    <span class="plat-mark"></span>\n</div>\n',this._targetTypeSet=!1}return __extends(b,a),b.prototype.setClasses=function(a,b){this.dom.addClass(b||this.element,p+" "+(a||""))},b.prototype.setTemplate=function(){var a=this.utils.isNull,b=this.innerTemplate;if(!a(b))for(var c,d,e,f=this._document,g=this.element,h=Array.prototype.slice.call(b.childNodes);h.length>0;)c=h.shift(),c.nodeType===Node.TEXT_NODE?(e=c.textContent.trim().match(/[^\r\n]/g),null!==e&&e.length>0&&(d=f.createElement("span"),d.insertBefore(c,null),g.insertBefore(d,null))):g.insertBefore(c,null)},b.prototype.loaded=function(){a.prototype.loaded.call(this);var b=this.options||{},c=b.value||{},d=this._targetType,e=this._targetType=c.mark||"check";switch(e.toLowerCase()){case"check":case"x":break;default:this._log.debug("Invalid mark option specified for "+this.type+". Defaulting to checkmark."),this._targetType="check"}if(this._targetTypeSet){var f=this._targetElement;this.dom.removeClass(f,d),this._activate(f)}this._targetTypeSet=!0},b.prototype._activate=function(a){return this._targetTypeSet?void this.dom.toggleClass(a,n+this._targetType):void(this._targetTypeSet=!0)},b._inject={_document:g},b}(ja);a.Checkbox=ka,plat.register.control(p,ka);var la=function(a){function b(){a.apply(this,arguments),this.templateString='<div class="plat-radio-container">\n    <div class="plat-mark"></div>\n</div>\n',this.groupName="",this._targetType="bullet",this._targetTypeSet=!0}return __extends(b,a),b.prototype.setClasses=function(a,b){this.dom.addClass(b||this.element,v+" "+(a||""))},b.prototype.loaded=function(){var a=this.element;this._targetElement=a.firstElementChild,this.addEventListener(a,T,this._onTap),a.hasAttribute("name")?this.groupName=a.getAttribute("name"):this.utils.isNull(this.attributes[N])||(this.groupName=this.attributes[N]),this._convertChecked()},b.prototype.inputChanged=function(b,c){this.isActive&&a.prototype.inputChanged.call(this,this._getValue())},b.prototype._setBoundProperty=function(a,b,c,d){if(a!==b){if(d===!0&&this.utils.isNull(a))return void this.inputChanged();var e=a===this._getValue(),f=this.isActive;e!==f&&this._toggle(d)}},b.prototype._onTap=function(b){this.isActive||a.prototype._onTap.call(this,b)},b.prototype._toggle=function(b){var c=this;if(a.prototype._toggle.call(this,b),this.utils.isFunction(this._removeListener)&&(this._removeListener(),this._removeListener=null),this.isActive){var d=this.groupName;this.dispatchEvent(_+d,plat.events.EventManager.DIRECT);var e=this._removeListener=this.on(_+d,function(){c._toggle(),e()})}},b.prototype._convertAttribute=function(a,b){var c=this.utils;return c.isBoolean(a)?void(a&&this._setBoundProperty(this._getValue(),null,null,!0)):void(c.isString(a)&&"true"===a&&this._setBoundProperty(this._getValue(),null,null,!0))},b.prototype._getValue=function(){var a=this.element;return a.hasAttribute("value")?a.getAttribute("value").trim():a.textContent.trim()},b}(ka);a.Radio=la,plat.register.control(v,la);var ma=function(a){function b(){a.apply(this,arguments),this.templateString='<div class="plat-animated-ring"></div>'}return __extends(b,a),b.prototype.setClasses=function(a,b){this.dom.addClass(b||this.element,u+" "+(a||""))},b.prototype.initialize=function(){this.setClasses()},b.prototype.loaded=function(){var a=this.options,b=this.utils,c=b.isObject,d=0;c(a)&&c(a.value)&&(d=a.value.style,b.isNumber(d)||(d=0)),this.dom.addClass(this.element,u+"-"+d),0!==d&&this._addAnimatedElements(d)},b.prototype._addAnimatedElements=function(a){for(var b,c=plat.acquire(g),d=c.createDocumentFragment(),e=2===a?12:4,f="div",h=n+"animated-child "+n+"animated-child-",i=0;e>i;++i)b=c.createElement(f),b.className=h+i,d.insertBefore(b,null);this.element.firstElementChild.insertBefore(d,null)},b}(plat.ui.TemplateControl);a.ProgressRing=ma,plat.register.control(u,ma);var na=function(a){function b(){a.apply(this,arguments),this.templateString='<div class="plat-progress-container">\n    <div class="plat-animated-bar"></div>\n</div>\n',this._removeVisibilityListener=ha}return __extends(b,a),b.prototype.setClasses=function(a,b){this.dom.addClass(b||this.element,t+" "+(a||""))},b.prototype.initialize=function(){this.setClasses()},b.prototype.loaded=function(){var a=this;this._barElement=this.element.firstElementChild.firstElementChild,this.addEventListener(this._window,"resize",function(){a.setProgress(a.context)}),this.setProgress(this.context)},b.prototype.dispose=function(){this._removeVisibilityListener()},b.prototype.contextChanged=function(){this.setProgress(this.context)},b.prototype.setProgress=function(a){var b=this;return new this._Promise(function(c,d){if(!b.utils.isNumber(a)||a>1||0>a){var e='The value of a "'+b.type+'" control must be a number between 0 and 1.';return b._log.debug(e),void d(e)}var f=b._barElement,g=f.parentElement.clientWidth;return g?void b._animator.animate(f,Q,{properties:{width:Math.ceil(g*a)+"px"}}).then(function(){c()}):(b._removeVisibilityListener(),void(b._removeVisibilityListener=b.dom.whenVisible(function(){b.setProgress(a).then(c)},b.element)))})},b._inject={_window:f,_Promise:c,_animator:h},b}(plat.ui.TemplateControl);a.ProgressBar=na,plat.register.control(t,na);var oa=function(a){function b(){a.apply(this,arguments),this.ready=this._Promise.resolve(),this._controllers=[],this._isInitialized=!1,this._preInitializedValue=!1,this.__state=!1,this.__nextState=!1}return __extends(b,a),b.prototype.setClasses=function(a,b){this.dom.addClass(b||this.element,q+" "+(a||""))},b.prototype.initialize=function(){this.setClasses()},b.prototype.setTemplate=function(){this.innerTemplate=this.dom.appendChildren(this.element.childNodes)},b.prototype.loaded=function(){var a=this,b=this.element,c=this.utils,d=this.options||{},e=d.value||{},f=this._currentPosition=e.position||"left",g=e.id||"",h=e.templateUrl,i=e.elastic===!0;return b.setAttribute(G,""),this.dom.addClass(b,n+f),c.isString(h)?void plat.ui.TemplateControl.determineTemplate(this,h).then(function(b){a.innerTemplate=b,a._initializeEvents(g,f,i)}):void this._initializeEvents(g,f,i)},b.prototype.open=function(){var a=this._controllers[0];return this.utils.isNull(a)?(this._log.debug("No controller, such as a "+r+", found for the "+this.type+" attempting to open."),this._Promise.resolve()):a.open()},b.prototype.close=function(){var a=this._controllers[0];return this.utils.isNull(a)?(this._log.debug("No controller, such as a "+r+", found for the "+this.type+" attempting to close."),this._Promise.resolve()):a.close()},b.prototype.toggle=function(){var a=this._controllers[0];return this.utils.isNull(a)?(this._log.debug("No controller, such as a "+r+", found for the "+this.type+" attempting to toggle."),this._Promise.resolve()):a.toggle()},b.prototype.isOpen=function(){var a=this._controllers[0];return this.utils.isNull(a)?(this._log.debug("No controller, such as a "+r+", found for the "+this.type+" attempting to check if open."),!1):a.isOpen()},b.prototype.bindTemplate=function(a,b){var c=this,d=this.bindableTemplates;return d.add(a,b),d.bind(a).then(function(a){var b=c.element;c.dom.clearNode(b),b.appendChild(a)}).catch(function(a){c._log.debug("Error binding template for "+c.type+": "+a)})},b.prototype.controllerCount=function(){return this._controllers.length},b.prototype.spliceController=function(a){var b=this._controllers,c=b.indexOf(a);-1!==c&&(this.__state=this.__nextState=b[c].isOpen(),b.splice(c,1))},b.prototype.observeProperties=function(a){a.observeProperty(this._setBoundProperty)},b.prototype._setBoundProperty=function(a,b,c,d){var e=this.utils,f=this._controllers[0];if(d===!0&&e.isNull(a))return void this.inputChanged(e.isNull(f)?!1:f.isOpen());var g=!!a;if(g!==a&&this.inputChanged(g),this._isInitialized)if(e.isNull(f))this.__nextState=g;else if(g){if(f.isOpen())return;f.open()}else f.isOpen()&&f.close();else this._preInitializedValue=g},b.prototype._changeDirection=function(a){if(!this.utils.isNull(a)&&a!==this._currentPosition){var b=this.dom,c=this.element;b.removeClass(c,n+this._currentPosition),b.addClass(c,n+a),this._currentPosition=a}},b.prototype._initializeEvents=function(a,b,c){var d=this,e=this.utils,f=this.innerTemplate;this.on(aa+"_"+a,function(g,h){var i=h.control;if(!e.isNull(i))return e.isString(h.position)&&(b=h.position,d._changeDirection(b)),d._controllers.unshift(i),h.received||d.ready.then(function(){d.dispatchEvent(ba+"_"+a,plat.events.EventManager.DIRECT,{control:d,received:!0,position:b,template:e.isNode(f)?f.cloneNode(!0):null,elastic:c,state:d.__state,nextState:d.__nextState})}),d._isInitialized=!0,h.useContext?void d._checkPreInit():void d.bindTemplate("drawer",f.cloneNode(!0)).then(function(){d._checkPreInit()})}),this.dispatchEvent(ba+"_"+a,plat.events.EventManager.DIRECT,{control:this,received:!1,position:b,template:e.isNode(f)?f.cloneNode(!0):null,elastic:c,state:this.__state,nextState:this.__nextState})},b.prototype._checkPreInit=function(){var a=this;if(this._preInitializedValue){var b=this.utils;b.postpone(function(){var c=a._controllers[0];b.isNull(c)||c.open()})}},b._inject={_Promise:c},b}(plat.ui.BindControl);a.Drawer=oa,plat.register.control(q,oa);var pa=function(a){function b(){a.apply(this,arguments),this._hasSwiped=!1,this._hasTapped=!1,this._isOpen=!1,this._touchState=0,this._isVertical=!1,this._removeClickEaterListener=ha,this._toggleDelay=ha,this._isInitialized=!1}return __extends(b,a),b.prototype.setClasses=function(a,b){this.dom.addClass(b||this.element,r+" "+(a||""))},b.prototype.initialize=function(){this.dom.addClass(this.element,r)},b.prototype.loaded=function(){var a=this.options||{},b=a.value||{},c=b.position,d=b.id||"";this._type=b.type||"tap track",this._isElastic=b.elastic,this._useContext=b.useContext===!0,this._templateUrl=b.templateUrl,this._initializeEvents(d,c)},b.prototype.dispose=function(){var b=this;a.prototype.dispose.call(this);var c=this._drawer;if(!this.utils.isNull(c))return c.controllerCount()>1?void c.spliceController(this):this._isOpen?void(c.ready=this.close().then(function(){c.spliceController(b),c.controllerCount()>0||b._cleanRootElement()})):void c.ready.then(function(){c.spliceController(b),c.controllerCount()>0||b._cleanRootElement()})},b.prototype.open=function(){var a=this,b=!this._isOpen,c=this.utils;this._toggleDelay();var d=new this._Promise(function(b){a._toggleDelay=c.requestAnimationFrame(function(){a._open().then(b)})});if(b){var e=this._drawer;this.inputChanged(!0),c.isNull(e)||e.inputChanged(!0)}return d},b.prototype.close=function(){var a=this,b=this._isOpen,c=this.utils;this._toggleDelay();var d=new this._Promise(function(b){a._toggleDelay=c.requestAnimationFrame(function(){a._close().then(b)})});if(b){var e=this._drawer;this.inputChanged(!1),c.isNull(e)||(e.ready=d,e.inputChanged(!1))}return d},b.prototype.toggle=function(){return this._isOpen?this.close():this.open()},b.prototype.isOpen=function(){return this._isOpen},b.prototype.bindTemplate=function(a,b){var c=this,d=this.bindableTemplates;return d.add(a,b),d.bind(a).then(function(a){var b=c._drawerElement;c.dom.clearNode(b),b.appendChild(a)}).catch(function(a){c._log.debug("Error binding template for "+c.type+": "+a)})},b.prototype.observeProperties=function(a){a.observeProperty(this._setBoundProperty)},b.prototype._setBoundProperty=function(a,b,c,d){var e=this,f=this.utils;if(d===!0&&f.isNull(a))return void this.inputChanged(this._isOpen);var g=!!a;if(g!==a&&this.inputChanged(g),this._isInitialized){if(g){if(this._isOpen)return;this._toggleDelay(),this._toggleDelay=f.requestAnimationFrame(function(){e._open()})}else if(this._isOpen){this._toggleDelay();var h=new this._Promise(function(a){e._toggleDelay=f.requestAnimationFrame(function(){a(e._close())})}),i=this._drawer;f.isNull(i)||(i.ready=h)}}else this._preInitializedValue=g},b.prototype._open=function(a){var b=this,c=this._rootElement,d=this.utils.isNode,e=this._isOpen,f=this._getOffset();if(e&&!a||!(f&&d(c)&&d(this._drawerElement)))return this._Promise.resolve();var g;switch(this._position){case"left":g="translate3d("+f+"px,0,0)";break;case"right":g="translate3d("+-f+"px,0,0)";break;case"top":g="translate3d(0,"+f+"px,0)";break;case"bottom":g="translate3d(0,"+-f+"px,0)";break;default:return this._Promise.resolve()}this._isOpen=!0,this.dom.addClass(c,this._directionalTransitionPrep),e||this._addClickEater();var h={};return h[this._transform]=g,this._animationThenable=this._animator.animate(c,Q,{properties:h}).then(function(){b._animationThenable=null,b._drawerElement.removeEventListener("selectstart",ga,!1)})},b.prototype._close=function(a){var b=this,c=this._rootElement,d=this.utils.isNode,e=!this._isOpen;if(e&&!a||!d(c)||!d(this._drawerElement))return this._Promise.resolve();this._isOpen=!1;var f={};return f[this._transform]=this._preTransform,this._animationThenable=this._animator.animate(c,Q,{properties:f}).then(function(){b._animationThenable=null,b._drawerElement.removeEventListener("selectstart",ga,!1),b._isOpen||b._touchState<2&&b._removeClickEater()})},b.prototype._reset=function(){if(this._isOpen)return this._open(!0);var a=this._close(!0),b=this._drawer;return this.utils.isNull(b)||(b.ready=a),a},b.prototype._addClickEater=function(){var a=this,b=this._clickEater,c=b.style,d=this._rootElement;if(!d.contains(b)){c.top=d.scrollTop+"px",c.left=d.scrollLeft+"px",d.insertBefore(b,null),this.dom.addClass(this._rootElement,this._directionalTransitionPrep);var e,f=ha,g=!0;e=this.addEventListener(d,"scroll",function(){g&&(g=!1,f=a.utils.requestAnimationFrame(function(){var a=b.style;g=!0,a.top=d.scrollTop+"px",a.left=d.scrollLeft+"px"}))}),this._removeClickEaterListener=function(){f(),e()}}},b.prototype._removeClickEater=function(){var a=this._rootElement,b=this._clickEater;this._removeClickEaterListener(),a.contains(b)&&a.removeChild(b),this.dom.removeClass(a,this._directionalTransitionPrep)},b.prototype._addSwipeToggle=function(){var a=this,b=this.element,c=this.addEventListener(b,X+ea[this._position],function(){a._hasSwiped=!0,a.open()},!1),d=this.addEventListener(b,X+this._position,function(){a._hasSwiped=!0,a.close()},!1);this._removeSwipeToggle=function(){c(),d()}},b.prototype._addSwipeClose=function(){var a=this;this._openSwipeRemover=this.addEventListener(this._clickEater,X+this._position,function(){a._hasSwiped=!0,a.close()},!1)},b.prototype._addTapToggle=function(){var a=this;this._removeTap=this.addEventListener(this.element,T,function(){a._hasTapped=!0,a.toggle()},!1)},b.prototype._addTapClose=function(){var a=this;this._openTapRemover=this.addEventListener(this._clickEater,T,function(){a._hasTapped=!0,a.close()},!1)},b.prototype._addEventListeners=function(){var a=this.element,b=this.utils.isNull,c=this._type.split(" "),d=this._position;if((this._isTap=-1!==c.indexOf("tap"))&&(this._addTapToggle(),this._addTapClose()),(this._isSwipe=-1!==c.indexOf("swipe"))&&(this._addSwipeToggle(),this._addSwipeClose()),this._isTrack=-1!==c.indexOf("track")){var e=this._track,f=void 0,g=this._clickEater;switch(d){case"left":case"right":f=d;break;case"top":f="up";break;case"bottom":f="down";break;default:return}var h=Y+ea[f],i=Y+f,j=this.addEventListener(a,h,e,!1),k=this.addEventListener(a,i,e,!1),l=this.addEventListener(g,h,e,!1),m=this.addEventListener(g,i,e,!1);if(this._removeTrack=function(){j(),k()},this._openTrackRemover=function(){l(),m()},b(this._lastTouch)){var n=this._touchStart,o=this._touchEnd;this._lastTouch={x:0,y:0},this.addEventListener(a,U,n,!1),this.addEventListener(a,V,o,!1),this.addEventListener(a,Z,o,!1),this.addEventListener(g,U,n,!1),this.addEventListener(g,Z,o,!1),this.addEventListener(g,V,o,!1)}}this.addEventListener(this._window,"resize",this._handleResize,!1)},b.prototype._handleResize=function(){if(this._isOpen){var a=this.utils.isNull,b=this._rootElement,c=this._drawer;this._isOpen=!1,this.inputChanged(!1),a(b)||(b.style[this._transform]=this._preTransform),a(c)||(c.inputChanged(!1),this._drawerElement.removeEventListener("selectstart",ga,!1)),this._touchState<2&&this._removeClickEater()}},b.prototype._removeEventListeners=function(){var a=this.utils.isFunction;this._isTap&&(a(this._removeTap)&&(this._removeTap(),this._removeTap=null),a(this._openTapRemover)&&(this._openTapRemover(),this._openTapRemover=null)),this._isTrack&&(a(this._removeTrack)&&(this._removeTrack(),this._removeTrack=null),a(this._openTrackRemover)&&(this._openTrackRemover(),this._openTrackRemover=null)),this._isSwipe&&(a(this._removeSwipeToggle)&&(this._removeSwipeToggle(),this._removeSwipeToggle=null),a(this._openSwipeRemover)&&(this._openSwipeRemover(),this._openSwipeRemover=null))},b.prototype._touchStart=function(a){1!==this._touchState&&(this._touchState=1,this._lastTouch={x:a.clientX,y:a.clientY})},b.prototype._touchEnd=function(a){var b=0===this._touchState,c=this._hasSwiped,d=this._hasTapped;if(this._hasSwiped=this._hasTapped=!1,this._touchState=0,!(d||b||c)){var e=this._isVertical?a.clientY-this._lastTouch.y:a.clientX-this._lastTouch.x;if(this._isRightDirection(e)){var f=this._getOffset();if(!f)return;if(Math.abs(e)>Math.ceil(f/2))return void this.toggle();this._reset()}else this._isElastic?Math.abs(e)>0&&this._reset():this._isOpen||this._removeClickEater()}},b.prototype._track=function(a){var b=this,c=this._touchState;0!==c&&(1===c&&(this.utils.isNull(this._animationThenable)?(this._addClickEater(),this.utils.isNode(this._drawerElement)&&this._drawerElement.addEventListener("selectstart",ga,!1)):this._animationThenable.cancel().then(function(){b._addClickEater(),b.utils.isNode(b._drawerElement)&&b._drawerElement.addEventListener("selectstart",ga,!1)}),this._touchState=2),this.utils.requestAnimationFrame(function(){b._rootElement.style[b._transform]=b._calculateTranslation(a)}))},b.prototype._isRightDirection=function(a){switch(this._position){case"left":case"top":return this._isOpen?0>a:a>0;case"right":case"bottom":return this._isOpen?a>0:0>a;default:return!1}},b.prototype._calculateTranslation=function(a){var b,c=this._getOffset();if(!c)return this._preTransform;switch(this._position){case"left":return b=this._checkElasticity(c,a.clientX-this._lastTouch.x),0===b?this._preTransform:"translate3d("+b+"px,0,0)";case"right":return b=this._checkElasticity(c,this._lastTouch.x-a.clientX),0===b?this._preTransform:"translate3d("+-b+"px,0,0)";case"top":return b=this._checkElasticity(c,a.clientY-this._lastTouch.y),0===b?this._preTransform:"translate3d(0,"+b+"px,0)";case"bottom":return b=this._checkElasticity(c,this._lastTouch.y-a.clientY),0===b?this._preTransform:"translate3d(0,"+-b+"px,0)";default:return this._preTransform}},b.prototype._checkElasticity=function(a,b){var c=this._isOpen?a+b:b;return this._isElastic?c:(0>c?c=0:c>a&&(c=a),c)},b.prototype._initializeEvents=function(a,b){var c=this,d=this._useContext,e=this.on(ba+"_"+a,function(f,g){e();var h=c.utils,i=h.isString,j=h.isUndefined,k=(c._drawer=g.control)||{},l=c._drawerElement=k.element;if(!i(b)){if(!i(g.position))return void c._log.debug('"position" is incorrectly defined for a control such as "'+q+'" '+('or "'+c.type+'." Please ensure it is a string.'));b=g.position}if(l.removeAttribute(G),c._controllerIsValid(b.toLowerCase())){c._setTransform(),c._addEventListeners(),j(c._isElastic)&&(c._isElastic=g.elastic===!0),g.received||c.dispatchEvent(aa+"_"+a,plat.events.EventManager.DIRECT,{control:c,received:!0,position:b,useContext:d}),g.state?(c._isOpen=!0,c.inputChanged(!0),!g.nextState&&h.isNull(c._preInitializedValue)&&(c._preInitializedValue=!1)):g.nextState&&h.isNull(c._preInitializedValue)&&(c._preInitializedValue=!0);var m=function(){c._isInitialized=!0,c._checkPreInit()};return d?void c._determineTemplate(g.template).then(m):void m()}});this.dispatchEvent(aa+"_"+a,plat.events.EventManager.DIRECT,{control:this,received:!1,position:b,useContext:d})},b.prototype._checkPreInit=function(){var a=this,b=this._preInitializedValue,c=this.utils,d=c.isNull;if(!d(b)){var e=this._isOpen;if(!(e&&b||!e&&!b)){if(this._toggleDelay(),b)return void(this._toggleDelay=c.requestAnimationFrame(this._open.bind(this)));var f=new this._Promise(function(b){a._toggleDelay=c.requestAnimationFrame(function(){b(a._close())})}),g=this._drawer;d(g)||(g.ready=f)}}},b.prototype._determineTemplate=function(a){var b=this,c=this.utils;return c.isString(this._templateUrl)?plat.ui.TemplateControl.determineTemplate(this,this._templateUrl).then(function(a){return b.bindTemplate("drawer",a)}):c.isNode(a)?this.bindTemplate("drawer",a):this._Promise.resolve()},b.prototype._setTransform=function(){var a=this._rootElement.style,b=this.utils.isUndefined,c=this._compat.vendorPrefix;b(this._preTransform=a[c.lowerCase+"Transform"])?b(this._preTransform=a[c.upperCase+"Transform"])?this._transform="transform":this._transform=c.upperCase+"Transform":this._transform=c.lowerCase+"Transform"},b.prototype._controllerIsValid=function(a){var b=this.utils,c=b.isNull;if(c(this._drawerElement))return this._log.debug('Could not find a corresponding control such as "'+q+'" for this "'+this.type+'."'),!1;switch(a){case"top":case"bottom":this._isVertical=!0;case"left":case"right":this._position=a;break;default:return this._log.debug('Incorrect position: "'+a+'" defined for the a control such as a "'+q+'", or "'+this.type+'."'),!1}var d=this._rootElement=this._getRootElement();if(c(d))return this._log.debug('Cannot have a "'+this.type+'" in a hierarchy above the corresponding control such as "'+q+'."'),!1;var e=this.dom;return e.addClass(d,q+"-root"),e.addClass(this.element,this._isVertical?n+"vertical":n+"horizontal"),this._directionalTransitionPrep=q+"-transition-"+a,this._clickEater=this._document.createElement("div"),this._clickEater.className=n+"clickeater",this._styleRootElement(),!0},b.prototype._getRootElement=function(){var a=this._drawer,b=this.utils;if(!b.isNull(a.storedProperties))return a.storedProperties.rootElement;for(var c,d=b.isNode,e=this.root,f=b.isObject(e)&&d(e.element)?e.element:this.element,g=this._drawerElement;d(c=f.parentElement)&&!c.contains(g);)f=c;return f},b.prototype._styleRootElement=function(){var a=this._window,b=this.utils,c=this._drawer,d=this._rootElement,e=d.parentElement,f=a.getComputedStyle(d),g=d.style,h=f.position,i=Number(f.zIndex),j={rootElement:d};if("static"===h&&(j.position=g.position,g.position="relative"),(!b.isNumber(i)||1>i)&&(j.zIndex=g.zIndex,g.zIndex="1"),b.isNode(e)){var k=a.getComputedStyle(e),l=k.overflow;if("hidden"!==l){var m=void 0,n=void 0;if(this._isVertical?(n="overflowY",m=k.overflowY):(n="overflowX",m=k.overflowX),"hidden"!==m){var o=e.style;j.parentOverflow={key:n,value:o[n]},o[n]="hidden"}}}c.storedProperties=j},b.prototype._cleanRootElement=function(){var a=this.utils,b=a.isObject,c=a.isNode,d=this._rootElement,e=this._drawer;if(c(d)&&(this.dom.removeClass(d,q+"-root "+this._directionalTransitionPrep),!a.isNull(e))){var f=e.storedProperties;if(b(f)){var g=d.style,h=d.parentElement,i=f.parentOverflow;g.position=f.position,g.zIndex=f.zIndex,b(i)&&c(h)&&(h.style[i.key]=i.value),delete e.storedProperties,this._drawerElement.setAttribute(G,"")}}},b.prototype._getOffset=function(){return this._isVertical?this._drawerElement.offsetHeight:this._drawerElement.offsetWidth},b._inject={_document:g,_window:f,_compat:d,_animator:h,_Promise:c},b}(plat.ui.BindControl);a.DrawerController=pa,plat.register.control(r,pa);var qa=function(a){function b(){var b=this;a.call(this),this.templateString=this.__templateString,this._isVisible=!1,this._scrollRemover=ha,this._presenceRemover=ha,this._scrollTop=0,this._transitionHash={up:!0,down:!0,left:!0,right:!0,fade:!0},this.__templateString='<div class="plat-modal-container"></div>\n',this.modalLoaded=new this._Promise(function(a,c){b.__resolveFn=a,b.__rejectFn=c}).catch(ha)}return __extends(b,a),b.prototype.setClasses=function(a,b){this.dom.addClass(b||this.element,s+" "+G+" "+(a||""))},b.prototype.initialize=function(){var a=this.options||(this.options={}),b=a.value||(a.value={});this.templateUrl=b.templateUrl||this.templateUrl,this.setClasses()},b.prototype.setTemplate=function(){if(this.templateString!==this.__templateString||this.utils.isString(this.templateUrl)){var a=this.dom,b=a.serializeHtml(this.__templateString),c=this.element;this._container=b.firstChild;this.innerTemplate=a.appendChildren(c.childNodes),c.appendChild(b)}},b.prototype.loaded=function(){var a=this.options.value,b=a.transition,c=this.element;if(this._container=this._container||c.firstElementChild,this._presenceRemover=this.dom.whenPresent(this._injectElement.bind(this),c),!this.utils.isString(b)||"none"===b)return void this.dom.addClass(this._container,n+"no-transition");this._transitionHash[b]||this._log.debug('Custom transition: "'+b+'" defined for "'+this.type+'." Please ensure the transition is defined to avoid errors.');var d=this._compat.animationEvents;return this.utils.isNull(d)?(this._log.debug("This browser does not support CSS3 animations."),void this.dom.addClass(this._container,n+"no-transition")):(this._transitionEnd=d.$transitionEnd,void this.dom.addClass(this._container,n+b+" "+n+"modal-transition"))},b.prototype.dispose=function(){a.prototype.dispose.call(this),this._scrollRemover(),this._presenceRemover(),this.utils.isFunction(this.__rejectFn)&&(this.__rejectFn(),this.__rejectFn=this.__resolveFn=null)},b.prototype.show=function(){var a=!this._isVisible,b=this._show();return a&&this.inputChanged(!0),b},b.prototype.hide=function(){var a=this.isVisible,b=this._hide();return a&&this.inputChanged(!1),b},b.prototype.toggle=function(){return this._isVisible?this.hide():this.show()},b.prototype.isVisible=function(){return this._isVisible},b.prototype.observeProperties=function(a){a.observeProperty(this._setBoundProperty)},b.prototype._setBoundProperty=function(a,b,c,d){var e=this.utils;if(d===!0&&e.isNull(a))return void this.inputChanged(this._isVisible);if(e.isBoolean(a)){if(a){if(this._isVisible)return;return void this._show()}return void(this._isVisible&&this._hide())}this._log.debug("Attempting to show or hide a "+this.type+" with a bound value that is something other than a boolean.")},b.prototype._show=function(){var a=this,b=this.dom,c=this.utils;return c.isNull(this.innerTemplate)?(this._isVisible=!0,new this._Promise(function(d){c.requestAnimationFrame(function(){a._alignModal(),b.removeClass(a.element,G),c.defer(function(){c.requestAnimationFrame(function(){b.addClass(a._container,n+"activate"),d()})},20)})})):this._bindInnerTemplate()},b.prototype._alignModal=function(a){var b=this,c=this.utils,d=c.isNull,e=this._document,f=e.documentElement,g=d(f)||!f.scrollTop?e.body:f,h=g.scrollTop;this._scrollTop!==h&&(d(a)?(this.element.style.top=h+"px",this._scrollRemover=this.addEventListener(this._window,"scroll",this._alignModal,!1)):c.requestAnimationFrame(function(){b.element.style.top=h+"px"}),this._scrollTop=h)},b.prototype._hide=function(){var a,b=this,c=this.dom,d=this.utils;return this._scrollRemover(),this._scrollRemover=ha,this._isVisible=!1,d.isString(this._transitionEnd)?(a=this._addHideOnTransitionEnd(),d.requestAnimationFrame(function(){
c.removeClass(b._container,n+"activate")})):a=new this._Promise(function(a){d.requestAnimationFrame(function(){c.addClass(b.element,G),c.removeClass(b._container,n+"activate"),a()})}),a},b.prototype._bindInnerTemplate=function(){var a=this,b=this.innerTemplate,c=this.bindableTemplates,d="modal";return c.add(d,b),this.innerTemplate=null,c.bind(d).then(function(b){return a._container.insertBefore(b,null),a.utils.isFunction(a.__resolveFn)&&(a.__resolveFn(),a.__resolveFn=a.__rejectFn=null),a._show()})},b.prototype._injectElement=function(){var a=this.element,b=a.parentElement,c=this._document.body;this.utils.isNode(b)&&b!==c&&c.insertBefore(a,null)},b.prototype._addHideOnTransitionEnd=function(){var a=this;return new this._Promise(function(b){var c=a.element,d=a.addEventListener(c,a._transitionEnd,function(){d(),a.dom.addClass(c,G),b()},!1)})},b._inject={_window:f,_document:g,_compat:d,_Promise:c},b}(plat.ui.BindControl);a.Modal=qa,plat.register.control(s,qa);var ra=function(a){function b(){a.apply(this,arguments),this.templateString='<div class="plat-slider-container">\n    <div class="plat-slider-track">\n        <div class="plat-knob"></div>\n    </div>\n</div>\n',this._isVertical=!1,this._knobOffset=0,this._touchState=0,this._removeVisibilityListener=ha}return __extends(b,a),b.prototype.setClasses=function(a,b){this.dom.addClass(b||this.element,x+" "+(a||""))},b.prototype.initialize=function(){this.setClasses()},b.prototype.loaded=function(){var a=this.element,b=this._slider=a.firstElementChild.firstElementChild,c=this.utils.isNumber,d=this.options||{},e=d.value||{},f=Number(e.value),g=e.min,h=e.max,i=e.step,j=this._reversed=e.reverse===!0,k=this.min=c(g)?Math.floor(g):0,l=this.max=c(h)?Math.ceil(h):100,m=c(f)?Math.round(f):k,o=n+this._validateOrientation(e.orientation);this._knob=b.firstElementChild,j&&(o+=ca),this.dom.addClass(a,o),this.value=k,this._step=c(i)&&i>0?Math.round(i):1,k>=l&&(this._log.debug('"'+this.type+"'s\" min is greater than or equal to its max. Setting max to min + 1."),this.max=k+1),this._setLength(),this._initializeEvents(),this.setValue(m)},b.prototype.dispose=function(){a.prototype.dispose.call(this),this._removeVisibilityListener(),this._sliderVisible=null},b.prototype.setValue=function(a){this._setValue(a,!0)},b.prototype.observeProperties=function(a){a.observeProperty(this._setBoundProperty)},b.prototype._setBoundProperty=function(a,b,c,d){this._setValue(a,!1)},b.prototype._setValue=function(a,b){var c=this.utils;if(1===this._touchState)return void this._log.debug("Cannot set the value of "+this.type+" while the user is manipulating it.");if(c.isNull(a)&&(a=this.min,b=!0),!c.isNumber(a)){var d=Number(a);if(!c.isNumber(d))return void this._log.warn(this.type+" has its value bound to a property that cannot be interpreted as a Number.");a=d,b=!0}this._setValueProperty(a,!0,b)},b.prototype._initializeEvents=function(){var a,b,c=this,d=this.element,e=this._track,f=this._touchEnd;this._isVertical?(a=Y+"down",b=Y+"up"):(a=Y+"right",b=Y+"left"),this.addEventListener(d,U,this._touchStart,!1),this.addEventListener(d,a,e,!1),this.addEventListener(d,b,e,!1),this.addEventListener(d,V,f,!1),this.addEventListener(d,Z,f,!1),this.addEventListener(this._window,"resize",function(){c.utils.isNull(c._sliderVisible)&&(c._setLength(),c._setKnob())},!1)},b.prototype._touchStart=function(a){var b=this;if(1!==this._touchState){this._touchState=1,this._lastTouch={x:a.clientX,y:a.clientY,value:this.value};var c=a.target;if(c!==this._knob){var d;d=this._isVertical?c===this.element?this._reversed?a.offsetY-this._sliderOffset:this._maxOffset-(a.offsetY-this._sliderOffset):c===this._slider?this._reversed?a.offsetY:this._knobOffset-a.offsetY:this._reversed?a.offsetY:this._maxOffset-a.offsetY:c===this.element?this._reversed?this._maxOffset-(a.offsetX-this._sliderOffset):a.offsetX-this._sliderOffset:c===this._slider?this._reversed?this._knobOffset-a.offsetX:a.offsetX:this._reversed?this._maxOffset-a.offsetX:a.offsetX,this.utils.requestAnimationFrame(function(){b._knobOffset=b._setSliderProperties(d)})}}},b.prototype._touchEnd=function(a){var b=this;if(1!==this._touchState)return void(this._touchState=0);this._touchState=2;var c=this._calculateOffset(a),d=this._maxOffset;this.utils.requestAnimationFrame(function(){return b._touchState=0,b._lastTouch.value!==b.value&&b._trigger("change"),0>c?void(b._knobOffset=0):c>d?void(b._knobOffset=d):void(b._knobOffset=c)})},b.prototype._track=function(a){var b=this;0!==this._touchState&&this.utils.requestAnimationFrame(function(){b._setSliderProperties(b._calculateOffset(a))})},b.prototype._setSliderProperties=function(a){var b,c=this._maxOffset;if(0>=a){if(b=this.min,a=0,b-this.value>=0)return a}else if(a>=c){if(b=this.max,a=c,b-this.value<=0)return a}else b=this._calculateValue(a);return this._setValueProperty(b,!1,!0),this._slider.style[this._lengthProperty]=a+"px",a},b.prototype._calculateValue=function(a){var b=this._step;return this.min+Math.round(a/this._increment/b)*b},b.prototype._calculateKnobPosition=function(a){return(a-this.min)*this._increment},b.prototype._calculateOffset=function(a){return this._isVertical?this._reversed?this._knobOffset+a.clientY-this._lastTouch.y:this._knobOffset+this._lastTouch.y-a.clientY:this._reversed?this._knobOffset+this._lastTouch.x-a.clientX:this._knobOffset+a.clientX-this._lastTouch.x},b.prototype._setLength=function(){var a=this,b=this._slider.parentElement;return this._isVertical?(this._lengthProperty="height",this._maxOffset=b.clientHeight,this._sliderOffset=b.offsetTop):(this._lengthProperty="width",this._maxOffset=b.clientWidth,this._sliderOffset=b.offsetLeft),this._maxOffset?void this._setIncrement():void(this._sliderVisible=new this._Promise(function(c){a._removeVisibilityListener=a.dom.whenVisible(function(){a._sliderVisible=null,a._setLength(),c()},b)}))},b.prototype._setIncrement=function(){return this._increment=this._maxOffset/(this.max-this.min)},b.prototype._setValueProperty=function(a,b,c){var d=this.value;if(a!==d){if(a>=this.max)a=this.max;else if(a<=this.min)a=this.min;else if(Math.abs(a-d)<this._step)return;this.value=this.element.value=a,b&&this._setKnob(),c&&this.inputChanged(a,d),this._trigger("input")}},b.prototype._setKnob=function(a){var b=this;this._Promise.resolve(this._sliderVisible).then(function(){var c={},d=b._calculateKnobPosition(a||b.value);d!==b._knobOffset&&(c[b._lengthProperty]=d+"px",b._animator.animate(b._slider,Q,{properties:c}),b._knobOffset=d)})},b.prototype._trigger=function(a){var b=plat.acquire(i);b.initialize(this.element,a),b.trigger()},b.prototype._validateOrientation=function(a){if(this.utils.isUndefined(a))return"horizontal";var b;return"horizontal"===a?b=a:"vertical"===a?(b=a,this._isVertical=!0):(this._log.debug('Invalid orientation "'+a+'" for '+this.type+'. Defaulting to "horizontal."'),b="horizontal"),b},b._inject={_document:g,_window:f,_Promise:c,_animator:h},b}(plat.ui.BindControl);a.Slider=ra,plat.register.control(x,ra);var sa=function(a){function b(){a.apply(this,arguments),this.templateString='<div class="plat-range-container">\n    <div class="plat-range-track">\n        <div class="plat-lower-knob"></div>\n        <div class="plat-upper-knob"></div>\n    </div>\n</div>\n',this._isVertical=!1,this._touchState=0,this._removeVisibilityListener=ha,this._forceFirstTime=!1}return __extends(b,a),b.prototype.setClasses=function(a,b){this.dom.addClass(b||this.element,y+" "+(a||""))},b.prototype.initialize=function(){this.setClasses()},b.prototype.loaded=function(){var a=this.element,b=this._slider=a.firstElementChild.firstElementChild,c=this.utils.isNumber,d=this.options||{},e=d.value||{},f=Number(e.lower),g=Number(e.upper),h=e.identifiers||{},i=e.min,j=e.max,k=e.step,l=this._reversed=e.reverse===!0,m=this.min=c(i)?Math.floor(i):0,o=this.max=c(j)?Math.ceil(j):100,p=c(f)?Math.round(f):m,q=c(g)?Math.round(g):o,r=n+this._validateOrientation(e.orientation);if(this._lowerKnob=b.firstElementChild,this._upperKnob=b.lastElementChild,this._lowerIdentifier=h.lower||"lower",this._upperIdentifier=h.upper||"upper",l){var s=this._lowerKnob;this._lowerKnob=this._upperKnob,this._upperKnob=s,r+=ca}this.dom.addClass(a,r),this.lower=m,this.upper=o,this._step=c(k)&&k>0?Math.round(k):1,m>=o&&(this._log.debug('"'+this.type+"'s\" min is greater than or equal to its max. Setting max to min + 1."),this.max=m+1),this._setPositionAndLength(),this._setLowerKnobPosition(m),this._initializeEvents(),this.setLower(p),this.setUpper(q)},b.prototype.setLower=function(a){this._setLower(a,!0)},b.prototype.setUpper=function(a){this._setUpper(a,!0)},b.prototype.observeProperties=function(a){a.observeProperty(this._setLowerBoundProperty,this._lowerIdentifier),a.observeProperty(this._setUpperBoundProperty,this._upperIdentifier)},b.prototype._setLowerBoundProperty=function(a,b,c,d){this._setLower(a,!1,d)},b.prototype._setUpperBoundProperty=function(a,b,c,d){this._setUpper(a,!1,d)},b.prototype._setLower=function(a,b,c){var d=this.utils;if(2===this._touchState)return void this._log.debug("Cannot set the value of the "+this.type+"'s lower knob while the user is manipulating it.");if(d.isNull(a)&&(a=this.min,c===!0?this._forceFirstTime=!0:b=!0),!d.isNumber(a)){var e=Number(a);if(!d.isNumber(e))return void this._log.warn(this.type+" has its lower value bound to a property that cannot be interpreted as a Number.");a=e,c===!0?this._forceFirstTime=!0:b=!0}this._setLowerValue(a,!0,b,!0)},b.prototype._setUpper=function(a,b,c){var d=this.utils;if(3===this._touchState)return void this._log.debug("Cannot set the value of the "+this.type+"'s upper knob while the user is manipulating it.");if(d.isNull(a)&&(a=this.max,b=!0),!d.isNumber(a)){var e=Number(a);if(!d.isNumber(e))return void this._log.warn(this.type+" has its upper value bound to a property that cannot be interpreted as a Number.");a=e,b=!0}this._setUpperValue(a,!0,b||c===!0&&this._forceFirstTime,!0)},b.prototype._initializeEvents=function(){var a,b,c=this,d=this._lowerKnob,e=this._upperKnob,f=this._touchStart,g=this._touchEnd,h=this._trackLower,i=this._trackUpper;this._isVertical?(a=Y+"down",b=Y+"up"):(a=Y+"right",b=Y+"left"),this.addEventListener(d,U,f,!1),this.addEventListener(e,U,f,!1),this.addEventListener(d,a,h,!1),this.addEventListener(d,b,h,!1),this.addEventListener(e,a,i,!1),this.addEventListener(e,b,i,!1),this.addEventListener(d,V,g,!1),this.addEventListener(e,V,g,!1),this.addEventListener(d,Z,g,!1),this.addEventListener(e,Z,g,!1),this.addEventListener(this._window,"resize",function(){c.utils.isNull(c._rangeVisible)&&(c._setPositionAndLength(),c._setLowerKnobPosition(),c._setUpperKnobPosition())},!1)},b.prototype._touchStart=function(a){var b=this._touchState;if(1!==b&&2!==b&&3!==b){this._touchState=1;var c=a.currentTarget,d=this._lastTouch;if(this.utils.isNull(d))this.dom.addClass(c,n+"top");else if(d.target!==c){var e=this.dom;e.addClass(c,n+"top"),e.removeClass(d.target,n+"top")}this._lastTouch={x:a.clientX,y:a.clientY,value:c===this._lowerKnob?this.lower:this.upper,target:c}}},b.prototype._touchEnd=function(a){var b=this,c=this._touchState;if(0===c||4===c)return void(this._touchState=0);this._touchState=4;var d=this._lastTouch,e=a.currentTarget;this.utils.isNull(d)||d.target!==e||this.utils.requestAnimationFrame(function(){b._touchState=0;var c=e===b._lowerKnob,f=b._calculateOffset(a,c);c?d.value!==b.lower&&b._trigger("change"):d.value!==b.upper&&b._trigger("change"),b._setOffset(f,c)})},b.prototype._setOffset=function(a,b){var c=this._maxOffset;return 0>a?b?this._lowerKnobOffset=0:this._upperKnobOffset=0:a>c?b?this._lowerKnobOffset=c:this._upperKnobOffset=c:b?this._lowerKnobOffset=a:this._upperKnobOffset=a},b.prototype._trackLower=function(a){var b=this._touchState;if(2!==b)if(1===b)this._touchState=2;else if(0===b||3===b)return;var c,d=this._maxOffset,e=this._calculateOffset(a,!0);return 0>=e?(c=this.min,c-this.lower>=0&&(c=null),e=0):e>=d?(c=this.max,c-this.lower<=0&&(c=null),e=d):(c=this._calculateValue(e),c-this.lower===0&&(c=null)),e>this._upperKnobOffset?(this._positionTogether(e,c),void this._setOffset(e,!1)):void this._positionLower(e,c)},b.prototype._trackUpper=function(a){var b=this._touchState;if(3!==b)if(1===b)this._touchState=3;else if(0===b||2===b)return;var c,d=this._maxOffset,e=this._calculateOffset(a,!1);return 0>=e?(c=this.min,c-this.upper>=0&&(c=null),e=0):e>=d?(c=this.max,c-this.upper<=0&&(c=null),e=d):(c=this._calculateValue(e),c-this.upper===0&&(c=null)),e<this._lowerKnobOffset?(this._positionTogether(e,c),void this._setOffset(e,!0)):void this._positionUpper(e,c)},b.prototype._positionLower=function(a,b){var c=this;this.utils.requestAnimationFrame(function(){var d=c._slider.style;d[c._positionProperty]=a+"px",d[c._lengthProperty]=c._upperKnobOffset-a+"px",null!==b&&c._setLowerValue(b,!1,!0,!0)})},b.prototype._positionUpper=function(a,b){var c=this;this.utils.requestAnimationFrame(function(){c._slider.style[c._lengthProperty]=a-c._lowerKnobOffset+"px",null!==b&&c._setUpperValue(b,!1,!0,!0)})},b.prototype._positionTogether=function(a,b){var c=this;this.utils.requestAnimationFrame(function(){var d=c._slider.style;d[c._positionProperty]=a+"px",d[c._lengthProperty]="0px",null!==b&&(c._setLowerValue(b,!1,!1,!1),c._setUpperValue(b,!1,!0,!0))})},b.prototype._calculateValue=function(a){var b=this._step;return this.min+Math.round(a/this._increment/b)*b},b.prototype._calculateOffset=function(a,b){var c,d=b?this._lowerKnobOffset:this._upperKnobOffset;return c=this._isVertical?this._reversed?a.clientY-this._lastTouch.y:this._lastTouch.y-a.clientY:this._reversed?this._lastTouch.x-a.clientX:a.clientX-this._lastTouch.x,d+c},b.prototype._calculateKnobPosition=function(a){return(a-this.min)*this._increment},b.prototype._setLowerValue=function(a,b,c,d){var e=this.lower;if(a!==e){if(a>=this.max)a=this.max;else if(a<=this.min)a=this.min;else if(Math.abs(a-e)<this._step)return;this.lower=a,b&&this._setLowerKnobPosition(),c&&this._fireChange(),d&&this._trigger("input")}},b.prototype._setUpperValue=function(a,b,c,d){var e=this.upper;if(a!==e){if(a>=this.max)a=this.max;else if(a<=this.min)a=this.min;else if(Math.abs(a-e)<this._step)return;this.upper=a,b&&this._setUpperKnobPosition(),c&&this._fireChange(),d&&this._trigger("input")}},b.prototype._setIncrement=function(){return this._increment=this._maxOffset/(this.max-this.min)},b.prototype._setPositionAndLength=function(){var a=this,b=this._slider.parentElement;return this._isVertical?(this._lengthProperty="height",this._positionProperty=this._reversed?"top":"bottom",this._maxOffset=b.clientHeight):(this._lengthProperty="width",this._positionProperty=this._reversed?"right":"left",this._maxOffset=b.clientWidth),this._maxOffset?void this._setIncrement():void(this._rangeVisible=new this._Promise(function(c){a._removeVisibilityListener=a.dom.whenVisible(function(){a._rangeVisible=null,a._setPositionAndLength(),c()},b)}))},b.prototype._setLowerKnobPosition=function(a){var b=this;this._Promise.resolve(this._rangeVisible).then(function(){var c={},d=b._upperKnobOffset,e=b.utils.isNumber(d)?d:b._setOffset(b._calculateKnobPosition(b.upper),!1),f=b._calculateKnobPosition(a||b.lower);f!==b._lowerKnobOffset&&(c[b._positionProperty]=f+"px",c[b._lengthProperty]=e-f+"px",b._animator.animate(b._slider,Q,{properties:c}),b._lowerKnobOffset=f)})},b.prototype._setUpperKnobPosition=function(a){var b=this;this._Promise.resolve(this._rangeVisible).then(function(){var c={},d=b._calculateKnobPosition(a||b.upper);d!==b._upperKnobOffset&&(c[b._lengthProperty]=d-b._lowerKnobOffset+"px",b._animator.animate(b._slider,Q,{properties:c}),b._upperKnobOffset=d)})},b.prototype._fireChange=function(){var a={};a[this._lowerIdentifier]=this.lower,a[this._upperIdentifier]=this.upper,this.inputChanged(a)},b.prototype._trigger=function(a){var b=plat.acquire(i);b.initialize(this.element,a),b.trigger()},b.prototype._validateOrientation=function(a){if(this.utils.isUndefined(a))return"horizontal";var b;return"horizontal"===a?b=a:"vertical"===a?(b=a,this._isVertical=!0):(this._log.debug('Invalid orientation "'+a+'" for '+this.type+'. Defaulting to "horizontal."'),b="horizontal"),b},b._inject={_document:g,_window:f,_Promise:c,_animator:h},b}(plat.ui.BindControl);a.Range=sa,plat.register.control(y,sa);var ta=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.setClasses=function(a,b){this.dom.addClass(b||this.element,z+" "+(a||""))},b.prototype.initialize=function(){a.prototype.initialize.call(this),this.setClasses()},b}(plat.ui.controls.Select);a.Select=ta,plat.register.control(z,ta);var ua=function(a){function b(){a.apply(this,arguments),this.replaceWith="input",this.value=""}return __extends(b,a),b.prototype.setClasses=function(a,b){this.dom.addClass(b||this.element,A+" "+(a||""))},b.prototype.initialize=function(){this.setClasses()},b.prototype.setTemplate=function(){this.dom.clearNode(this.element)},b.prototype.loaded=function(){var a=this.options||{},b=a.value||{},c=b.pattern,d=b.validation,e=this.utils.isString;this._type=this.attributes.type||b.type||"text",e(c)&&""!==c&&("/"===c[0]&&"/"===c[c.length-1]&&(c=c.slice(1,-1)),this._pattern=new RegExp(c)),e(d)&&""!==d&&("/"===d[0]&&"/"===d[d.length-1]&&(d=d.slice(1,-1)),this._validation=new RegExp(d)),this._initializeType()},b.prototype.validate=function(){return this._validation.test(this.element.value)},b.prototype.clear=function(){var a=this.element,b=a.value;""!==b&&(a.value=this.value="",this.inputChanged(this.value,b))},b.prototype.focus=function(){this.element.focus()},b.prototype.blur=function(){this.element.blur()},b.prototype.observeProperties=function(a){a.observeProperty(this._setBoundProperty,null,!0)},b.prototype._setBoundProperty=function(a,b,c,d){var e=this.element.value;if(this.utils.isNull(a)){if(a="",d===!0)return void(this.utils.isNull(e)&&this._onInputChanged(a))}else if(a===e)return;this._onInputChanged(a)},b.prototype._initializeType=function(){var a=this._type;switch(a){case"text":this._pattern=this._pattern||/[\S\s]*/,this._validation=this._validation||this._pattern;break;case"email":this._pattern=this._pattern||/[\S\s]*/,this._validation=this._validation||this._regex.validateEmail;break;case"password":this._pattern=this._pattern||/[\S\s]*/,this._validation=this._validation||this._pattern;break;case"telephone":a="tel";case"tel":this._pattern=this._pattern||this._regex.validateTelephone,this._validation=this._validation||this._pattern;break;case"number":this._pattern=this._pattern||/^[0-9\.,]*$/,this._validation=this._validation||this._pattern,a="tel";break;case"hidden":return void this.element.setAttribute(G,"");case"radio":return void this._log.debug(a+" is not supported by "+this.type+". Please use a "+v+" instead.");case"checkbox":return void this._log.debug(a+" is not supported by "+this.type+". Please use a "+p+" instead.");case"range":return void this._log.debug(a+" is not supported by "+this.type+". Please use a "+x+" instead.");case"file":return void this._log.debug(a+" is not supported by "+this.type+". Please use a "+B+" instead.");default:this._log.debug(a+" is not yet fully supported by "+this.type+'. Defaulting to type="text".'),a="text",this._pattern=this._pattern||/[\S\s]*/,this._validation=this._validation||this._pattern}this._addTextEventListener()},b.prototype._addTextEventListener=function(){var a,b=this,c=this.element,d=this._compat,e=this.utils,f=!1,g=function(){f||b._onInput()},h=function(){e.isFunction(a)||(a=e.postpone(function(){g(),a=null}))};e.isUndefined(d.ANDROID)&&(this.addEventListener(c,"compositionstart",function(){return f=!0},!1),this.addEventListener(c,"compositionend",function(){f=!1,g()},!1)),d.hasEvent("input")?this.addEventListener(c,"input",g,!1):(this.addEventListener(c,"keydown",function(a){var d=a.keyCode;if(!(91===d||92===d||d>15&&28>d||d>32&&41>d)){var e=b._pattern,f=a.char;return e.test(f)&&e.test(c.value+f)?void h():void a.preventDefault()}},!1),this.addEventListener(c,"cut",h,!1),this.addEventListener(c,"paste",h,!1)),this.addEventListener(c,"change",g,!1)},b.prototype._onInput=function(){var a=this.element,b=a.value,c=this._stripInput(a.value);b!==c&&(b=a.value=c),b!==this.value&&(this.value=a.value,this.inputChanged(this.value))},b.prototype._onInputChanged=function(a){var b=this.element;a=this._stripInput(a),b.value=a,this.value=b.value},b.prototype._stripInput=function(a){for(var b,c="",d=c,e=this._pattern,f=a.length,g=0;f>g;++g)b=a[g],e.test(b)&&(c+=b,e.test(c)?d=c:c=d);return c},b._inject={_compat:d,_regex:e},b}(plat.ui.BindControl);a.Input=ua,plat.register.control(A,ua);var va=function(a){function b(){a.apply(this,arguments),this.templateString='<div class="plat-file-container">\n    <input type="file" class="plat-file-hidden" />\n    <input type="text" class="plat-file-input" plat-keydown="_onKeyDown" />\n    <button class="plat-file-button" plat-tap="_selectFiles"></button>\n</div>\n',this._removeListener=ha}return __extends(b,a),b.prototype.setClasses=function(a,b){this.dom.addClass(b||this.element,B+" "+(a||""))},b.prototype.initialize=function(){this.setClasses()},b.prototype.setTemplate=function(){for(var a,b,c,d=this.element,e=this._hiddenInput=d.firstElementChild.firstElementChild,f=this._visibleInput=e.nextElementSibling,g=f.nextElementSibling,h=this.attributes,i=Object.keys(h),j=i.length,k=plat.dependency.injectors.control,l=/plat-(?:control|hide|context)|class|style/,m=!1,n=this.utils,o=n.isNull,p=n.delimit,q=n.isString,r=0;j>r;++r)a=i[r],b=p(a,"-"),c=h[a],q(c)&&!l.test(b)&&o(k[b])?"id"===b?(d.removeAttribute(b),e.setAttribute(b,c)):"multiple"===b?(m=!0,e.setAttribute(b,c)):"disabled"===b?(e.setAttribute(b,c),f.setAttribute(b,c),g.setAttribute(b,c)):e.setAttribute(b,c):b===L&&(e.setAttribute(b,c),f.setAttribute(b,c),g.setAttribute(b,c));if(o(this.innerTemplate))return void(g.textContent=m?"Select files":"Select a file");var s=this.innerTemplate.textContent.replace(/\r|\n/g,"");return n.isEmpty(s)?void(g.textContent=m?"Select files":"Select a file"):void(g.textContent=s)},b.prototype.loaded=function(){var a=this._hiddenInput=this._hiddenInput||this.element.firstElementChild.firstElementChild;this._visibleInput=this._visibleInput||a.nextElementSibling,this._addChangeListener()},b.prototype.validate=function(){return!this.utils.isEmpty(this._hiddenInput.value)},b.prototype.clear=function(){var a=this._hiddenInput;if(!this.utils.isEmpty(a.value)){a.value=null;var b=this._hiddenInput=a.cloneNode(!0);this.element.firstElementChild.replaceChild(b,a),this._addChangeListener(),this._visibleInput.value="",this.inputChanged(null),this._trigger("change")}},b.prototype.click=function(){this._selectFiles()},b.prototype.value=function(){var a=this._hiddenInput,b=a.files;if(!this.utils.isNull(b))return a.multiple?Array.prototype.slice.call(b):b[0]},b.prototype.disable=function(){var a="disabled",b=this._visibleInput;this._hiddenInput.setAttribute(a,a),b.setAttribute(a,a),b.nextElementSibling.setAttribute(a,a),this.element.setAttribute(a,a)},b.prototype.enable=function(){var a="disabled",b=this._visibleInput;this._hiddenInput.removeAttribute(a),b.removeAttribute(a),b.nextElementSibling.removeAttribute(a),this.element.removeAttribute(a)},b.prototype.observeProperties=function(a){a.observeProperty(this._setBoundProperty)},b.prototype._setBoundProperty=function(a,b,c,d){var e=this.utils;if(!e.isFile(a))return void this.clear();var f=this._hiddenInput,g=f.files;if(!e.isNull(g)){if(!f.multiple)return void(a!==g[0]&&(this.inputChanged(g[0]),this._trigger("change")));this.inputChanged(Array.prototype.slice.call(g)),this._trigger("change")}},b.prototype._addChangeListener=function(){this._removeListener(),this._removeListener=this.addEventListener(this._hiddenInput,"change",this._filesSelected,!1)},b.prototype._onKeyDown=function(a){var b=a.keyCode,c=plat.controls.KeyCodes;return b===c.tab?!0:(b!==c.backspace&&b!==c.delete||this.clear(),a.preventDefault(),!1)},b.prototype._selectFiles=function(){this._hiddenInput.click()},b.prototype._filesSelected=function(){var a=this._hiddenInput,b=this._visibleInput,c=a.files;if(this.utils.isEmpty(c))return void this.clear();if(a.multiple){for(var d=[],e=c.length,f=0;e>f;++f)d.push(c[f].name);b.value=d.join(", "),this.inputChanged(Array.prototype.slice.call(c))}else{var g=c[0];b.value=g.name,this.inputChanged(g)}this._trigger("change")},b.prototype._trigger=function(a){var b=plat.acquire(i);b.initialize(this.element,a),b.trigger()},b._inject={_compat:d},b}(plat.ui.BindControl);a.File=va,plat.register.control(B,va);var wa=function(a){function b(){a.apply(this,arguments),this.templateString='<div class="plat-carousel-viewport">\n    <div class="plat-carousel-container"></div>\n</div>\n',this._listeners=[],this._isVertical=!1,this._hasSwiped=!1,this._inTouch=!1,this._hasMoved=!1,this._lastTouch={x:0,y:0},this._loaded=!1,this._index=-1,this._previousIndex=-1,this._nextIndex=-1,this._currentOffset=0,this._removeInterval=ha,this._removeSuspend=ha,this._isAuto=!1,this._isPaused=!1,this._selfPause=!1,this._itemNodes=[],this._removeListeners=[],this._outerStart=!1,this._outerEnd=!1,this._goToIntervalConstant=125}return __extends(b,a),Object.defineProperty(b.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),b.prototype.setClasses=function(a,b){this.dom.addClass(b||this.element,C+" "+(a||""))},b.prototype.contextChanged=function(a,b){var c=this.utils;return c.isFunction(this._onLoad)?(c.isArray(a)?this._setListener():(this._log.debug(this.type+" context set to something other than an Array."),a=[]),this._executeEvent([{object:a,type:"splice"}]),void this._initializeIndex(0)):void this.loaded()},b.prototype.initialize=function(){this.setClasses()},b.prototype.setTemplate=function(){var a=this._document.createElement("div");a.className=C+"-item",a.appendChild(this.innerTemplate),this.bindableTemplates.add("item",a)},b.prototype.loaded=function(){var a=this,b=this.utils,c=this.context;if(!b.isArray(c))return void this._log.warn("The context of a "+this.type+" must be an Array.");this._animate=!1;var d=this.options||{},e=d.value||{},f=e.index,g=b.isNumber,h=this._validateOrientation(e.orientation),i=e.interval,j=this._interval=g(i)?Math.abs(i):3e3,k=e.suspend,l=this.dom,m=this.element,o=this._viewport=m.firstElementChild;this._container=o.firstElementChild,this._type=e.type||"track swipe",this._isInfinite=e.infinite===!0,this._suspend=Math.abs(g(k)?j-k:j-3e3),l.addClass(m,n+h),this._onLoad=function(){var b=a._index;f=g(f)&&f>=0?f<c.length?f:c.length-1:null,a._index=0,l.whenVisible(function(){a._initializeIndex(null===f?b:f),a._addEventListeners(),a._loaded=!0},m)},this._init()},b.prototype.goToNext=function(){return this._goToNext(!1)},b.prototype.goToPrevious=function(){return this._goToPrevious(!1)},b.prototype.goToIndex=function(a,b){return this._goToIndex(a,!1,b)},b.prototype.pause=function(){this._selfPause=!1,this._isAuto&&!this._isPaused&&(this._isPaused=!0,this._removeSuspend(),this._removeSuspend=ha,this._removeInterval(),this._removeInterval=ha)},b.prototype.resume=function(){this._isAuto&&this._isPaused&&(this._isPaused=this._selfPause=!1,this._initiateInterval())},b.prototype.dispose=function(){a.prototype.dispose.call(this),this._listeners=[],this._removeEventListeners()},b.prototype.onInput=function(a){var b=this._listeners;return b.push(a),function(){var c=b.indexOf(a);-1!==c&&b.splice(c,1)}},b.prototype.inputChanged=function(a,b){if(a!==b)for(var c=this._listeners,d=c.length,e=0;d>e;++e)c[e](a,b)},b.prototype.observeProperties=function(a){a.observeProperty(this._setBoundProperty)},b.prototype._setBoundProperty=function(a,b,c,d){var e=this.utils;if(e.isNull(a)){if(d===!0)return this._index=0,void this.inputChanged(0,a)}else if(e.isNumber(a)){if(0>a)return this._index=0,this.inputChanged(0,a),void this._initializeIndex(0)}else if(a=Number(a),!e.isNumber(a))return void this._log.warn(this.type+" has its index bound to a property that cannot be interpreted as a Number.");return this._loaded?void this._goToIndex(a,!0,d===!0):void(this._index=a)},b.prototype._reset=function(){var a={};a[this._transform]=this._calculateStaticTranslation(0),this._initiateAnimation({properties:a})},b.prototype._verifyLength=function(){var a=this.context,b=this._index;if(!this.utils.isArray(a)||0===a.length)return this.utils.isUndefined(b)||this.inputChanged(this._index=void 0,b),this._container.style[this._transform]=this._calculateStaticTranslation(-this._currentOffset),this._removeEventListeners(),void this._checkArrows();var c=a.length-1;return b>c?void this.goToIndex(c):void this._checkArrows()},b.prototype._setIndexWindow=function(){var a=this._index,b=this._itemNodes.length-1;0>b?this._previousIndex=this._nextIndex=b:a>=b?(a>b&&(a=this._index=b),this._previousIndex=a-1,this._nextIndex=this._isInfinite?0:-1):0>=a?(0>a&&(a=this._index=0),this._previousIndex=this._isInfinite?b:-1,this._nextIndex=a+1):(this._previousIndex=a-1,this._nextIndex=a+1)},b.prototype._goToNext=function(a){var b=this;return this._Promise.all(this._addQueue).then(function(){var c=b._index,d=!1;if(c>=b._itemNodes.length-1&&!(d=b._isInfinite))return b._isAuto&&!b._isPaused&&(b.pause(),b._selfPause=!0),b._Promise.resolve(!1);var e=b._getLength();return e?b._cancelCurrentAnimations().then(function(){b._outerEnd||b._initializeOuterNodes();var f={};f[b._transform]=b._calculateStaticTranslation(-e);var g,h=b._initiateAnimation({properties:f});return d?b._index=g=0:g=++b._index,a||b.inputChanged(b._index,c),h.then(function(){return b._handleNext(g,e),b._checkArrows(),!0})}):b.goToIndex(b._nextIndex,!0)})},b.prototype._goToPrevious=function(a){var b=this;return this._Promise.all(this._addQueue).then(function(){var c=b._index,d=!1;if(0>=c&&!(d=b._isInfinite))return b._Promise.resolve(!1);b._selfPause&&b.resume();var e=b._getLength();return e?b._cancelCurrentAnimations().then(function(){b._outerStart||b._initializeOuterNodes();var f={};f[b._transform]=b._calculateStaticTranslation(e);var g,h=b._initiateAnimation({properties:f});return d?b._index=g=b._itemNodes.length-1:g=--b._index,a||b.inputChanged(b._index,c),h.then(function(){return b._handlePrevious(g,-e),b._checkArrows(),!0})}):b.goToIndex(b._previousIndex,!0)})},b.prototype._goToIndex=function(a,b,c){var d=this;return this._Promise.all(this._addQueue).then(function(){var e=d._index;return d.utils.isUndefined(e)?(d._initializeIndex(0),d.inputChanged(d._index,a),d._isInfinite||(a<d.context.length-1?d._selfPause&&d.resume():d._isAuto&&!d._isPaused&&(d.pause(),d._selfPause=!0)),d._Promise.resolve(!0)):a===e?d._Promise.resolve(!1):c===!0?(d._initializeIndex(a),d.inputChanged(d._index,a),d._isInfinite||(a<d.context.length-1?d._selfPause&&d.resume():d._isAuto&&!d._isPaused&&(d.pause(),d._selfPause=!0)),d._Promise.resolve(!0)):a-e>0&&a===d._nextIndex?d._goToNext(b):a===d._previousIndex?d._goToPrevious(b):d._handleGoToIndex(a,b)})},b.prototype._handleGoToIndex=function(a,b){var c=this._index;if(a===c||0>a||a>=this.context.length)return this._Promise.resolve(!1);if(this._selfPause&&this.resume(),!this._getLength())return this._initializeIndex(a),this._Promise.resolve(!0);var d,e,f,g=this._Promise,h=this.utils.defer;a>c?(d=this._goToNext,e=a-c,this._isInfinite&&(f=this._itemNodes.length-a+c,e>f&&(d=this._goToPrevious,e=f))):(d=this._goToPrevious,e=c-a,this._isInfinite&&(f=this._itemNodes.length-c+a,e>f&&(d=this._goToNext,e=f))),d=d.bind(this);for(var i=[],j=this._removeListeners,k=this._goToIntervalConstant,l=0,m=function(a){var c=h(function(){var e=j.indexOf(c);-1!==e&&j.splice(e,1),a(d(b))},l+=Math.round(k/e));j.push(c)};--e>0;)i.push(new g(m));return i.push(d(b)),g.all(i).then(function(a){for(var b=!1;a.length>0&&!(b=b||a.pop()););return b})},b.prototype._handleNext=function(a,b){var c=this._isInfinite,d=this._itemNodes,e=d.length,f=this.utils.isNode;if(c&&(3>e||f(this._preClonedNode)||f(this._postClonedNode)))return void this._initializeIndex(a);var g=this._container;this._outerStart?(c||a>1)&&(this.dom.insertBefore(d[this._previousIndex],Array.prototype.slice.call(g.childNodes,0,3)),
g.style[this._transform]=this._calculateStaticTranslation(b),this._forceRepaint(g)):this._outerStart=!0,this._setIndexWindow(),(c||e-1>a)&&g.insertBefore(d[this._nextIndex],null)},b.prototype._handlePrevious=function(a,b){var c=this._isInfinite,d=this._itemNodes,e=d.length,f=this.utils.isNode;if(c&&(3>e||f(this._preClonedNode)||f(this._postClonedNode)))return void this._initializeIndex(a);var g=this._container;this._outerEnd?(c||e-2>a)&&this.dom.insertBefore(d[this._nextIndex],Array.prototype.slice.call(g.childNodes,-3)):this._outerEnd=!0,this._setIndexWindow(),(c||a>0)&&(g.insertBefore(d[this._previousIndex],g.firstChild),g.style[this._transform]=this._calculateStaticTranslation(b),this._forceRepaint(g))},b.prototype._clearInnerNodes=function(){this._removeClones(),this._outerStart=this._outerEnd=!1;var a=this._itemNodes;if(0===a.length)return!1;var b=Array.prototype.slice.call(this._container.childNodes),c=this.dom.insertBefore;switch(b.length){case 9:c(a[this._previousIndex],b.splice(0,3)),c(a[this._nextIndex],b.splice(-3,3)),c(a[this._index],b);break;case 6:var d=this._nextIndex,e=this._index;if(0>d||d===e){c(a[e],b.splice(-3,3)),c(a[0===e?this._previousIndex+1:e-1],b);break}c(a[d],b.splice(-3,3)),c(a[e],b);break;case 3:c(a[this._index],b)}return!0},b.prototype._initializeIndex=function(a){var b=this._clearInnerNodes();if(0===this._itemNodes.length?a=-1:0>a&&(a=0),this._index=a,this._setIndexWindow(),!b)return!1;var c=this._container;return c.insertBefore(this._itemNodes[a],null),c.style[this._transform]=this._calculateStaticTranslation(-this._currentOffset),this._forceRepaint(c),this._initializeOuterNodes(),this._checkArrows(),!0},b.prototype._initializeOuterNodes=function(){var a=this._getLength();if(!a)return void(this._outerStart=this._outerEnd=!1);var b,c=this._itemNodes,d=this._container,e=c.length;if(1>=e){if(this._isInfinite)return void this._cloneForInfinite(-a)}else{var f=this.utils.isNode;this._outerEnd||(b=c[this._nextIndex],f(b)&&(d.insertBefore(b,null),this._outerEnd=!0)),e>2?!this._outerStart&&(this._isInfinite||this._index>0)&&(b=c[this._previousIndex],f(b)&&(d.insertBefore(b,d.firstChild),d.style[this._transform]=this._calculateStaticTranslation(-a),this._forceRepaint(d),this._outerStart=!0)):this._isInfinite&&this._cloneForInfinite(-a)}},b.prototype._initiateAnimation=function(a){return this._animationThenable=this._animator.animate(this._container,Q,a)},b.prototype._init=function(){var a=this,b=this._addQueue,c=this.context.length;this._setAliases();var d=this._addItems(0,c,0).then(function(){var c=b.indexOf(d);-1!==c&&b.splice(c,1),a._onLoad()}).catch(function(){a._log.debug("An error occurred while processing the "+a.type+". Please ensure you're context is correct."),a._loaded=!1});b.push(d),this._setListener(),this._setTransform()},b.prototype._addEventListeners=function(){var a=this,b=this._type.split(" ");-1!==b.indexOf("tap")&&this._initializeTap(),-1!==b.indexOf("swipe")&&this._initializeSwipe(),-1!==b.indexOf("track")&&this._initializeTrack(),-1!==b.indexOf("auto")&&this._initializeAuto();var c=!1;this.addEventListener(this._window,"resize",function(){c||(c=!0,a.utils.requestAnimationFrame(function(){c=!1;var b=a._length,d=a._getLength();d&&b!==d&&(a._isInfinite||0!==a._index)&&(a._container.style[a._transform]=a._calculateStaticTranslation(b-d))}))},!1)},b.prototype._removeEventListeners=function(){for(var a=this._removeListeners;a.length>0;)a.pop()();this._removeInterval(),this._removeSuspend(),this._isInfinite&&this._removeClones(),this._onLoad=ha},b.prototype._cloneForInfinite=function(a){this._removeClones();var b=this.context;if(this.utils.isArray(b)&&0!==b.length){var c=this._outerStart,d=this._outerEnd;if(!c||!d){var e=this._container;if(!d){var f=this._postClonedNode=e.firstElementChild.cloneNode(!0);e.insertBefore(f,null),this._outerEnd=!0}if(!c){var g=this._preClonedNode=e.lastElementChild.cloneNode(!0);e.insertBefore(g,e.firstChild),e.style[this._transform]=this._calculateStaticTranslation(a),this._forceRepaint(e),this._outerStart=!0}}}},b.prototype._removeClones=function(){var a=this._container,b=this._preClonedNode,c=this._postClonedNode,d=this.utils.isNode;d(b)&&a.contains(b)&&a.removeChild(b),d(c)&&a.contains(c)&&a.removeChild(c),this._preClonedNode=this._postClonedNode=null},b.prototype._initializeAuto=function(){this._isAuto=!0,this._initiateInterval()},b.prototype._initiateInterval=function(){this._removeInterval=this.utils.setInterval(this.goToNext,this._interval,null,this)},b.prototype._suspendInterval=function(){var a=this;this._isAuto&&!this._isPaused&&(this._removeSuspend(),this._removeInterval(),this._removeSuspend=this.utils.defer(function(){a._initiateInterval(),a._removeSuspend=ha},this._suspend))},b.prototype._initializeTap=function(){var a=this;this.utils.isNode(this._forwardArrow)||this._createArrowElements();var b=this._removeListeners;b.push(this.addEventListener(this._backArrow,T,function(){a._suspendInterval(),a.goToPrevious()},!1)),b.push(this.addEventListener(this._forwardArrow,T,function(){a._suspendInterval(),a.goToNext()},!1)),this._checkArrows()},b.prototype._createArrowElements=function(){var a=this._document,b=this._viewport,c=this._backArrow=a.createElement("div"),d=this._forwardArrow=a.createElement("div"),e=a.createElement("span"),f=a.createElement("span");this._isVertical?(e.className=n+"icon-arrow-up",f.className=n+"icon-arrow-down"):(e.className=n+"icon-arrow-left",f.className=n+"icon-arrow-right"),c.className=n+"back-arrow",d.className=n+"forward-arrow",c.appendChild(e),d.appendChild(f),b.appendChild(c),b.appendChild(d)},b.prototype._checkArrows=function(){var a=this.utils,b=a.isNode;if(!this._isInfinite&&b(this._forwardArrow)&&b(this._backArrow)){var c=this.context.length,d=this._index;if(a.isNull(d))return this._backArrow.setAttribute(G,""),void this._forwardArrow.setAttribute(G,"");0>=d?this._backArrow.setAttribute(G,""):this._backArrow.removeAttribute(G),d>=c-1?this._forwardArrow.setAttribute(G,""):this._forwardArrow.removeAttribute(G)}},b.prototype._initializeSwipe=function(){var a,b,c=this._viewport,d=this._handleSwipe;this._isVertical?(a=X+"up",b=X+"down"):(a=X+"left",b=X+"right");var e=this._removeListeners;e.push(this.addEventListener(c,a,d,!1)),e.push(this.addEventListener(c,b,d,!1))},b.prototype._initializeTrack=function(){var a,b,c=this._viewport,d=this._track,e=this._touchEnd;this._isVertical?(a=Y+"up",b=Y+"down"):(a=Y+"left",b=Y+"right");var f=this._removeListeners;f.push(this.addEventListener(c,a,d,!1)),f.push(this.addEventListener(c,b,d,!1)),f.push(this.addEventListener(c,U,this._touchStart,!1)),f.push(this.addEventListener(c,Z,e,!1)),f.push(this.addEventListener(c,V,e,!1))},b.prototype._handleSwipe=function(a){var b=a.direction.primary,c=!1;switch(b){case"left":!this._isVertical&&(this._isInfinite||this._index<this.context.length-1)&&(this._suspendInterval(),c=!0,this.goToNext());break;case"right":!this._isVertical&&(this._isInfinite||this._index>0)&&(this._suspendInterval(),c=!0,this.goToPrevious());break;case"up":this._isVertical&&(this._isInfinite||this._index<this.context.length-1)&&(this._suspendInterval(),c=!0,this.goToNext());break;case"down":this._isVertical&&(this._isInfinite||this._index>0)&&(this._suspendInterval(),c=!0,this.goToPrevious());break;default:return}this._hasSwiped=c},b.prototype._touchStart=function(a){this._inTouch||(this._isAuto&&(this._removeInterval(),this._removeInterval=ha),this._inTouch=!0,this._hasMoved=!1,this._lastTouch={x:a.clientX,y:a.clientY})},b.prototype._touchEnd=function(a){var b=this,c=this._inTouch,d=this._hasMoved,e=this._hasSwiped;if(this._inTouch=this._hasSwiped=this._hasMoved=!1,c&&!e&&(this._isAuto&&!this._isPaused&&this._initiateInterval(),d)){var f=this._isVertical?a.clientY-this._lastTouch.y:a.clientX-this._lastTouch.x,g=this._getLength();return g&&Math.abs(f)>Math.ceil(g/2)?0>f?void this.goToNext().then(function(a){a||b._reset()}):void this.goToPrevious().then(function(a){a||b._reset()}):void this._reset()}},b.prototype._track=function(a){var b=this;this._inTouch&&(this._hasMoved||this._cancelCurrentAnimations().then(function(){b._outerStart&&b._outerEnd||b._initializeOuterNodes()}),this._hasMoved=!0,this.utils.requestAnimationFrame(function(){var c=b._calculateDynamicTranslation(a);null!==c&&(b._container.style[b._transform]=c)}))},b.prototype._calculateStaticTranslation=function(a){return this._isVertical?"translate3d(0,"+(this._currentOffset+=a)+"px,0)":"translate3d("+(this._currentOffset+=a)+"px,0,0)"},b.prototype._calculateDynamicTranslation=function(a){var b;return this._isVertical?(b=a.clientY-this._lastTouch.y,Math.abs(b)>this._getLength()?(this._touchEnd(a),null):"translate3d(0,"+(this._currentOffset+b)+"px,0)"):(b=a.clientX-this._lastTouch.x,Math.abs(b)>this._getLength()?(this._touchEnd(a),null):"translate3d("+(this._currentOffset+b)+"px,0,0)")},b.prototype._setTransform=function(){var a=this._container.style,b=this.utils.isUndefined,c=this._compat.vendorPrefix;b(a[c.lowerCase+"Transform"])?b(a[c.upperCase+"Transform"])?this._transform="transform":this._transform=c.upperCase+"Transform":this._transform=c.lowerCase+"Transform"},b.prototype._getLength=function(){return this._length=this._isVertical?this._viewport.offsetHeight:this._viewport.offsetWidth},b.prototype._validateOrientation=function(a){if(this.utils.isUndefined(a))return"horizontal";var b;return"horizontal"===a?b=a:"vertical"===a?(b=a,this._isVertical=!0):(this._log.debug('Invalid orientation "'+a+'" for '+this.type+'. Defaulting to "horizontal."'),b="horizontal"),b},b.prototype._appendItems=function(a){if(this._itemNodes=this._itemNodes.concat(a),this._loaded){var b=this._index;if(0===this._removeListeners.length)return this._addEventListeners(),this._initializeIndex(0),void this.inputChanged(0,b);b>=this._itemNodes.length-2&&this._initializeIndex(b)}},b.prototype._removeItems=function(a,b){for(var c=this._TemplateControlFactory.dispose,d=this.controls,e=this._itemNodes,f=a+b;f-- >a;)c(d[f]),e.pop();this._updateResource(d.length-1),this._verifyLength()},b.prototype._cancelCurrentAnimations=function(){return this.utils.isNull(this._animationThenable)?this._Promise.resolve():this._animationThenable.cancel()},b.prototype._forceRepaint=function(a){var b=a.style,c=b.display,d="none";return b.display===d?void a.offsetWidth:(b.display=d,a.offsetWidth,void(b.display=c))},b._inject={_document:g,_window:f,_compat:d,_TemplateControlFactory:j},b}(plat.ui.controls.ForEach);a.Carousel=wa,plat.register.control(C,wa);var xa=function(a){function b(){var b=this;a.call(this),this.templateString=this.__templateString,this._aliases={index:P.index,even:P.even,odd:P.odd,first:P.first,last:P.last,group:P.group},this._templates={},this._isVertical=!0,this._scrollReady=!0,this._isLoading=!1,this._scrollPosition=0,this._removeScroll=ha,this._isRefreshing=!1,this._touchState=0,this._hasMoved=!1,this._lastTouch={x:0,y:0},this._nodeNormalizeRegex=/-|\.|_/g,this._isGrouped=!1,this._visibilityRemoveListeners=[],this.__templateString='<div class="plat-listview-viewport">\n    <div class="plat-scroll-container">\n        <div class="plat-listview-container"></div>\n    </div>\n</div>\n',this.__listenerSet=!1,this.itemsLoaded=new this._Promise(function(a,c){b.__resolveFn=a,b.__rejectFn=c}).catch(ha)}return __extends(b,a),b.prototype.setClasses=function(a,b){this.dom.addClass(b||this.element,D+" "+(a||""))},b.prototype.initialize=function(){var a=this.options||(this.options={}),b=a.value||(a.value={});this.templateUrl=b.templateUrl||this.templateUrl,this.setClasses()},b.prototype.setTemplate=function(){if(this.templateString!==this.__templateString||this.utils.isString(this.templateUrl)){var a=this.dom.serializeHtml(this.__templateString),b=this.element;this.innerTemplate=this.dom.appendChildren(b.childNodes),b.appendChild(a)}},b.prototype.contextChanged=function(a,b){this.utils.isArray(a)?this._setListener():(this._log.debug(this.type+" context set to something other than an Array."),a=[]),this._executeEvent([{object:a,type:"splice"}])},b.prototype.loaded=function(){var a=this.options.value,b=this.utils,c=b.isString,d=this.element,e=this._viewport=d.firstElementChild,f=this._scrollContainer=e.firstElementChild,g=this._loading=a.loading,h=this._animate=a.animate===!0,i=a.onItemsRequested,j=a.onRefresh,k=a.itemTemplate,l=a.scrollElement;if(this._container=f.firstElementChild,this.dom.addClass(d,n+this._validateOrientation(a.orientation)+(h?" "+n+"animated":"")),c(l)&&(l=this._document.querySelector(l)),b.isNode(l)&&(this._scrollContainer=l,this.dom.addClass(d,n+"no-scroller")),!c(k))return void this._log.debug("No item template or item template selector specified for "+this.type+".");var m=this._normalizeTemplateName(k),o=a.headerTemplate,p=c(o)?this._normalizeTemplateName(o):null;this._parseInnerTemplate(m,p),this._determineTemplates(k,m,p),this._defaultGroup={name:null,control:this,itemContainer:this._container,element:d,index:null,itemCount:0,addQueue:[],animationQueue:[]};var q=!1;return c(g)&&(c(i)?this._determineLoading(i,a.infiniteProgress!==!1):this._log.debug(this.type+' loading type specified as "'+g+'" but no option specifying an onItemsRequested handler.')),c(j)&&(q=!0,this._initializeRefresh(j)),this._initializeTracking("incremental"===g,q),b.isArray(this.context)?(this._setAliases(),this._setContainerHeight(),this.render(),void this._setListener()):void(b.isNull(this.context)||this._log.debug(this.type+"'s context must be an Array."))},b.prototype.dispose=function(){for(var a=this._visibilityRemoveListeners;a.length>0;)a.pop()();this._removeScroll(),this.utils.isFunction(this.__rejectFn)&&(this.__rejectFn(),this.__resolveFn=this.__rejectFn=null)},b.prototype.render=function(a,b,c){var d=this.utils.isNumber,e=c||this._defaultGroup,f=e.control,g=this===f?this.context:f.context.items;d(a)||(a=0);var h=g.length-a,i=d(b)&&h>=b?b:h;this._createItems(a,i,e,0)},b.prototype.rerender=function(a){this.render(0,null,a)},b.prototype._childContextChanged=function(a,b,c){this._executeChildEvent(a,[{object:b||[],type:"splice"}])},b.prototype._setListener=function(){this.__listenerSet||(this.observeArray(this._executeEvent),this.__listenerSet=!0)},b.prototype._setAliases=function(){var a=this.options.value.aliases,b=this.utils;if(b.isObject(a))for(var c,d=this._aliases,e=b.isString,f=Object.keys(d),g=f.length,h=0;g>h;++h)c=a[f[h]],e(c)&&(d[f[h]]=c)},b.prototype._determineTemplates=function(a,b,c){var d,e=this.utils,f=this.bindableTemplates,g=this._templates;if(e.isString(c)&&(this._isGrouped=!0,this.dom.addClass(this._container,n+"grouped"),d=g[c],e.isNode(d)?(this._headerTemplate=c,this.bindableTemplates.add(c,d),delete g[c]):this._log.debug(D+' group header template "'+c+'" was not a template defined in the DOM.'),this._headerTemplatePromise=this._createGroupTemplate()),d=g[b],e.isNode(d))return this._itemTemplate=b,this.bindableTemplates.add(b,d),void delete g[b];var h=this.findProperty(a)||{};if(!e.isFunction(h.value))return void this._log.debug(D+' item template "'+a+'" was neither a template defined in the DOM nor a template selector function in its control hiearchy.');this._templateSelector=h.value.bind(h.control),this._templateSelectorKeys={};for(var i,j=Object.keys(g);j.length>0;)i=j.pop(),f.add(i,g[i]),delete g[i]},b.prototype._createGroupTemplate=function(){var a,b=this,c=this._document,d=this.bindableTemplates,e=this._headerTemplate,f=D+"-group",g=c.createElement("div"),h=c.createElement("div");return g.className=f,h.className=D+"-items",this.utils.isString(e)&&(a=d.templates[e].then(function(a){g.insertBefore(a.cloneNode(!0),null)})),this._Promise.resolve(a).then(function(){g.insertBefore(h,null),d.add(f,g)}).then(null,function(a){b._log.debug(b.type+" error: "+a)})},b.prototype._addGroups=function(a,b,c){for(var d=this,e=b,f=+(b+a),g=[];f>b;)g.push(this._bindGroup(b++));return this._Promise.all(g).then(function(a){for(var b=a.length,f=0;b>f;++f)d._addGroup(f+e,a[f],c>f)})},b.prototype._addGroup=function(b,c,d){var e,f,g=this,h=this.utils,i=this.context,j=this._groups||(this._groups={}),k=i[b],l=k.group,m=c.childNodes[1],n=m.lastElementChild,o=this.controls[b],p=j[l]={name:l,index:b,element:m,itemContainer:n,control:o,itemCount:0,addQueue:[],animationQueue:[]},q="items";if(o.dispose=function(){a.prototype.dispose.call(g),delete j[l]},o.observe(function(a,b){var c=a.group;if(c!==l&&h.isObject(a)){var d=j[l];delete j[l],d.name=c,j[c]=d,l=c,e(),f(),e=o.observe(g._childContextChanged.bind(g,l),q),f=o.observeArray(g._executeChildEvent.bind(g,l),q)}}),e=o.observe(this._childContextChanged.bind(this,l),q),f=o.observeArray(this._executeChildEvent.bind(this,l),q),this._createItems(0,(k.items||[]).length,p,0),d){var r=this._defaultGroup.animationQueue,s={animation:this._animator.enter(c,R,this._container).then(function(){var a=r.indexOf(s);a>-1&&r.splice(a,1),h.requestAnimationFrame(g._setGroupContainerPadding.bind(g,m))}),op:null};return void r.push(s)}this._container.insertBefore(c,null),h.requestAnimationFrame(this._setGroupContainerPadding.bind(this,m))},b.prototype._bindGroup=function(a){return this.bindableTemplates.bind(D+"-group",a,this._getAliases(this.context,a))},b.prototype._createItems=function(a,b,c,d){var e=this,f=this.utils,g=c||this._defaultGroup,h=g.control,i=this._isVertical,j=this===h;if(j&&this._isGrouped)return void this._headerTemplatePromise.then(function(){e._addGroups(b,a,d)}).then(null,function(a){e._log.debug(e.type+" error: "+a)});var k,l=g.addQueue,m=function(){var a=l.indexOf(k);-1!==a&&l.splice(a,1),j||(g.element.removeAttribute(G),i||j||!e._isGrouped||f.requestAnimationFrame(e._setGroupContainerWidth.bind(e,g.itemContainer)))},n=function(a){e._log.debug(e.type+" error: "+(f.isString(a.message)?a.message:a))};if(f.isFunction(this._templateSelector)){var o=[];g.itemCount+=b;for(var p=0;b>p;++p,++a)o.push(this._renderUsingFunction(a,g));var q=this.itemsLoaded=this._Promise.all(o).then(function(a){for(var b=a.length,c=0;b>c;++c)e._appendRenderedItem(a[c],g,d>c)}).then(m,n);return void l.push(q)}var r=this._itemTemplate;f.isUndefined(this.bindableTemplates.templates[r])||(this._disposeFromIndex(a,g),g.itemCount+=b,k=this._addItems(a,b,g,d).then(m,n),l.push(k))},b.prototype._addItems=function(a,b,c,d){var e,f,g=this,h=c||this._defaultGroup,i=h.control,j=h.itemContainer,k=+(a+b),l=[],m=this._itemTemplate,n=i.bindableTemplates,o=a;for(this===i?(e="",f=this.context):(e="items.",f=i.context.items);k>a;)l.push(n.bind(m,e+a,this._getAliases(f,a++)));return l.length>0&&(this.itemsLoaded=this._Promise.all(l).then(function(a){if(d>0)for(var b=a.length,c=0;b>c;++c)d>c?g._appendAnimatedItem(a[c],h):j.insertBefore(a[c],null);else g._appendItems(a,j);g._updateResource(o-1,i),g.utils.isFunction(g.__resolveFn)&&(g.__resolveFn(),g.__resolveFn=g.__rejectFn=null)}).catch(function(a){g.utils.postpone(function(){g._log.debug(a)})})),this.itemsLoaded},b.prototype._renderUsingFunction=function(a,b){var c,d,e,f=this,g=this._Promise,h=this.utils,i=b||this._defaultGroup,j=i.control;return this===j?(c=a,d=this.context):(c="items."+a,d=j.context.items,e=i.name),g.resolve(this._templateSelectorPromise).then(function(){return f._templateSelectorPromise=g.resolve(f._templateSelector(d[a],a,e))}).then(function(b){var e=j.bindableTemplates,g=e.templates,k=j.controls,l=f._normalizeTemplateName(b),m=i.name,n=f._templateSelectorKeys[m],o=a<k.length;if(h.isUndefined(n)&&(n=f._templateSelectorKeys[m]={}),!h.isUndefined(g[l])){if(o){if(l===n[a])return;return n[a]=l,e.replace(a,l,c,f._getAliases(d,a))}return n[a]=l,e.bind(l,c,f._getAliases(d,a))}f._log.debug(f.type+' template "'+b+'" was not found.'),o&&f._TemplateControlFactory.dispose(k[a])})},b.prototype._appendRenderedItem=function(a,b,c){var d=this.utils,e=b||this._defaultGroup;if(!d.isNull(a)&&!d.isArray(a)){if(c===!0){var f=e.animationQueue,g={animation:this._animator.enter(a,R,e.itemContainer).then(function(){var a=f.indexOf(g);-1!==a&&f.splice(a,1)}),op:null};f.push(g)}else e.itemContainer.insertBefore(a,null);d.isFunction(this.__resolveFn)&&(this.__resolveFn(),this.__resolveFn=null)}},b.prototype._updateResource=function(a,b){var c=b.controls;0>a||a>=c.length||c[a].resources.add(this._getAliases(this===b?this.context:b.context.items,a))},b.prototype._getAliases=function(a,b){var c=0===(1&b),d={},e=this._aliases,f=da;return d[e.index]={value:b,type:f},d[e.even]={value:c,type:f},d[e.odd]={value:!c,type:f},d[e.first]={value:0===b,type:f},d[e.last]={value:b===a.length-1,type:f},d},b.prototype._appendItems=function(a,b){this.dom.appendChildren(a,b)},b.prototype._appendAnimatedItem=function(a,b){if(this.utils.isNode(a)){var c=b.animationQueue,d={animation:this._animator.enter(a,R,b.itemContainer).then(function(){var a=c.indexOf(d);-1!==a&&c.splice(a,1)}),op:null};c.push(d)}},b.prototype._removeItems=function(a,b,c){for(var d=this._TemplateControlFactory.dispose,e=c.control,f=e.controls,g=a+b,h=g>a;g-- >a;)d(f[g]);this._updateResource(f.length-1,e),this!==e&&(0===f.length?c.element.setAttribute(G,""):h&&this._isGrouped&&!this._isVertical&&this.utils.requestAnimationFrame(this._setGroupContainerWidth.bind(this,c.itemContainer)))},b.prototype._disposeFromIndex=function(a,b){for(var c=b||this._defaultGroup,d=c.control,e=d.controls,f=this._TemplateControlFactory.dispose,g=e.length,h=g>a;g-- >a;)f(e[g]);this!==d&&(0===e.length?b.element.setAttribute(G,""):h&&this._isGrouped&&!this._isVertical&&this.utils.requestAnimationFrame(this._setGroupContainerWidth.bind(this,b.itemContainer)))},b.prototype._determineLoading=function(a,b){var c=this,d=this.findProperty(a)||{};if(!this.utils.isFunction(d.value))return void this._log.debug(D+' onItemsRequested function "'+a+'" was not found.');this._requestItems=d.value.bind(d.control);var e;switch(this._loading){case"infinite":var f,g=ha;f=this.addEventListener(this._scrollContainer,"scroll",function(){c._scrollReady&&(c._scrollReady=!1,g=c.utils.requestAnimationFrame(function(){c._scrollReady=!0,c._onScroll()}))},!1),this._removeScroll=function(){c._scrollReady=!1,g(),f()},b&&(e=this._loadingProgressRing=this._document.createElement("div"),e.className=n+"infinite",e.insertBefore(this._generateProgressRing(),null)),this.itemsLoaded.then(this._onScroll.bind(this));break;case"incremental":e=this._loadingProgressRing=this._document.createElement("div"),e.className=n+"incremental",e.setAttribute(G,""),e.insertBefore(this._generateProgressRing(),null),this.element.insertBefore(e,null)}},b.prototype._onScroll=function(){var a=this._scrollContainer,b=this._scrollPosition,c=this._isVertical?a.scrollTop+a.offsetHeight:a.scrollLeft+a.offsetWidth;return b>c?void(this._scrollPosition=c):void(b+5>c||(this._scrollPosition=c,this._handleScroll()))},b.prototype._handleScroll=function(){var a=this,b=this._scrollContainer,c=.8*(this._isVertical?b.scrollHeight:b.scrollWidth);if(0!==c&&this._scrollPosition>=c){var d=this.utils,e=this._requestItems();if(e===!1)this._removeScroll();else if(d.isPromise(e)){var f=this._loadingProgressRing,g=!d.isNull(f),h=this._container;this._scrollReady=!1,g&&d.requestAnimationFrame(function(){h.insertBefore(f,null)}),e.then(function(b){g&&d.requestAnimationFrame(function(){h.removeChild(f)}),b!==!1&&(a._scrollReady=!0)})}else d.postpone(function(){a.itemsLoaded.then(function(){a._scrollReady&&a._handleScroll()})})}},b.prototype._initializeRefresh=function(a){var b=this.findProperty(a)||{};if(!this.utils.isFunction(b.value))return void this._log.debug(D+' onRefresh function "'+a+'" was not found.');this._refresh=b.value.bind(b.control);var c=this._refreshProgressRing=this._document.createElement("div");c.className=n+"refresh",c.setAttribute(G,""),c.insertBefore(this._generateProgressRing(),null),this.element.insertBefore(c,null)},b.prototype._initializeTracking=function(a,b){if(a||b){this._setTransform();var c,d;this._isVertical?(c=Y+"down",d=Y+"up"):(c=Y+"right",d=Y+"left");var e,f,g=this._viewport;this.addEventListener(g,U,this._touchStart,!1),a&&(e=this._touchEndLoad,f=this._trackLoad,this.addEventListener(g,V,e,!1),this.addEventListener(g,Z,e,!1),this.addEventListener(g,W,e,!1),this.addEventListener(g,c,f,!1),this.addEventListener(g,d,f,!1)),b&&(e=this._touchEndRefresh,f=this._trackRefresh,this.addEventListener(g,V,e,!1),this.addEventListener(g,Z,e,!1),this.addEventListener(g,W,e,!1),this.addEventListener(g,c,f,!1),this.addEventListener(g,d,f,!1))}},b.prototype._touchStart=function(a){var b=this;if(0===this._touchState){if(!this._isVertical){var c=Math.ceil(a.offsetY),d=this._viewport.offsetHeight-20;if(c>=d)return}return this._touchState=1,this._lastTouch={x:a.clientX,y:a.clientY},this.utils.isNull(this._touchAnimationThenable)?void(this._touchState=2):void this._touchAnimationThenable.cancel().then(function(){b._touchAnimationThenable=null,b._touchState=2})}},b.prototype._touchEndLoad=function(a){var b=this._isLoading;if(this._isLoading=!1,!b)return void(this._isRefreshing||(this._touchState=0));var c,d,e=this._scrollContainer;return this._isVertical?(c=e.scrollTop+e.offsetHeight,d=e.scrollHeight):(c=e.scrollLeft+e.offsetWidth,d=e.scrollWidth),d>c+1?void(this._touchState=0):void this._touchEnd(a,!1)},b.prototype._touchEndRefresh=function(a){var b=this._isRefreshing;return this._isRefreshing=!1,b?(this._isVertical?this._scrollContainer.scrollTop:this._scrollContainer.scrollLeft)>0?void(this._touchState=0):void this._touchEnd(a,!0):void(this._isLoading||(this._touchState=0))},b.prototype._touchEnd=function(a,b){var c=this,d=this._touchState,e=this._hasMoved;if(this._hasMoved=!1,!(2>d)&&e){var f,g={},h=this.dom,i=this._viewport,j=b?this._refreshProgressRing:this._loadingProgressRing,k=3===d;if(k){var l=void 0;this._isVertical?(l=b?j.offsetHeight:-j.offsetHeight,f="translate3d(0,"+l+"px,0)"):(l=b?j.offsetWidth:-j.offsetWidth,f="translate3d("+l+"px,0,0)")}else f=this._preTransform;g[this._transform]=f,this._touchAnimationThenable=this._animator.animate(i,Q,{properties:g}).then(function(){return c._touchState=4,c._hasMoved=!1,c._touchAnimationThenable=null,k?c._Promise.resolve(b?c._refresh():c._requestItems()):(h.removeClass(i,n+"manipulation-prep"),j.setAttribute(G,""),c._Promise.resolve())}).then(function(){return k?(h.removeClass(j,n+"play"),g[c._transform]=c._preTransform,c._touchAnimationThenable=c._animator.animate(i,Q,{properties:g}).then(function(){c._touchState=0,c._touchAnimationThenable=null,h.removeClass(i,n+"manipulation-prep"),j.setAttribute(G,"")})):void(c._touchState=0)}).then(null,function(a){c._touchState=0,c._log.debug(c.type+" error: "+a)})}},b.prototype._trackLoad=function(a){if(!this._isRefreshing){if(!this._isLoading){var b=this._scrollContainer,c=void 0,d=void 0;if(this._isVertical){if("up"!==a.direction.y)return;c=b.scrollTop+b.offsetHeight,d=b.scrollHeight}else{if("left"!==a.direction.x)return;c=b.scrollLeft+b.offsetWidth,d=b.scrollWidth}if(d>c+1)return;this._isLoading=!0}this._track(a,!1)}},b.prototype._trackRefresh=function(a){if(!this._isLoading){if(!this._isRefreshing){if(this._isVertical){if("down"!==a.direction.y||this._scrollContainer.scrollTop>0)return}else if("right"!==a.direction.x||this._scrollContainer.scrollLeft>0)return;this._isRefreshing=!0}this._track(a,!0)}},b.prototype._track=function(a,b){var c=this,d=this._touchState;if(2===d||3===d){var e=this._calculateTranslation(a,b);this.utils.requestAnimationFrame(function(){c._viewport.style[c._transform]=e})}},b.prototype._calculateTranslation=function(a,b){var c,d,e=this._isVertical,f=b?this._refreshProgressRing:this._loadingProgressRing;return e?(c=a.clientY-this._lastTouch.y,d=f.offsetHeight):(c=a.clientX-this._lastTouch.x,d=f.offsetWidth),b&&0>c||!b&&c>0?c=0:this._hasMoved?Math.abs(c)>=d?this._touchState<3&&(this._touchState=3,this.dom.addClass(f,n+"play")):3===this._touchState&&(this._touchState=2,this.dom.removeClass(f,n+"play")):(this._hasMoved=!0,this.dom.addClass(this._viewport,n+"manipulation-prep"),f.removeAttribute(G)),e?"translate3d(0,"+c+"px,0)":"translate3d("+c+"px,0,0)"},b.prototype._setTransform=function(){var a=this._viewport.style,b=this.utils.isUndefined,c=this._compat.vendorPrefix;b(this._preTransform=a[c.lowerCase+"Transform"])?b(this._preTransform=a[c.upperCase+"Transform"])?(this._preTransform=a.transform,this._transform="transform"):this._transform=c.upperCase+"Transform":this._transform=c.lowerCase+"Transform"},b.prototype._parseInnerTemplate=function(a,b){for(var c,d,e,f=this._templates,g=Array.prototype.slice,h=this.dom.appendChildren,i=this._document,j=!this.utils.isNull(b),k=g.call(this.innerTemplate.childNodes);k.length>0;)c=k.pop(),c.nodeType===Node.ELEMENT_NODE&&(d=this._normalizeTemplateName(c.nodeName),j&&d===b?(e=i.createElement("div"),e.className=n+"header"):e=i.createDocumentFragment(),h(c.childNodes,e),f[d]=e)},b.prototype._executeEvent=function(a){var b="_"+a[0].type;this.utils.isFunction(this[b])&&this[b](a)},b.prototype._executeChildEvent=function(a,b){var c=this.utils,d="_"+b[0].type;if(c.isFunction(this[d])){var e=this._groups[a];if(c.isNull(e))return;this[d](b,e)}},b.prototype._push=function(a,b){var c=a[0],d=c.addedCount;this._createItems(c.index,d,b,this._animate?d:0)},b.prototype._pop=function(a,b){var c=this,d=b||this._defaultGroup,e=d.addQueue,f=a[0],g=f.object.length;if(0!==f.removed.length){var h=f.object.length;d.itemCount>0&&d.itemCount--,this._Promise.all(e).then(function(){return c._animate?void c._animateItems(g,1,S,d,"leave",!1).then(function(){c._removeItems(h,1,d)}):void c._removeItems(h,1,d)})}},b.prototype._unshift=function(a,b){if(this.utils.isFunction(this._templateSelector))return void this.rerender(b);var c=b||this._defaultGroup,d=a[0],e=d.addedCount;if(this._animate){var f=c.animationQueue,g=f.length;this._animateItems(0,e,R,c,null,g>0&&"clone"===f[g-1].op)}this._createItems(d.object.length-e,e,c,0)},b.prototype._shift=function(a,b){var c=this,d=b||this._defaultGroup,e=d.addQueue,f=a[0];if(0!==f.removed.length){this._animate&&0===e.length&&(e=e.concat([this._animateItems(0,1,S,d,"clone",!0)]));var g=f.object.length;d.itemCount>0&&d.itemCount--,this._Promise.all(e).then(function(){c._removeItems(g,1,d)})}},b.prototype._splice=function(a,b){var c=this,d=this.utils,e=a[0],f=b||this._defaultGroup,g=e.addedCount,h=f.itemCount,i=(f.control,f.addQueue),j=this._animate;if(d.isNull(g)){j&&this._cancelCurrentAnimations();var k=e.object.length,l=h-k;if(k>h){if(d.isFunction(this._templateSelector))return void(d.isNull(e.index)?this.rerender(f):this.render(e.index,g,f));this._createItems(h,-l,f,0)}else h>k&&(f.itemCount>=l?f.itemCount-=l:f.itemCount=0,this._Promise.all(i).then(function(){c._removeItems(h-l,l,f)}))}else{var m=e.removed.length,n=f.animationQueue;if(g>m){var o=g-m,p=void 0;if(d.isFunction(this._templateSelector))return void(d.isNull(e.index)?this.rerender(f):this.render(e.index,g,f));if(j){p=g;var q=n.length,r=e.index;g-r>h&&(p=h-r),this._animateItems(r,p,R,f,null,q>0&&"clone"===n[q-1].op),p=g-p}else p=0;this._createItems(e.object.length-o,o,f,p)}else if(m>g){var s=g>0;j&&!s&&0===i.length&&(i=i.concat([this._animateItems(e.index,m,S,f,"clone",!0)]));var t=m-g;f.itemCount>=t?f.itemCount-=t:f.itemCount=0,this._Promise.all(i).then(function(){if(j&&s){var a=n.length;c._animateItems(e.index,g,R,f,null,a>0&&"clone"===n[a-1].op)}c._removeItems(h-t,t,f)})}}},b.prototype._animateItems=function(a,b,c,d,e,f){switch(e){case"clone":return this._handleClonedContainerAnimation(this._getAnimatedNodes(a,b,d),c,d,f===!0);case"leave":return this._handleLeave(this._getAnimatedNodes(a,b,d),c,d);default:return this._handleSimpleAnimation(this._getAnimatedNodes(a,b,d),c,d,f===!0)}},b.prototype._getAnimatedNodes=function(a,b,c){if(this._isGrouped&&c===this._defaultGroup){var d=3,e=a*d;return Array.prototype.slice.call(c.itemContainer.childNodes,e,b*d+e)}var f=this.utils,g=f.isNode,h=Array.prototype.slice.call(c.itemContainer.childNodes),i=a+b-1,j=c.control.controls;j.length<=i&&(i=j.length-1);var k=j[a].startNode,l=j[i].endNode;if(!g(k)||!g(l))return[];var m=h.indexOf(k),n=h.indexOf(l);
return-1===m||-1===n?[]:h.slice(m,n+1)},b.prototype._handleSimpleAnimation=function(a,b,c,d){if(0===a.length)return this._Promise.resolve();var e,f=(c.itemContainer,c.animationQueue),g=this._animator.create(a,b),h=g.current.then(function(){var a=f.indexOf(e);-1!==a&&f.splice(a,1)}),i=function(){return g.previous.then(function(){h.start()}),h};if(e={animation:h,op:null},d&&f.length>0){var j=this._cancelCurrentAnimations().then(i);return f.push(e),j}return f.push(e),i()},b.prototype._handleLeave=function(a,b,c){if(0===a.length)return this._Promise.resolve();var d,e=(c.itemContainer,c.animationQueue),f=this._animator.leave(a,b).then(function(){var a=e.indexOf(d);-1!==a&&e.splice(a,1)});return d={animation:f,op:"leave"},e.push(d),f},b.prototype._handleClonedContainerAnimation=function(a,b,c,d){if(0===a.length)return this._Promise.resolve();var e,f,g=c.itemContainer,h=g.cloneNode(!0),i=c.animationQueue,j=this.utils.isNull,k=this._animator.create(a,b),l=k.current.then(function(){var a=i.indexOf(f);a>-1&&i.splice(a,1),j(e)||e.replaceChild(g,h)}),m=function(){return e=g.parentNode,j(e)||l.isCanceled()?l:(e.replaceChild(h,g),k.previous.then(function(){l.start()}),l)};if(f={animation:l,op:"clone"},d&&i.length>0){var n=this._cancelCurrentAnimations().then(m);return i.push(f),n}return i.push(f),m()},b.prototype._cancelCurrentAnimations=function(a){for(var b=(a||this._defaultGroup).animationQueue,c=[],d=b.length,e=0;d>e;++e)c.push(b[e].animation.cancel());return this._Promise.all(c)},b.prototype._normalizeTemplateName=function(a){return this.utils.isString(a)?a.toLowerCase().replace(this._nodeNormalizeRegex,""):void 0},b.prototype._generateProgressRing=function(){var a=this._document,b=a.createElement("div"),c=a.createElement("div");return b.className=D+"-ring "+n+"ring "+n+"ring-0",c.className=n+"animated-ring",b.insertBefore(c,null),b},b.prototype._validateOrientation=function(a){if(this.utils.isUndefined(a))return"vertical";var b;return"vertical"===a?b=a:"horizontal"===a?(b=a,this._isVertical=!1):(this._log.debug('Invalid orientation "'+a+'" for '+this.type+'. Defaulting to "vertical."'),b="vertical"),b},b.prototype._setContainerHeight=function(){if(!this._isVertical&&this._isGrouped){var a=this.element,b=a.offsetHeight;if(!b)return void this._addVisibilityListener(this._setContainerHeight.bind(this),a);b-=this._getScrollBarWidth(),0>b&&(b=0),this._container.style.height=b+"px"}},b.prototype._setGroupContainerWidth=function(a){var b=a.scrollWidth;return b?void(a.parentElement.style.width=b+"px"):void this._addVisibilityListener(this._setGroupContainerWidth.bind(this,a),a)},b.prototype._setGroupContainerPadding=function(a){var b=a.offsetHeight;if(!b)return void this._addVisibilityListener(this._setGroupContainerPadding.bind(this,a),a);var c=a.firstElementChild,d=c.offsetHeight;return d?void(a.style.paddingTop=d+"px"):void this._addVisibilityListener(this._setGroupContainerPadding.bind(this,a),c)},b.prototype._getScrollBarWidth=function(){var a=this._document,b=a.body,c=a.createElement("div"),d=a.createElement("div"),e=c.style,f=d.style;e.width=e.height=f.height="100px",f.width="50px",f.position="absolute",f.top=f.left="0px",f.visibility=f.overflow="hidden",d.insertBefore(c,null),b.insertBefore(d,null);var g=c.offsetHeight;f.overflow="scroll";var h=c.offsetHeight;return g===h&&(h=d.clientHeight),b.removeChild(d),g-h},b.prototype._addVisibilityListener=function(a,b){var c,d=this,e=this._visibilityRemoveListeners,f=function(){a();var b=e.indexOf(c);-1!==b&&e.splice(b,1),0===e.length&&d.element.removeAttribute(H)};c=this.dom.whenVisible(this.utils.requestAnimationFrame.bind(this,f),b),0===e.length&&this.element.setAttribute(H,""),e.push(c)},b._inject={_document:g,_window:f,_compat:d,_animator:h,_Promise:c,_TemplateControlFactory:j},b}(plat.ui.TemplateControl);a.Listview=xa,plat.register.control(D,xa);var ya=function(a){function b(){a.apply(this,arguments),this.templateString='<div class="plat-navbar-left">\n    <div class="plat-navbar-items" plat-control="'+J+'" plat-context="left">\n        <div class="plat-navbar-item" plat-control="'+K+'" plat-options="{ html: content, compile: true }" plat-tap="leftAction(@index)"></div>\n    </div>\n</div>\n<div class="plat-navbar-center">\n    <div class="plat-navbar-items" plat-control="'+J+'" plat-context="center">\n        <div class="plat-navbar-item" plat-control="'+K+'" plat-options="{ html: content, compile: true }" plat-tap="centerAction(@index)"></div>\n    </div>\n</div>\n<div class="plat-navbar-right">\n    <div class="plat-navbar-items" plat-control="'+J+'" plat-context="right">\n        <div class="plat-navbar-item" plat-control="'+K+'" plat-options="{ html: content, compile: true }" plat-tap="rightAction(@index)"></div>\n    </div>\n</div>\n',this.context={left:[{content:"",action:ha}],center:[{content:"",action:ha}],right:[{content:"",action:ha}]},this.hasOwnContext=!0,this._overrides={left:!1,center:!1,right:!1}}return __extends(b,a),b.prototype.setClasses=function(a,b){this.dom.addClass(b||this.element,E+" "+(a||""))},b.prototype.initialize=function(){this.setClasses()},b.prototype.setTemplate=function(){var a=this.utils.isNull,b=this.innerTemplate;if(!a(b))for(var c,d,e=this._document,f=this._overrides,g=Array.prototype.slice,h=this.dom.appendChildren,i=g.call(b.childNodes),j=this.element,k=g.call(j.children);i.length>0;)if(c=i.shift(),c.nodeType===Node.ELEMENT_NODE)switch(c.nodeName.toLowerCase()){case"left":f.left=!0,d=e.createElement("div"),d.className=E+"-left",d.setAttribute(I,"left"),j.replaceChild(h(g.call(c.childNodes),d),k[0]);break;case"center":f.center=!0,d=e.createElement("div"),d.className=E+"-center",d.setAttribute(I,"center"),j.replaceChild(h(g.call(c.childNodes),d),k[1]);break;case"right":f.right=!0,d=e.createElement("div"),d.className=E+"-right",d.setAttribute(I,"right"),j.replaceChild(h(g.call(c.childNodes),d),k[2])}},b.prototype.loaded=function(){var a=this.options||{},b=a.value||{},c=this.utils.isString(b.position)&&"bottom"===b.position.toLowerCase()?"-bottom":"-top";this.dom.addClass(this.element,E+c)},b.prototype.setLeft=function(a){this._setComponent("left",a)},b.prototype.setCenter=function(a){this._setComponent("center",a)},b.prototype.setRight=function(a){this._setComponent("right",a)},b.prototype.leftAction=function(a,b){this._executeAction(b,"left",a)},b.prototype.centerAction=function(a,b){this._executeAction(b,"center",a)},b.prototype.rightAction=function(a,b){this._executeAction(b,"right",a)},b.prototype._setComponent=function(a,b){var c=this.context;if(!this.utils.isArray(b)){if(this._overrides[a])return this._parseComponent(b),void(c[a]=b);b=[b]}for(var d=b.length;d-- >0;)this._parseComponent(b[d],c[a][d]);c[a]=b},b.prototype._parseComponent=function(a,b){var c,d,e,f,g=this.utils,h=g.isObject,i=h(b);if(i&&g.isUndefined(a.content)&&(a.content=b.content),g.isFunction(a.action)||(a.action=i?b.action:ha),c=a.customActions,h(c))for(d=Object.keys(c),f=d.length;f-- >0;)e=d[f],this[e]=c[e]},b.prototype._executeAction=function(a,b,c){var d=this.utils,e=this.context[b];return d.isArray(e)&&!d.isNull(c)&&(e=e[c]),d.isFunction(e.action)?void e.action(a):void this._log.debug("An action function is not defined for the component "+e+".")},b._inject={_document:g},b}(plat.ui.TemplateControl);a.Navbar=ya,plat.register.control(E,ya,null,!0);var za=function(a){function b(){a.apply(this,arguments),this.templateString='<div plat-control="'+u+'" class="plat-image-ring"></div>\n',this._isBackground=!1,this._img=this._document.createElement("img")}return __extends(b,a),b.prototype.setClasses=function(a,b){this.dom.addClass(b||this.element,F+" "+(a||""))},b.prototype.initialize=function(){this.setClasses()},b.prototype.loaded=function(){var a,b=this.element,c=this.utils,d=c.isString,e=c.isObject,f=this.attributes,g=this.options;if(d(a=f[O]))f.observe(this._setSrc,O);else{if(!d(a=f[fa]))return;f.observe(this._setSrc,fa)}e(g)&&e(g.value)&&(this._isBackground=g.value.isBackground===!0),this._isBackground&&this.dom.addClass(b,n+"background"),this._loader=b.firstElementChild,this._NodeManagerStatic.hasMarkup(a)||this._setSrc(a)},b.prototype._setSrc=function(a,b){var c=this,d=this._img,e=this.element,f=this.dom,g=n+"load-image",h=F+"-error",i=this._loader;f.addClass(d,g),d.src=a,d.onload=function(){c.utils.requestAnimationFrame(function(){return f.removeClass(e,h),c._isBackground?(e.style.backgroundImage='url("'+a+'")',e.contains(d)&&e.removeChild(d),void(e.contains(i)&&e.removeChild(i))):(f.removeClass(d,g),void(e.contains(i)&&e.removeChild(i)))})},d.onerror=function(){c.utils.requestAnimationFrame(function(){f.addClass(e,h),e.contains(d)&&e.removeChild(d),e.contains(i)&&e.removeChild(i)})},e.insertBefore(i,null),e.insertBefore(d,null)},b._inject={_compat:d,_document:g,_NodeManagerStatic:k},b}(plat.ui.TemplateControl);a.Image=za,plat.register.control(F,za)}(platui||(platui={})),module.exports=platui;