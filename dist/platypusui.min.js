"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function s(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}}(),platui;!function(t){var e="plat-",i="plat-drawer",s="plat-ring",n="plat-carousel",r="plat-listview",o="plat-navbar",a="plat-hide",l="plat-foreach",h="plat-html",p={index:"index",even:"even",odd:"odd",first:"first",last:"last",group:"group"},u="plat-transition",d="plat-enter",c={right:"left",left:"right",up:"down",down:"up"},_=function(t){return t.preventDefault(),!1},f=function(){};"undefined"!=typeof window&&(void 0===window.platui&&(window.platui=t),void 0===window.module&&(window.module={}));var m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.replaceWith="button",e._isSelected=!1,e}return __extends(e,t),e.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,"plat-button "+(t||""))},e.prototype.initialize=function(){this.setClasses()},e.prototype.loaded=function(){var t=this.element,e=((this.options||{}).value||{}).group,i=this.utils.isString;if(!i(e))return e=this.attributes.platBind,void(i(e)&&(this._group=e,this.dom.hasClass(t,"plat-selected")&&this._onTap(),this._addEventListeners()));this._group=e,this.dom.hasClass(t,"plat-selected")&&this._onTap(),this._addEventListeners()},e.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty)},e.prototype._setBoundProperty=function(t,e,i,s){this.utils.isString(t)&&t===this.element.textContent&&this._onTap()},e.prototype._addEventListeners=function(){var t=this;this.addEventListener(this.element,"$tap",this._onTap,!1),this.on("__plat-button-"+this._group,function(){t._isSelected&&(t.dom.removeClass(t.element,"plat-selected"),t._isSelected=!1)})},e.prototype._onTap=function(){if(!this._isSelected){var t=this.element;this.dom.addClass(t,"plat-selected"),this.dispatchEvent("__plat-button-"+this._group,plat.events.EventManager.DIRECT),this._isSelected=!0,this.inputChanged(t.hasAttribute("value")?t.getAttribute("value").trim():t.textContent.trim())}},e._inject={_document:"$Document"},e}(plat.ui.BindControl);t.Button=m,plat.register.control("plat-button",m);var v=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateString='<div class="plat-toggle-container">\n    <div class="plat-knob"></div>\n</div>\n',e.isActive=!1,e._targetType="slide",e}return __extends(i,t),i.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,"plat-toggle "+(t||""))},i.prototype.initialize=function(){this.setClasses()},i.prototype.setTemplate=function(){var t=this.utils.isNull,e=this.innerTemplate;if(!t(e)){var i=this._document.createElement("span");this.dom.appendChildren(e.childNodes,i),this.element.insertBefore(i,null)}},i.prototype.loaded=function(){var t=this.element;this._targetElement=t.firstElementChild,this.addEventListener(t,"$tap",this._onTap),this._convertChecked()},i.prototype.toggle=function(){this._toggle(!0)},i.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty)},i.prototype._setBoundProperty=function(t,e,i,s){t!==e&&(!0===s&&this.utils.isNull(t)?this.inputChanged(this.isActive):!!t!==this.isActive&&this._toggle(s))},i.prototype._convertChecked=function(){var t=this.element;this.utils.isNull(this.attributes.platChecked)?t.hasAttribute("checked")&&this._convertAttribute(!0):(this._convertAttribute(this.attributes.platChecked),this.attributes.observe(this._convertAttribute,"platChecked"))},i.prototype._convertAttribute=function(t,e){var i=this.utils;if(i.isBoolean(t))return this._setBoundProperty(t,e,null,!0);i.isString(t)&&this._setBoundProperty("true"===t,"true"===e,null,!0)},i.prototype._onTap=function(t){this.element.hasAttribute("disabled")||(this._toggle(!0),this._trigger("change"))},i.prototype._trigger=function(t){var e=plat.acquire("$DomEventInstance");e.initialize(this.element,t),e.trigger()},i.prototype._toggle=function(t){var e=this.isActive,i=!e,s=this.element;this._activate(this._targetElement||(this._targetElement=s.firstElementChild)),this.isActive=s.checked=i,i?s.setAttribute("checked","checked"):s.removeAttribute("checked"),!0===t&&this.inputChanged(i,e)},i.prototype._activate=function(t){this.dom.toggleClass(t,e+this._targetType)},i._inject={_document:"$Document"},i}(plat.ui.BindControl);t.Toggle=v,plat.register.control("plat-toggle",v);var g=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateString='<div class="plat-checkbox-container">\n    <span class="plat-mark"></span>\n</div>\n',e._targetTypeSet=!1,e}return __extends(i,t),i.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,"plat-checkbox "+(t||""))},i.prototype.loaded=function(){t.prototype.loaded.call(this);var e=(this.options||{}).value||{},i=this._targetType;switch((this._targetType=e.mark||"check").toLowerCase()){case"check":case"x":break;default:this._log.debug("Invalid mark option specified for "+this.type+". Defaulting to checkmark."),this._targetType="check"}if(this._targetTypeSet){var s=this._targetElement;this.dom.removeClass(s,i),this._activate(s)}this._targetTypeSet=!0},i.prototype._activate=function(t){this._targetTypeSet?this.dom.toggleClass(t,e+this._targetType):this._targetTypeSet=!0},i}(v);t.Checkbox=g,plat.register.control("plat-checkbox",g);var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateString='<div class="plat-radio-container">\n    <div class="plat-mark"></div>\n</div>\n',e.groupName="",e._targetType="bullet",e._targetTypeSet=!0,e}return __extends(e,t),e.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,"plat-radio "+(t||""))},e.prototype.loaded=function(){var t=this.element;this._targetElement=t.firstElementChild,this.addEventListener(t,"$tap",this._onTap),t.hasAttribute("name")?this.groupName=t.getAttribute("name"):this.utils.isNull(this.attributes.platBind)||(this.groupName=this.attributes.platBind),this._convertChecked()},e.prototype.inputChanged=function(e,i){this.isActive&&t.prototype.inputChanged.call(this,this._getValue())},e.prototype._setBoundProperty=function(t,e,i,s){var n=this.utils;if(t!==e)if(!0===s&&n.isNull(t))this.inputChanged();else{var r=this._getValue(),o=t===r,a=this.isActive;if(o){if(a)return}else if(n.isNull(t)){if(!a)return}else{var l=n.isFunction(t.toString)?t.toString():Object.prototype.toString.call(t);if(a){if(l===r)return}else if(l!==r)return}this._toggle(s)}},e.prototype._onTap=function(e){this.isActive||t.prototype._onTap.call(this,e)},e.prototype._toggle=function(e){var i=this;if(t.prototype._toggle.call(this,e),this.utils.isFunction(this._removeListener)&&(this._removeListener(),this._removeListener=null),this.isActive){var s=this.groupName;this.dispatchEvent("__plat-radio-"+s,plat.events.EventManager.DIRECT);var n=this._removeListener=this.on("__plat-radio-"+s,function(){i._toggle(),n()})}},e.prototype._convertAttribute=function(t,e){var i=this.utils;i.isBoolean(t)?t&&this._setBoundProperty(this._getValue(),null,null,!0):i.isString(t)&&"true"===t&&this._setBoundProperty(this._getValue(),null,null,!0)},e.prototype._getValue=function(){var t=this.element;return t.hasAttribute("value")?t.getAttribute("value").trim():t.textContent.trim()},e}(g);t.Radio=y,plat.register.control("plat-radio",y);var b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateString='<div class="plat-animated-ring"></div>',e}return __extends(e,t),e.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,s+" "+(t||""))},e.prototype.initialize=function(){this.setClasses()},e.prototype.loaded=function(){var t=this.options,e=this.utils,i=e.isObject,n=0;i(t)&&i(t.value)&&(n=t.value.style,e.isNumber(n)||(n=0)),this.dom.addClass(this.element,s+"-"+n),0!==n&&this._addAnimatedElements(n)},e.prototype._addAnimatedElements=function(t){for(var e,i=plat.acquire("$Document"),s=i.createDocumentFragment(),n=2===t?12:4,r=0;r<n;++r)(e=i.createElement("div")).className="plat-animated-child plat-animated-child-"+r,s.insertBefore(e,null);this.element.firstElementChild.insertBefore(s,null)},e}(plat.ui.TemplateControl);t.ProgressRing=b,plat.register.control(s,b);var C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateString='<div class="plat-progress-container">\n    <div class="plat-animated-bar"></div>\n</div>\n',e._removeVisibilityListener=f,e}return __extends(e,t),e.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,"plat-progress "+(t||""))},e.prototype.initialize=function(){this.setClasses()},e.prototype.loaded=function(){var t=this;this._barElement=this.element.firstElementChild.firstElementChild,this.addEventListener(this._window,"resize",function(){t.setProgress(t.context)}),this.setProgress(this.context)},e.prototype.dispose=function(){this._removeVisibilityListener()},e.prototype.contextChanged=function(){this.setProgress(this.context)},e.prototype.setProgress=function(t){var e=this;return new this._Promise(function(i,s){if(!e.utils.isNumber(t)||t>1||t<0){var n='The value of a "'+e.type+'" control must be a number between 0 and 1.';return e._log.debug(n),void s(n)}var r=e._barElement,o=r.parentElement.clientWidth;if(!o)return e._removeVisibilityListener(),void(e._removeVisibilityListener=e.dom.whenVisible(function(){e.setProgress(t).then(i)},e.element));e._animator.animate(r,u,{properties:{width:Math.ceil(o*t)+"px"}}).then(function(){i()})})},e._inject={_window:"$Window",_Promise:"$Promise",_animator:"$Animator"},e}(plat.ui.TemplateControl);t.ProgressBar=C,plat.register.control("plat-progress",C);var x=function(t){function s(){var e=t.call(this)||this;return e._controllers=[],e._isInitialized=!1,e._preInitializedValue=!1,e.__state=!1,e.__nextState=!1,e.ready=e._Promise.resolve(),e}return __extends(s,t),s.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,i+" "+(t||""))},s.prototype.initialize=function(){this.setClasses()},s.prototype.setTemplate=function(){this.innerTemplate=this.dom.appendChildren(this.element.childNodes)},s.prototype.loaded=function(){var t=this,i=this.element,s=this.utils,n=(this.options||{}).value||{},r=this._currentPosition=n.position||"left",o=n.id||"",l=n.templateUrl,h=!0===n.elastic;i.setAttribute(a,""),this.dom.addClass(i,e+r),s.isString(l)?plat.ui.TemplateControl.determineTemplate(this,l).then(function(e){t.innerTemplate=e,t._initializeEvents(o,r,h)}):this._initializeEvents(o,r,h)},s.prototype.open=function(){var t=this._controllers[0];return this.utils.isNull(t)?(this._log.debug("No controller, such as a plat-drawer-controller, found for the "+this.type+" attempting to open."),this._Promise.resolve()):t.open()},s.prototype.close=function(){var t=this._controllers[0];return this.utils.isNull(t)?(this._log.debug("No controller, such as a plat-drawer-controller, found for the "+this.type+" attempting to close."),this._Promise.resolve()):t.close()},s.prototype.toggle=function(){var t=this._controllers[0];return this.utils.isNull(t)?(this._log.debug("No controller, such as a plat-drawer-controller, found for the "+this.type+" attempting to toggle."),this._Promise.resolve()):t.toggle()},s.prototype.isOpen=function(){var t=this._controllers[0];return this.utils.isNull(t)?(this._log.debug("No controller, such as a plat-drawer-controller, found for the "+this.type+" attempting to check if open."),!1):t.isOpen()},s.prototype.bindTemplate=function(t,e){var i=this,s=this.bindableTemplates;return s.add(t,e),s.bind(t).then(function(t){var e=i.element;i.dom.clearNode(e),e.appendChild(t)}).catch(function(t){i._log.debug("Error binding template for "+i.type+": "+t)})},s.prototype.controllerCount=function(){return this._controllers.length},s.prototype.spliceController=function(t){var e=this._controllers,i=e.indexOf(t);-1!==i&&(this.__state=this.__nextState=e[i].isOpen(),e.splice(i,1))},s.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty)},s.prototype._setBoundProperty=function(t,e,i,s){var n=this.utils,r=this._controllers[0];if(!0===s&&n.isNull(t))this.inputChanged(!n.isNull(r)&&r.isOpen());else{var o=!!t;if(o!==t&&this.inputChanged(o),this._isInitialized)if(n.isNull(r))this.__nextState=o;else if(o){if(r.isOpen())return;r.open()}else r.isOpen()&&r.close();else this._preInitializedValue=o}},s.prototype._changeDirection=function(t){if(!this.utils.isNull(t)&&t!==this._currentPosition){var i=this.dom,s=this.element;i.removeClass(s,e+this._currentPosition),i.addClass(s,e+t),this._currentPosition=t}},s.prototype._initializeEvents=function(t,e,i){var s=this,n=this.utils,r=this.innerTemplate;this.on("__platDrawerControllerFetch_"+t,function(o,a){var l=a.control;n.isNull(l)||(n.isString(a.position)&&(e=a.position,s._changeDirection(e)),s._controllers.unshift(l),a.received||s.ready.then(function(){s.dispatchEvent("__platDrawerFound_"+t,plat.events.EventManager.DIRECT,{control:s,received:!0,position:e,template:n.isNode(r)?r.cloneNode(!0):null,elastic:i,state:s.__state,nextState:s.__nextState})}),s._isInitialized=!0,a.useContext?s._checkPreInit():s.bindTemplate("drawer",r.cloneNode(!0)).then(function(){s._checkPreInit()}))}),this.dispatchEvent("__platDrawerFound_"+t,plat.events.EventManager.DIRECT,{control:this,received:!1,position:e,template:n.isNode(r)?r.cloneNode(!0):null,elastic:i,state:this.__state,nextState:this.__nextState})},s.prototype._checkPreInit=function(){var t=this;if(this._preInitializedValue){var e=this.utils;e.postpone(function(){var i=t._controllers[0];e.isNull(i)||i.open()})}},s._inject={_Promise:"$Promise"},s}(plat.ui.BindControl);t.Drawer=x,plat.register.control(i,x);var w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._hasSwiped=!1,e._hasTapped=!1,e._isOpen=!1,e._touchState=0,e._isVertical=!1,e._removeClickEaterListener=f,e._toggleDelay=f,e._isInitialized=!1,e}return __extends(e,t),e.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,"plat-drawer-controller "+(t||""))},e.prototype.initialize=function(){this.dom.addClass(this.element,"plat-drawer-controller")},e.prototype.loaded=function(){var t=(this.options||{}).value||{},e=t.position,i=t.id||"";this._type=t.type||"tap track",this._isElastic=t.elastic,this._useContext=!0===t.useContext,this._templateUrl=t.templateUrl,this._initializeEvents(i,e)},e.prototype.dispose=function(){var e=this;t.prototype.dispose.call(this);var i=this._drawer;this.utils.isNull(i)||(i.controllerCount()>1?i.spliceController(this):this._isOpen?i.ready=this.close().then(function(){i.spliceController(e),i.controllerCount()>0||e._cleanRootElement()}):i.ready.then(function(){i.spliceController(e),i.controllerCount()>0||e._cleanRootElement()}))},e.prototype.open=function(){var t=this,e=!this._isOpen,i=this.utils;this._toggleDelay();var s=new this._Promise(function(e){t._toggleDelay=i.requestAnimationFrame(function(){t._open().then(e)})});if(e){var n=this._drawer;this.inputChanged(!0),i.isNull(n)||n.inputChanged(!0)}return s},e.prototype.close=function(){var t=this,e=this._isOpen,i=this.utils;this._toggleDelay();var s=new this._Promise(function(e){t._toggleDelay=i.requestAnimationFrame(function(){t._close().then(e)})});if(e){var n=this._drawer;this.inputChanged(!1),i.isNull(n)||(n.ready=s,n.inputChanged(!1))}return s},e.prototype.toggle=function(){return this._isOpen?this.close():this.open()},e.prototype.isOpen=function(){return this._isOpen},e.prototype.bindTemplate=function(t,e){var i=this,s=this.bindableTemplates;return s.add(t,e),s.bind(t).then(function(t){var e=i._drawerElement;i.dom.clearNode(e),e.appendChild(t)}).catch(function(t){i._log.debug("Error binding template for "+i.type+": "+t)})},e.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty)},e.prototype._setBoundProperty=function(t,e,i,s){var n=this,r=this.utils;if(!0===s&&r.isNull(t))this.inputChanged(this._isOpen);else{var o=!!t;if(o!==t&&this.inputChanged(o),this._isInitialized){if(o){if(this._isOpen)return;this._toggleDelay(),this._toggleDelay=r.requestAnimationFrame(function(){n._open()})}else if(this._isOpen){this._toggleDelay();var a=new this._Promise(function(t){n._toggleDelay=r.requestAnimationFrame(function(){t(n._close())})}),l=this._drawer;r.isNull(l)||(l.ready=a)}}else this._preInitializedValue=o}},e.prototype._open=function(t){var e=this,i=this._rootElement,s=this.utils.isNode,n=this._isOpen,r=this._getOffset();if(n&&!t||!(r&&s(i)&&s(this._drawerElement)))return this._Promise.resolve();var o;switch(this._position){case"left":o="translate3d("+r+"px,0,0)";break;case"right":o="translate3d("+-r+"px,0,0)";break;case"top":o="translate3d(0,"+r+"px,0)";break;case"bottom":o="translate3d(0,"+-r+"px,0)";break;default:return this._Promise.resolve()}this._isOpen=!0,this.dom.addClass(i,this._directionalTransitionPrep),n||this._addClickEater();var a={};return a[this._transform]=o,this._animationThenable=this._animator.animate(i,u,{properties:a}).then(function(){e._animationThenable=null,e._drawerElement.removeEventListener("selectstart",_,!1)})},e.prototype._close=function(t){var e=this,i=this._rootElement,s=this.utils.isNode;if(!this._isOpen&&!t||!s(i)||!s(this._drawerElement))return this._Promise.resolve();this._isOpen=!1;var n={};return n[this._transform]=this._preTransform,this._animationThenable=this._animator.animate(i,u,{properties:n}).then(function(){e._animationThenable=null,e._drawerElement.removeEventListener("selectstart",_,!1),e._isOpen||e._touchState<2&&e._removeClickEater()})},e.prototype._reset=function(){if(this._isOpen)return this._open(!0);var t=this._close(!0),e=this._drawer;return this.utils.isNull(e)||(e.ready=t),t},e.prototype._addClickEater=function(){var t=this,e=this._clickEater,i=e.style,s=this._rootElement;if(!s.contains(e)){i.top=s.scrollTop+"px",i.left=s.scrollLeft+"px",s.insertBefore(e,null),this.dom.addClass(this._rootElement,this._directionalTransitionPrep);var n,r=f,o=!0;n=this.addEventListener(s,"scroll",function(){o&&(o=!1,r=t.utils.requestAnimationFrame(function(){var t=e.style;o=!0,t.top=s.scrollTop+"px",t.left=s.scrollLeft+"px"}))}),this._removeClickEaterListener=function(){r(),n()}}},e.prototype._removeClickEater=function(){var t=this._rootElement,e=this._clickEater;this._removeClickEaterListener(),t.contains(e)&&t.removeChild(e),this.dom.removeClass(t,this._directionalTransitionPrep)},e.prototype._addSwipeToggle=function(){var t=this,e=this.element,i=this.addEventListener(e,"$swipe"+c[this._position],function(){t._hasSwiped=!0,t.open()},!1),s=this.addEventListener(e,"$swipe"+this._position,function(){t._hasSwiped=!0,t.close()},!1);this._removeSwipeToggle=function(){i(),s()}},e.prototype._addSwipeClose=function(){var t=this;this._openSwipeRemover=this.addEventListener(this._clickEater,"$swipe"+this._position,function(){t._hasSwiped=!0,t.close()},!1)},e.prototype._addTapToggle=function(){var t=this;this._removeTap=this.addEventListener(this.element,"$tap",function(){t._hasTapped=!0,t.toggle()},!1)},e.prototype._addTapClose=function(){var t=this;this._openTapRemover=this.addEventListener(this._clickEater,"$tap",function(){t._hasTapped=!0,t.close()},!1)},e.prototype._addEventListeners=function(){var t=this.element,e=this.utils.isNull,i=this._type.split(" "),s=this._position;if((this._isTap=-1!==i.indexOf("tap"))&&(this._addTapToggle(),this._addTapClose()),(this._isSwipe=-1!==i.indexOf("swipe"))&&(this._addSwipeToggle(),this._addSwipeClose()),this._isTrack=-1!==i.indexOf("track")){var n=this._track,r=void 0,o=this._clickEater;switch(s){case"left":case"right":r=s;break;case"top":r="up";break;case"bottom":r="down";break;default:return}var a="$track"+c[r],l="$track"+r,h=this.addEventListener(t,a,n,!1),p=this.addEventListener(t,l,n,!1),u=this.addEventListener(o,a,n,!1),d=this.addEventListener(o,l,n,!1);if(this._removeTrack=function(){h(),p()},this._openTrackRemover=function(){u(),d()},e(this._lastTouch)){var _=this._touchStart,f=this._touchEnd;this._lastTouch={x:0,y:0},this.addEventListener(t,"$touchstart",_,!1),this.addEventListener(t,"$touchend",f,!1),this.addEventListener(t,"$trackend",f,!1),this.addEventListener(o,"$touchstart",_,!1),this.addEventListener(o,"$trackend",f,!1),this.addEventListener(o,"$touchend",f,!1)}}this.addEventListener(this._window,"resize",this._handleResize,!1)},e.prototype._handleResize=function(){if(this._isOpen){var t=this.utils.isNull,e=this._rootElement,i=this._drawer;this._isOpen=!1,this.inputChanged(!1),t(e)||(e.style[this._transform]=this._preTransform),t(i)||(i.inputChanged(!1),this._drawerElement.removeEventListener("selectstart",_,!1)),this._touchState<2&&this._removeClickEater()}},e.prototype._removeEventListeners=function(){var t=this.utils.isFunction;this._isTap&&(t(this._removeTap)&&(this._removeTap(),this._removeTap=null),t(this._openTapRemover)&&(this._openTapRemover(),this._openTapRemover=null)),this._isTrack&&(t(this._removeTrack)&&(this._removeTrack(),this._removeTrack=null),t(this._openTrackRemover)&&(this._openTrackRemover(),this._openTrackRemover=null)),this._isSwipe&&(t(this._removeSwipeToggle)&&(this._removeSwipeToggle(),this._removeSwipeToggle=null),t(this._openSwipeRemover)&&(this._openSwipeRemover(),this._openSwipeRemover=null))},e.prototype._touchStart=function(t){1!==this._touchState&&(this._touchState=1,this._lastTouch={x:t.clientX,y:t.clientY})},e.prototype._touchEnd=function(t){var e=0===this._touchState,i=this._hasSwiped,s=this._hasTapped;if(this._hasSwiped=this._hasTapped=!1,this._touchState=0,!(s||e||i)){var n=this._isVertical?t.clientY-this._lastTouch.y:t.clientX-this._lastTouch.x;if(this._isRightDirection(n)){var r=this._getOffset();if(!r)return;if(Math.abs(n)>Math.ceil(r/2))return void this.toggle();this._reset()}else this._isElastic?Math.abs(n)>0&&this._reset():this._isOpen||this._removeClickEater()}},e.prototype._track=function(t){var e=this,i=this._touchState;0!==i&&(1===i&&(this.utils.isNull(this._animationThenable)?(this._addClickEater(),this.utils.isNode(this._drawerElement)&&this._drawerElement.addEventListener("selectstart",_,!1)):this._animationThenable.cancel().then(function(){e._addClickEater(),e.utils.isNode(e._drawerElement)&&e._drawerElement.addEventListener("selectstart",_,!1)}),this._touchState=2),this.utils.requestAnimationFrame(function(){e._rootElement.style[e._transform]=e._calculateTranslation(t)}))},e.prototype._isRightDirection=function(t){switch(this._position){case"left":case"top":return this._isOpen?t<0:t>0;case"right":case"bottom":return this._isOpen?t>0:t<0;default:return!1}},e.prototype._calculateTranslation=function(t){var e,i=this._getOffset();if(!i)return this._preTransform;switch(this._position){case"left":return 0===(e=this._checkElasticity(i,t.clientX-this._lastTouch.x))?this._preTransform:"translate3d("+e+"px,0,0)";case"right":return 0===(e=this._checkElasticity(i,this._lastTouch.x-t.clientX))?this._preTransform:"translate3d("+-e+"px,0,0)";case"top":return 0===(e=this._checkElasticity(i,t.clientY-this._lastTouch.y))?this._preTransform:"translate3d(0,"+e+"px,0)";case"bottom":return 0===(e=this._checkElasticity(i,this._lastTouch.y-t.clientY))?this._preTransform:"translate3d(0,"+-e+"px,0)";default:return this._preTransform}},e.prototype._checkElasticity=function(t,e){var i=this._isOpen?t+e:e;return this._isElastic?i:(i<0?i=0:i>t&&(i=t),i)},e.prototype._initializeEvents=function(t,e){var i=this,s=this._useContext,n=this.on("__platDrawerFound_"+t,function(r,o){n();var l=i.utils,h=l.isString,p=l.isUndefined,u=(i._drawer=o.control)||{},d=i._drawerElement=u.element;if(!h(e)){if(!h(o.position))return void i._log.debug('"position" is incorrectly defined for a control such as "plat-drawer" or "'+i.type+'." Please ensure it is a string.');e=o.position}if(d.removeAttribute(a),i._controllerIsValid(e.toLowerCase())){i._setTransform(),i._addEventListeners(),p(i._isElastic)&&(i._isElastic=!0===o.elastic),o.received||i.dispatchEvent("__platDrawerControllerFetch_"+t,plat.events.EventManager.DIRECT,{control:i,received:!0,position:e,useContext:s}),o.state?(i._isOpen=!0,i.inputChanged(!0),!o.nextState&&l.isNull(i._preInitializedValue)&&(i._preInitializedValue=!1)):o.nextState&&l.isNull(i._preInitializedValue)&&(i._preInitializedValue=!0);var c=function(){i._isInitialized=!0,i._checkPreInit()};s?i._determineTemplate(o.template).then(c):c()}});this.dispatchEvent("__platDrawerControllerFetch_"+t,plat.events.EventManager.DIRECT,{control:this,received:!1,position:e,useContext:s})},e.prototype._checkPreInit=function(){var t=this,e=this._preInitializedValue,i=this.utils,s=i.isNull;if(!s(e)){var n=this._isOpen;if(!(n&&e||!n&&!e))if(this._toggleDelay(),e)this._toggleDelay=i.requestAnimationFrame(this._open.bind(this));else{var r=new this._Promise(function(e){t._toggleDelay=i.requestAnimationFrame(function(){e(t._close())})}),o=this._drawer;s(o)||(o.ready=r)}}},e.prototype._determineTemplate=function(t){var e=this,i=this.utils;return i.isString(this._templateUrl)?plat.ui.TemplateControl.determineTemplate(this,this._templateUrl).then(function(t){return e.bindTemplate("drawer",t)}):i.isNode(t)?this.bindTemplate("drawer",t):this._Promise.resolve()},e.prototype._setTransform=function(){var t=this._rootElement.style,e=this.utils.isUndefined,i=this._compat.vendorPrefix;e(this._preTransform=t[i.lowerCase+"Transform"])?e(this._preTransform=t[i.upperCase+"Transform"])?this._transform="transform":this._transform=i.upperCase+"Transform":this._transform=i.lowerCase+"Transform"},e.prototype._controllerIsValid=function(t){var e=this.utils.isNull;if(e(this._drawerElement))return this._log.debug('Could not find a corresponding control such as "plat-drawer" for this "'+this.type+'."'),!1;switch(t){case"top":case"bottom":this._isVertical=!0;case"left":case"right":this._position=t;break;default:return this._log.debug('Incorrect position: "'+t+'" defined for the a control such as a "'+i+'", or "'+this.type+'."'),!1}var s=this._rootElement=this._getRootElement();if(e(s))return this._log.debug('Cannot have a "'+this.type+'" in a hierarchy above the corresponding control such as "'+i+'."'),!1;var n=this.dom;return n.addClass(s,i+"-root"),n.addClass(this.element,this._isVertical?"plat-vertical":"plat-horizontal"),this._directionalTransitionPrep=i+"-transition-"+t,this._clickEater=this._document.createElement("div"),this._clickEater.className="plat-clickeater",this._styleRootElement(),!0},e.prototype._getRootElement=function(){var t=this._drawer,e=this.utils;if(!e.isNull(t.storedProperties))return t.storedProperties.rootElement;for(var i,s=e.isNode,n=this.root,r=e.isObject(n)&&s(n.element)?n.element:this.element,o=this._drawerElement;s(i=r.parentElement)&&!i.contains(o);)r=i;return r},e.prototype._styleRootElement=function(){var t=this._window,e=this.utils,i=this._drawer,s=this._rootElement,n=s.parentElement,r=t.getComputedStyle(s),o=s.style,a=r.position,l=Number(r.zIndex),h={rootElement:s};if("static"===a&&(h.position=o.position,o.position="relative"),(!e.isNumber(l)||l<1)&&(h.zIndex=o.zIndex,o.zIndex="1"),e.isNode(n)){var p=t.getComputedStyle(n);if("hidden"!==p.overflow){var u=void 0,d=void 0;if(this._isVertical?(d="overflowY",u=p.overflowY):(d="overflowX",u=p.overflowX),"hidden"!==u){var c=n.style;h.parentOverflow={key:d,value:c[d]},c[d]="hidden"}}}i.storedProperties=h},e.prototype._cleanRootElement=function(){var t=this.utils,e=t.isObject,s=t.isNode,n=this._rootElement,r=this._drawer;if(s(n)&&(this.dom.removeClass(n,i+"-root "+this._directionalTransitionPrep),!t.isNull(r))){var o=r.storedProperties;if(e(o)){var l=n.style,h=n.parentElement,p=o.parentOverflow;l.position=o.position,l.zIndex=o.zIndex,e(p)&&s(h)&&(h.style[p.key]=p.value),delete r.storedProperties,this._drawerElement.setAttribute(a,"")}}},e.prototype._getOffset=function(){return this._isVertical?this._drawerElement.offsetHeight:this._drawerElement.offsetWidth},e._inject={_document:"$Document",_window:"$Window",_compat:"$Compat",_animator:"$Animator",_Promise:"$Promise"},e}(plat.ui.BindControl);t.DrawerController=w,plat.register.control("plat-drawer-controller",w);var T=function(t){function i(){var e=t.call(this)||this;e._isVisible=!1,e._scrollRemover=f,e._presenceRemover=f,e._scrollTop=0,e._transitionHash={up:!0,down:!0,left:!0,right:!0,fade:!0},e.__templateString='<div class="plat-modal-container"></div>\n',e.templateString=e.__templateString;var i=e._Promise;return e._showingPromise=i.resolve(),e._hidingPromise=i.resolve(),e.modalLoaded=new i(function(t,i){e.__resolveFn=t,e.__rejectFn=i}).catch(f),e}return __extends(i,t),i.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,"plat-modal plat-hide "+(t||""))},i.prototype.initialize=function(){var t=this.options||(this.options={}),e=t.value||(t.value={});this.templateUrl=e.templateUrl||this.templateUrl,this.setClasses()},i.prototype.setTemplate=function(){if(this.templateString!==this.__templateString||this.utils.isString(this.templateUrl)){var t=this.dom,e=t.serializeHtml(this.__templateString),i=this.element;this._container=e.firstChild;this.innerTemplate=t.appendChildren(i.childNodes),i.appendChild(e)}},i.prototype.loaded=function(){var t=this.options.value.transition,i=this.element;if(this._container=this._container||i.firstElementChild,this._presenceRemover=this.dom.whenPresent(this._injectElement.bind(this),i),this.utils.isString(t)&&"none"!==t){this._transitionHash[t]||this._log.debug('Custom transition: "'+t+'" defined for "'+this.type+'." Please ensure the transition is defined to avoid errors.');var s=this._compat.animationEvents;if(this.utils.isNull(s))return this._log.debug("This browser does not support CSS3 animations."),void this.dom.addClass(this._container,"plat-no-transition");this._transitionEnd=s.$transitionEnd,this.dom.addClass(this._container,e+t+" "+e+"modal-transition")}else this.dom.addClass(this._container,"plat-no-transition")},i.prototype.dispose=function(){t.prototype.dispose.call(this),this._scrollRemover(),this._presenceRemover(),this.utils.isFunction(this.__rejectFn)&&(this.__rejectFn(),this.__rejectFn=this.__resolveFn=null),this._hidingPromise=this._showingPromise=null},i.prototype.show=function(){var t=!this._isVisible,e=this._show();return t&&this.inputChanged(!0),e},i.prototype.hide=function(){var t=this.isVisible,e=this._hide();return t&&this.inputChanged(!1),e},i.prototype.toggle=function(){return this._isVisible?this.hide():this.show()},i.prototype.isVisible=function(){return this._isVisible},i.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty)},i.prototype._setBoundProperty=function(t,e,i,s){var n=this.utils;if(!0===s&&n.isNull(t))this.inputChanged(this._isVisible);else if(n.isBoolean(t)){if(t){if(this._isVisible)return;return void this._show()}this._isVisible&&this._hide()}else this._log.debug("Attempting to show or hide a "+this.type+" with a bound value that is something other than a boolean.")},i.prototype._show=function(){var t=this,e=this.dom,i=this.utils;return i.isNull(this.innerTemplate)?this._isVisible?this._showingPromise:(this._isVisible=!0,this._showingPromise=new this._Promise(function(s){i.requestAnimationFrame(function(){t._alignModal(),e.removeClass(t.element,a),i.defer(function(){i.requestAnimationFrame(function(){e.addClass(t._container,"plat-activate"),s()})},20)})})):this._bindInnerTemplate()},i.prototype._alignModal=function(t){var e=this,i=this.utils,s=i.isNull,n=this._document,r=n.documentElement,o=(s(r)||!r.scrollTop?n.body:r).scrollTop;this._scrollTop!==o&&(s(t)?(this.element.style.top=o+"px",this._scrollRemover=this.addEventListener(this._window,"scroll",this._alignModal,!1)):i.requestAnimationFrame(function(){e.element.style.top=o+"px"}),this._scrollTop=o)},i.prototype._hide=function(){var t,e=this,i=this.dom,s=this.utils;return this._isVisible?(this._scrollRemover(),this._scrollRemover=f,this._isVisible=!1,s.isString(this._transitionEnd)?(t=this._addHideOnTransitionEnd(),s.requestAnimationFrame(function(){i.removeClass(e._container,"plat-activate")})):t=new this._Promise(function(t){s.requestAnimationFrame(function(){i.addClass(e.element,a),i.removeClass(e._container,"plat-activate"),t()})}),this._hidingPromise=t):this._hidingPromise},i.prototype._bindInnerTemplate=function(){var t=this,e=this.innerTemplate;return this.innerTemplate=null,this.bindableTemplates.once(e).then(function(e){return t._container.insertBefore(e,null),t.utils.isFunction(t.__resolveFn)&&(t.__resolveFn(),t.__resolveFn=t.__rejectFn=null),t._show()})},i.prototype._injectElement=function(){var t=this.element,e=t.parentElement,i=this._document.body;this.utils.isNode(e)&&e!==i&&i.insertBefore(t,null)},i.prototype._addHideOnTransitionEnd=function(){var t=this;return new this._Promise(function(e){var i=t.element,s=t.addEventListener(i,t._transitionEnd,function(){s(),t.dom.addClass(i,a),e()},!1)})},i._inject={_window:"$Window",_document:"$Document",_compat:"$Compat",_Promise:"$Promise"},i}(plat.ui.BindControl);t.Modal=T,plat.register.control("plat-modal",T);var E=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateString='<div class="plat-slider-container">\n    <div class="plat-slider-track">\n        <div class="plat-knob"></div>\n    </div>\n</div>\n',e._isVertical=!1,e._knobOffset=0,e._touchState=0,e._removeVisibilityListener=f,e}return __extends(i,t),i.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,"plat-slider "+(t||""))},i.prototype.initialize=function(){this.setClasses()},i.prototype.loaded=function(){var t=this.element,i=this._slider=t.firstElementChild.firstElementChild,s=this.utils.isNumber,n=(this.options||{}).value||{},r=Number(n.value),o=n.min,a=n.max,l=n.step,h=this._reversed=!0===n.reverse,p=this.min=s(o)?Math.floor(o):0,u=this.max=s(a)?Math.ceil(a):100,d=s(r)?Math.round(r):p,c=e+this._validateOrientation(n.orientation);this._knob=i.firstElementChild,h&&(c+="-reversed"),this.dom.addClass(t,c),this.value=p,this._step=s(l)&&l>0?Math.round(l):1,p>=u&&(this._log.debug('"'+this.type+"'s\" min is greater than or equal to its max. Setting max to min + 1."),this.max=p+1),this._setLength(),this._initializeEvents(),this.setValue(d)},i.prototype.dispose=function(){t.prototype.dispose.call(this),this._removeVisibilityListener(),this._sliderVisible=null},i.prototype.setValue=function(t){this._setValue(t,!0)},i.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty)},i.prototype._setBoundProperty=function(t,e,i,s){this._setValue(t,!1)},i.prototype._setValue=function(t,e){var i=this.utils;if(1!==this._touchState){if(i.isNull(t)&&(t=this.min,e=!0),!i.isNumber(t)){var s=Number(t);if(!i.isNumber(s))return void this._log.warn(this.type+" has its value bound to a property that cannot be interpreted as a Number.");t=s,e=!0}this._setValueProperty(t,!0,e)}else this._log.debug("Cannot set the value of "+this.type+" while the user is manipulating it.")},i.prototype._initializeEvents=function(){var t,e,i=this,s=this.element,n=this._track,r=this._touchEnd;this._isVertical?(t="$trackdown",e="$trackup"):(t="$trackright",e="$trackleft"),this.addEventListener(s,"$touchstart",this._touchStart,!1),this.addEventListener(s,t,n,!1),this.addEventListener(s,e,n,!1),this.addEventListener(s,"$touchend",r,!1),this.addEventListener(s,"$trackend",r,!1),this.addEventListener(this._window,"resize",function(){i.utils.isNull(i._sliderVisible)&&(i._setLength(),i._setKnob())},!1)},i.prototype._touchStart=function(t){var e=this;if(1!==this._touchState){this._touchState=1,this._lastTouch={x:t.clientX,y:t.clientY,value:this.value};var i=t.target;if(i!==this._knob){var s;s=this._isVertical?i===this.element?this._reversed?t.offsetY-this._sliderOffset:this._maxOffset-(t.offsetY-this._sliderOffset):i===this._slider?this._reversed?t.offsetY:this._knobOffset-t.offsetY:this._reversed?t.offsetY:this._maxOffset-t.offsetY:i===this.element?this._reversed?this._maxOffset-(t.offsetX-this._sliderOffset):t.offsetX-this._sliderOffset:i===this._slider?this._reversed?this._knobOffset-t.offsetX:t.offsetX:this._reversed?this._maxOffset-t.offsetX:t.offsetX,this.utils.requestAnimationFrame(function(){e._knobOffset=e._setSliderProperties(s)})}}},i.prototype._touchEnd=function(t){var e=this;if(1===this._touchState){this._touchState=2;var i=this._calculateOffset(t),s=this._maxOffset;this.utils.requestAnimationFrame(function(){e._touchState=0,e._lastTouch.value!==e.value&&e._trigger("change"),e._knobOffset=i<0?0:i>s?s:i})}else this._touchState=0},i.prototype._track=function(t){var e=this;0!==this._touchState&&this.utils.requestAnimationFrame(function(){e._setSliderProperties(e._calculateOffset(t))})},i.prototype._setSliderProperties=function(t){var e,i=this._maxOffset;if(t<=0){if(e=this.min,t=0,e-this.value>=0)return t}else if(t>=i){if(e=this.max,t=i,e-this.value<=0)return t}else e=this._calculateValue(t);return this._setValueProperty(e,!1,!0),this._slider.style[this._lengthProperty]=t+"px",t},i.prototype._calculateValue=function(t){var e=this._step;return this.min+Math.round(t/this._increment/e)*e},i.prototype._calculateKnobPosition=function(t){return(t-this.min)*this._increment},i.prototype._calculateOffset=function(t){return this._isVertical?this._reversed?this._knobOffset+t.clientY-this._lastTouch.y:this._knobOffset+this._lastTouch.y-t.clientY:this._reversed?this._knobOffset+this._lastTouch.x-t.clientX:this._knobOffset+t.clientX-this._lastTouch.x},i.prototype._setLength=function(){var t=this,e=this._slider.parentElement;this._isVertical?(this._lengthProperty="height",this._maxOffset=e.clientHeight,this._sliderOffset=e.offsetTop):(this._lengthProperty="width",this._maxOffset=e.clientWidth,this._sliderOffset=e.offsetLeft),this._maxOffset?this._setIncrement():this._sliderVisible=new this._Promise(function(i){t._removeVisibilityListener=t.dom.whenVisible(function(){t._sliderVisible=null,t._setLength(),i()},e)})},i.prototype._setIncrement=function(){return this._increment=this._maxOffset/(this.max-this.min)},i.prototype._setValueProperty=function(t,e,i){var s=this.value;if(t!==s){if(t>=this.max)t=this.max;else if(t<=this.min)t=this.min;else if(Math.abs(t-s)<this._step)return;this.value=this.element.value=t,e&&this._setKnob(),i&&this.inputChanged(t,s),this._trigger("input")}},i.prototype._setKnob=function(t){var e=this;this._Promise.resolve(this._sliderVisible).then(function(){var i={},s=e._calculateKnobPosition(t||e.value);s!==e._knobOffset&&(i[e._lengthProperty]=s+"px",e._animator.animate(e._slider,u,{properties:i}),e._knobOffset=s)})},i.prototype._trigger=function(t){var e=plat.acquire("$DomEventInstance");e.initialize(this.element,t),e.trigger()},i.prototype._validateOrientation=function(t){if(this.utils.isUndefined(t))return"horizontal";var e;return"horizontal"===t?e=t:"vertical"===t?(e=t,this._isVertical=!0):(this._log.debug('Invalid orientation "'+t+'" for '+this.type+'. Defaulting to "horizontal."'),e="horizontal"),e},i._inject={_document:"$Document",_window:"$Window",_Promise:"$Promise",_animator:"$Animator"},i}(plat.ui.BindControl);t.Slider=E,plat.register.control("plat-slider",E);var P=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateString='<div class="plat-range-container">\n    <div class="plat-range-track">\n        <div class="plat-lower-knob"></div>\n        <div class="plat-upper-knob"></div>\n    </div>\n</div>\n',e._isVertical=!1,e._touchState=0,e._removeVisibilityListener=f,e._forceFirstTime=!1,e}return __extends(i,t),i.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,"plat-range "+(t||""))},i.prototype.initialize=function(){this.setClasses()},i.prototype.loaded=function(){var t=this.element,i=this._slider=t.firstElementChild.firstElementChild,s=this.utils.isNumber,n=(this.options||{}).value||{},r=Number(n.lower),o=Number(n.upper),a=n.identifiers||{},l=n.min,h=n.max,p=n.step,u=this._reversed=!0===n.reverse,d=this.min=s(l)?Math.floor(l):0,c=this.max=s(h)?Math.ceil(h):100,_=s(r)?Math.round(r):d,f=s(o)?Math.round(o):c,m=e+this._validateOrientation(n.orientation);if(this._lowerKnob=i.firstElementChild,this._upperKnob=i.lastElementChild,this._lowerIdentifier=a.lower||"lower",this._upperIdentifier=a.upper||"upper",u){var v=this._lowerKnob;this._lowerKnob=this._upperKnob,this._upperKnob=v,m+="-reversed"}this.dom.addClass(t,m),this.lower=d,this.upper=c,this._step=s(p)&&p>0?Math.round(p):1,d>=c&&(this._log.debug('"'+this.type+"'s\" min is greater than or equal to its max. Setting max to min + 1."),this.max=d+1),this._setPositionAndLength(),this._setLowerKnobPosition(d),this._initializeEvents(),this.setLower(_),this.setUpper(f)},i.prototype.setLower=function(t){this._setLower(t,!0)},i.prototype.setUpper=function(t){this._setUpper(t,!0)},i.prototype.observeProperties=function(t){t.observeProperty(this._setLowerBoundProperty,this._lowerIdentifier),t.observeProperty(this._setUpperBoundProperty,this._upperIdentifier)},i.prototype._setLowerBoundProperty=function(t,e,i,s){this._setLower(t,!1,s)},i.prototype._setUpperBoundProperty=function(t,e,i,s){this._setUpper(t,!1,s)},i.prototype._setLower=function(t,e,i){var s=this.utils;if(2!==this._touchState){if(s.isNull(t)&&(t=this.min,!0===i?this._forceFirstTime=!0:e=!0),!s.isNumber(t)){var n=Number(t);if(!s.isNumber(n))return void this._log.warn(this.type+" has its lower value bound to a property that cannot be interpreted as a Number.");t=n,!0===i?this._forceFirstTime=!0:e=!0}this._setLowerValue(t,!0,e,!0)}else this._log.debug("Cannot set the value of the "+this.type+"'s lower knob while the user is manipulating it.")},i.prototype._setUpper=function(t,e,i){var s=this.utils;if(3!==this._touchState){if(s.isNull(t)&&(t=this.max,e=!0),!s.isNumber(t)){var n=Number(t);if(!s.isNumber(n))return void this._log.warn(this.type+" has its upper value bound to a property that cannot be interpreted as a Number.");t=n,e=!0}this._setUpperValue(t,!0,e||!0===i&&this._forceFirstTime,!0)}else this._log.debug("Cannot set the value of the "+this.type+"'s upper knob while the user is manipulating it.")},i.prototype._initializeEvents=function(){var t,e,i=this,s=this._lowerKnob,n=this._upperKnob,r=this._touchStart,o=this._touchEnd,a=this._trackLower,l=this._trackUpper;this._isVertical?(t="$trackdown",e="$trackup"):(t="$trackright",e="$trackleft"),this.addEventListener(s,"$touchstart",r,!1),this.addEventListener(n,"$touchstart",r,!1),this.addEventListener(s,t,a,!1),this.addEventListener(s,e,a,!1),this.addEventListener(n,t,l,!1),this.addEventListener(n,e,l,!1),this.addEventListener(s,"$touchend",o,!1),this.addEventListener(n,"$touchend",o,!1),this.addEventListener(s,"$trackend",o,!1),this.addEventListener(n,"$trackend",o,!1),this.addEventListener(this._window,"resize",function(){i.utils.isNull(i._rangeVisible)&&(i._setPositionAndLength(),i._setLowerKnobPosition(),i._setUpperKnobPosition())},!1)},i.prototype._touchStart=function(t){var e=this._touchState;if(1!==e&&2!==e&&3!==e){this._touchState=1;var i=t.currentTarget,s=this._lastTouch;if(this.utils.isNull(s))this.dom.addClass(i,"plat-top");else if(s.target!==i){var n=this.dom;n.addClass(i,"plat-top"),n.removeClass(s.target,"plat-top")}this._lastTouch={x:t.clientX,y:t.clientY,value:i===this._lowerKnob?this.lower:this.upper,target:i}}},i.prototype._touchEnd=function(t){var e=this,i=this._touchState;if(0!==i&&4!==i){this._touchState=4;var s=this._lastTouch,n=t.currentTarget;this.utils.isNull(s)||s.target!==n||this.utils.requestAnimationFrame(function(){e._touchState=0;var i=n===e._lowerKnob,r=e._calculateOffset(t,i);i?s.value!==e.lower&&e._trigger("change"):s.value!==e.upper&&e._trigger("change"),e._setOffset(r,i)})}else this._touchState=0},i.prototype._setOffset=function(t,e){var i=this._maxOffset;return t<0?e?this._lowerKnobOffset=0:this._upperKnobOffset=0:t>i?e?this._lowerKnobOffset=i:this._upperKnobOffset=i:e?this._lowerKnobOffset=t:this._upperKnobOffset=t},i.prototype._trackLower=function(t){var e=this._touchState;if(2!==e)if(1===e)this._touchState=2;else if(0===e||3===e)return;var i,s=this._maxOffset,n=this._calculateOffset(t,!0);if(n<=0?((i=this.min)-this.lower>=0&&(i=null),n=0):n>=s?((i=this.max)-this.lower<=0&&(i=null),n=s):(i=this._calculateValue(n))-this.lower==0&&(i=null),n>this._upperKnobOffset)return this._positionTogether(n,i),void this._setOffset(n,!1);this._positionLower(n,i)},i.prototype._trackUpper=function(t){var e=this._touchState;if(3!==e)if(1===e)this._touchState=3;else if(0===e||2===e)return;var i,s=this._maxOffset,n=this._calculateOffset(t,!1);if(n<=0?((i=this.min)-this.upper>=0&&(i=null),n=0):n>=s?((i=this.max)-this.upper<=0&&(i=null),n=s):(i=this._calculateValue(n))-this.upper==0&&(i=null),n<this._lowerKnobOffset)return this._positionTogether(n,i),void this._setOffset(n,!0);this._positionUpper(n,i)},i.prototype._positionLower=function(t,e){var i=this;this.utils.requestAnimationFrame(function(){var s=i._slider.style;s[i._positionProperty]=t+"px",s[i._lengthProperty]=i._upperKnobOffset-t+"px",null!==e&&i._setLowerValue(e,!1,!0,!0)})},i.prototype._positionUpper=function(t,e){var i=this;this.utils.requestAnimationFrame(function(){i._slider.style[i._lengthProperty]=t-i._lowerKnobOffset+"px",null!==e&&i._setUpperValue(e,!1,!0,!0)})},i.prototype._positionTogether=function(t,e){var i=this;this.utils.requestAnimationFrame(function(){var s=i._slider.style;s[i._positionProperty]=t+"px",s[i._lengthProperty]="0px",null!==e&&(i._setLowerValue(e,!1,!1,!1),i._setUpperValue(e,!1,!0,!0))})},i.prototype._calculateValue=function(t){var e=this._step;return this.min+Math.round(t/this._increment/e)*e},i.prototype._calculateOffset=function(t,e){var i,s=e?this._lowerKnobOffset:this._upperKnobOffset;return i=this._isVertical?this._reversed?t.clientY-this._lastTouch.y:this._lastTouch.y-t.clientY:this._reversed?this._lastTouch.x-t.clientX:t.clientX-this._lastTouch.x,s+i},i.prototype._calculateKnobPosition=function(t){return(t-this.min)*this._increment},i.prototype._setLowerValue=function(t,e,i,s){var n=this.lower;if(t!==n){if(t>=this.max)t=this.max;else if(t<=this.min)t=this.min;else if(Math.abs(t-n)<this._step)return;this.lower=t,e&&this._setLowerKnobPosition(),i&&this._fireChange(),s&&this._trigger("input")}},i.prototype._setUpperValue=function(t,e,i,s){var n=this.upper;if(t!==n){if(t>=this.max)t=this.max;else if(t<=this.min)t=this.min;else if(Math.abs(t-n)<this._step)return;this.upper=t,e&&this._setUpperKnobPosition(),i&&this._fireChange(),s&&this._trigger("input")}},i.prototype._setIncrement=function(){return this._increment=this._maxOffset/(this.max-this.min)},i.prototype._setPositionAndLength=function(){var t=this,e=this._slider.parentElement;this._isVertical?(this._lengthProperty="height",this._positionProperty=this._reversed?"top":"bottom",this._maxOffset=e.clientHeight):(this._lengthProperty="width",this._positionProperty=this._reversed?"right":"left",this._maxOffset=e.clientWidth),this._maxOffset?this._setIncrement():this._rangeVisible=new this._Promise(function(i){t._removeVisibilityListener=t.dom.whenVisible(function(){t._rangeVisible=null,t._setPositionAndLength(),i()},e)})},i.prototype._setLowerKnobPosition=function(t){var e=this;this._Promise.resolve(this._rangeVisible).then(function(){var i={},s=e._upperKnobOffset,n=e.utils.isNumber(s)?s:e._setOffset(e._calculateKnobPosition(e.upper),!1),r=e._calculateKnobPosition(t||e.lower);r!==e._lowerKnobOffset&&(i[e._positionProperty]=r+"px",i[e._lengthProperty]=n-r+"px",e._animator.animate(e._slider,u,{properties:i}),e._lowerKnobOffset=r)})},i.prototype._setUpperKnobPosition=function(t){var e=this;this._Promise.resolve(this._rangeVisible).then(function(){var i={},s=e._calculateKnobPosition(t||e.upper);s!==e._upperKnobOffset&&(i[e._lengthProperty]=s-e._lowerKnobOffset+"px",e._animator.animate(e._slider,u,{properties:i}),e._upperKnobOffset=s)})},i.prototype._fireChange=function(){var t={};t[this._lowerIdentifier]=this.lower,t[this._upperIdentifier]=this.upper,this.inputChanged(t)},i.prototype._trigger=function(t){var e=plat.acquire("$DomEventInstance");e.initialize(this.element,t),e.trigger()},i.prototype._validateOrientation=function(t){if(this.utils.isUndefined(t))return"horizontal";var e;return"horizontal"===t?e=t:"vertical"===t?(e=t,this._isVertical=!0):(this._log.debug('Invalid orientation "'+t+'" for '+this.type+'. Defaulting to "horizontal."'),e="horizontal"),e},i._inject={_document:"$Document",_window:"$Window",_Promise:"$Promise",_animator:"$Animator"},i}(plat.ui.BindControl);t.Range=P,plat.register.control("plat-range",P);var S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,"plat-select "+(t||""))},e.prototype.initialize=function(){t.prototype.initialize.call(this),this.setClasses()},e}(plat.ui.controls.Select);t.Select=S,plat.register.control("plat-select",S);var N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.replaceWith="input",e.value="",e}return __extends(e,t),e.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,"plat-input "+(t||""))},e.prototype.initialize=function(){this.setClasses()},e.prototype.setTemplate=function(){this.dom.clearNode(this.element)},e.prototype.loaded=function(){var t=(this.options||{}).value||{},e=t.pattern,i=t.validation,s=this.utils.isString;this._type=this.attributes.type||t.type||"text",s(e)&&""!==e&&("/"===e[0]&&"/"===e[e.length-1]&&(e=e.slice(1,-1)),this._pattern=new RegExp(e)),s(i)&&""!==i&&("/"===i[0]&&"/"===i[i.length-1]&&(i=i.slice(1,-1)),this._validation=new RegExp(i)),this._initializeType()},e.prototype.validate=function(){return this._validation.test(this.element.value)},e.prototype.clear=function(){var t=this.element,e=t.value;""!==e&&(t.value=this.value="",this.inputChanged(this.value,e))},e.prototype.focus=function(){this.element.focus()},e.prototype.blur=function(){this.element.blur()},e.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty,null,!0)},e.prototype._setBoundProperty=function(t,e,i,s){var n=this.element.value;if(this.utils.isNull(t)){if(t="",!0===s)return void(this.utils.isNull(n)&&this._onInputChanged(t))}else if(t===n)return;this._onInputChanged(t)},e.prototype._initializeType=function(){var t=this._type;switch(t){case"text":this._pattern=this._pattern||/[\S\s]*/,this._validation=this._validation||this._pattern;break;case"email":this._pattern=this._pattern||/[\S\s]*/,this._validation=this._validation||this._regex.validateEmail;break;case"password":this._pattern=this._pattern||/[\S\s]*/,this._validation=this._validation||this._pattern;break;case"telephone":t="tel";case"tel":this._pattern=this._pattern||this._regex.validateTelephone,this._validation=this._validation||this._pattern;break;case"number":this._pattern=this._pattern||/^[0-9\.,]*$/,this._validation=this._validation||this._pattern,t="tel";break;case"hidden":return void this.element.setAttribute(a,"");case"radio":return void this._log.debug(t+" is not supported by "+this.type+". Please use a plat-radio instead.");case"checkbox":return void this._log.debug(t+" is not supported by "+this.type+". Please use a plat-checkbox instead.");case"range":return void this._log.debug(t+" is not supported by "+this.type+". Please use a plat-slider instead.");case"file":return void this._log.debug(t+" is not supported by "+this.type+". Please use a plat-file instead.");default:this._log.debug(t+" is not yet fully supported by "+this.type+'. Defaulting to type="text".'),t="text",this._pattern=this._pattern||/[\S\s]*/,this._validation=this._validation||this._pattern}this._addTextEventListener()},e.prototype._addTextEventListener=function(){var t,e=this,i=this.element,s=this._compat,n=this.utils,r=!1,o=function(){r||e._onInput()},a=function(){n.isFunction(t)||(t=n.postpone(function(){o(),t=null}))};n.isUndefined(s.ANDROID)&&(this.addEventListener(i,"compositionstart",function(){return r=!0},!1),this.addEventListener(i,"compositionend",function(){r=!1,o()},!1)),s.hasEvent("input")?this.addEventListener(i,"input",o,!1):(this.addEventListener(i,"keydown",function(t){var s=t.keyCode;if(!(91===s||92===s||s>15&&s<28||s>32&&s<41)){var n=e._pattern,r=t.char;n.test(r)&&n.test(i.value+r)?a():t.preventDefault()}},!1),this.addEventListener(i,"cut",a,!1),this.addEventListener(i,"paste",a,!1)),this.addEventListener(i,"change",o,!1)},e.prototype._onInput=function(){var t=this.element,e=t.value,i=this._stripInput(t.value);e!==i&&(e=t.value=i),e!==this.value&&(this.value=t.value,this.inputChanged(this.value))},e.prototype._onInputChanged=function(t){var e=this.element;t=this._stripInput(t),e.value=t,this.value=e.value},e.prototype._stripInput=function(t){for(var e,i="",s=i,n=this._pattern,r=t.length,o=0;o<r;++o)e=t[o],n.test(e)&&(i+=e,n.test(i)?s=i:i=s);return i},e._inject={_compat:"$Compat",_regex:"$Regex"},e}(plat.ui.BindControl);t.Input=N,plat.register.control("plat-input",N);var A=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateString='<div class="plat-file-container">\n    <input type="file" class="plat-file-hidden" />\n    <input type="text" class="plat-file-input" plat-keydown="_onKeyDown" />\n    <button class="plat-file-button" plat-tap="_selectFiles"></button>\n</div>\n',e._removeListener=f,e}return __extends(e,t),e.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,"plat-file "+(t||""))},e.prototype.initialize=function(){this.setClasses()},e.prototype.setTemplate=function(){for(var t,e,i,s=this.element,n=this._hiddenInput=s.firstElementChild.firstElementChild,r=this._visibleInput=n.nextElementSibling,o=r.nextElementSibling,a=this.attributes,l=Object.keys(a),h=l.length,p=plat.dependency.injectors.control,u=/plat-(?:control|hide|context)|class|style/,d=!1,c=this.utils,_=c.isNull,f=c.delimit,m=c.isString,v=0;v<h;++v)e=f(t=l[v],"-"),m(i=a[t])&&!u.test(e)&&_(p[e])?"id"===e?(s.removeAttribute(e),n.setAttribute(e,i)):"multiple"===e?(d=!0,n.setAttribute(e,i)):"disabled"===e?(n.setAttribute(e,i),r.setAttribute(e,i),o.setAttribute(e,i)):n.setAttribute(e,i):"plat-disabled"===e&&(n.setAttribute(e,i),r.setAttribute(e,i),o.setAttribute(e,i));if(_(this.innerTemplate))o.textContent=d?"Select files":"Select a file";else{var g=this.innerTemplate.textContent.replace(/\r|\n/g,"");c.isEmpty(g)?o.textContent=d?"Select files":"Select a file":o.textContent=g}},e.prototype.loaded=function(){var t=this._hiddenInput=this._hiddenInput||this.element.firstElementChild.firstElementChild;this._visibleInput=this._visibleInput||t.nextElementSibling,this._addChangeListener()},e.prototype.validate=function(){return!this.utils.isEmpty(this._hiddenInput.value)},e.prototype.clear=function(){var t=this._hiddenInput;if(!this.utils.isEmpty(t.value)){t.value=null;var e=this._hiddenInput=t.cloneNode(!0);this.element.firstElementChild.replaceChild(e,t),this._addChangeListener(),this._visibleInput.value="",this.inputChanged(null),this._trigger("change")}},e.prototype.click=function(){this._selectFiles()},e.prototype.value=function(){var t=this._hiddenInput,e=t.files;if(!this.utils.isNull(e))return t.multiple?Array.prototype.slice.call(e):e[0]},e.prototype.disable=function(){var t=this._visibleInput;this._hiddenInput.setAttribute("disabled","disabled"),t.setAttribute("disabled","disabled"),t.nextElementSibling.setAttribute("disabled","disabled"),this.element.setAttribute("disabled","disabled")},e.prototype.enable=function(){var t=this._visibleInput;this._hiddenInput.removeAttribute("disabled"),t.removeAttribute("disabled"),t.nextElementSibling.removeAttribute("disabled"),this.element.removeAttribute("disabled")},e.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty)},e.prototype._setBoundProperty=function(t,e,i,s){var n=this.utils;if(n.isFile(t)){var r=this._hiddenInput,o=r.files;n.isNull(o)||(r.multiple?(this.inputChanged(Array.prototype.slice.call(o)),this._trigger("change")):t!==o[0]&&(this.inputChanged(o[0]),this._trigger("change")))}else this.clear()},e.prototype._addChangeListener=function(){this._removeListener(),this._removeListener=this.addEventListener(this._hiddenInput,"change",this._filesSelected,!1)},e.prototype._onKeyDown=function(t){var e=t.keyCode,i=plat.controls.KeyCodes;return e===i.tab||(e!==i.backspace&&e!==i.delete||this.clear(),t.preventDefault(),!1)},e.prototype._selectFiles=function(){this._hiddenInput.click()},e.prototype._filesSelected=function(){var t=this._hiddenInput,e=this._visibleInput,i=t.files;if(this.utils.isEmpty(i))this.clear();else{if(t.multiple){for(var s=[],n=i.length,r=0;r<n;++r)s.push(i[r].name);e.value=s.join(", "),this.inputChanged(Array.prototype.slice.call(i))}else{var o=i[0];e.value=o.name,this.inputChanged(o)}this._trigger("change")}},e.prototype._trigger=function(t){var e=plat.acquire("$DomEventInstance");e.initialize(this.element,t),e.trigger()},e._inject={_compat:"$Compat"},e}(plat.ui.BindControl);t.File=A,plat.register.control("plat-file",A);var I=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateString='<div class="plat-carousel-viewport">\n    <div class="plat-carousel-container"></div>\n</div>\n',e._listeners=[],e._isVertical=!1,e._hasSwiped=!1,e._inTouch=!1,e._hasMoved=!1,e._lastTouch={x:0,y:0},e._loaded=!1,e._index=-1,e._previousIndex=-1,e._nextIndex=-1,e._currentOffset=0,e._removeInterval=f,e._removeSuspend=f,e._isAuto=!1,e._isPaused=!1,e._selfPause=!1,e._itemNodes=[],e._removeListeners=[],e._outerStart=!1,e._outerEnd=!1,e._goToIntervalConstant=125,e}return __extends(i,t),Object.defineProperty(i.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),i.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,n+" "+(t||""))},i.prototype.contextChanged=function(t,e){var i=this.utils;if(i.isFunction(this._onLoad))return i.isArray(t)?this._setListener():(this._log.debug(this.type+" context set to something other than an Array."),t=[]),this._executeEvent([{object:t,type:"splice"}]),void this._initializeIndex(0);this.loaded()},i.prototype.initialize=function(){this.setClasses()},i.prototype.setTemplate=function(){var t=this._document.createElement("div");t.className=n+"-item",t.appendChild(this.innerTemplate),this.bindableTemplates.add("item",t)},i.prototype.loaded=function(){var t=this,i=this.utils,s=this.context;if(i.isArray(s)){this._animate=!1;var n,r=(this.options||{}).value||{},o=r.index,a=i.isNumber,l=this._validateOrientation(r.orientation),h=r.interval,p=this._interval=a(h)?Math.abs(h):3e3,u=r.suspend,d=this.dom,c=this.element,_=this._viewport=c.firstElementChild;switch(r.transition){case"fade":n="fade",this._fade=1;break;case"fade-in":n="fade",this._fade=2;break;case"fade-out":n="fade",this._fade=3;break;default:n="translate",this._fade=0}this._container=_.firstElementChild,this._type=r.type||"track swipe",this._isInfinite=!0===r.infinite,this._suspend=Math.abs(a(u)?p-u:p-3e3),d.addClass(c,e+l+" "+(e+n)),this._onLoad=function(){var e=t._index;o=a(o)&&o>=0?o<s.length?o:s.length-1:null,t._index=0,d.whenVisible(function(){t._initializeIndex(null===o?e:o),t._addEventListeners(),t._loaded=!0},c)},this._init()}else this._log.warn("The context of a "+this.type+" must be an Array.")},i.prototype.goToNext=function(){return this._goToNext(!1)},i.prototype.goToPrevious=function(){return this._goToPrevious(!1)},i.prototype.goToIndex=function(t,e){return this._goToIndex(t,!1,e)},i.prototype.pause=function(){this._selfPause=!1,this._isAuto&&!this._isPaused&&(this._isPaused=!0,this._removeSuspend(),this._removeSuspend=f,this._removeInterval(),this._removeInterval=f)},i.prototype.resume=function(){this._isAuto&&this._isPaused&&(this._isPaused=this._selfPause=!1,this._initiateInterval())},i.prototype.dispose=function(){t.prototype.dispose.call(this),this._listeners=[],this._removeEventListeners()},i.prototype.onInput=function(t){var e=this._listeners;return e.push(t),function(){var i=e.indexOf(t);-1!==i&&e.splice(i,1)}},i.prototype.inputChanged=function(t,e){if(t!==e)for(var i=this._listeners,s=i.length,n=0;n<s;++n)i[n](t,e)},i.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty)},i.prototype._setBoundProperty=function(t,e,i,s){var n=this.utils;if(n.isNull(t)){if(!0===s)return this._index=0,void this.inputChanged(0,t)}else if(n.isNumber(t)){if(t<0)return this._index=0,this.inputChanged(0,t),void this._initializeIndex(0)}else if(t=Number(t),!n.isNumber(t))return void this._log.warn(this.type+" has its index bound to a property that cannot be interpreted as a Number.");this._loaded?this._goToIndex(t,!0,!0===s):this._index=t},i.prototype._reset=function(){if(!this._fade){var t={};t[this._transform]=this._calculateStaticTranslation(0),this._initiateAnimation({properties:t})}},i.prototype._verifyLength=function(){var t=this.context,e=this._index;if(!this.utils.isArray(t)||0===t.length)return this.utils.isUndefined(e)||this.inputChanged(this._index=void 0,e),this._fade||(this._container.style[this._transform]=this._calculateStaticTranslation(-this._currentOffset)),this._removeEventListeners(),void this._checkArrows();var i=t.length-1;e>i?this.goToIndex(i):this._checkArrows()},i.prototype._setIndexWindow=function(){var t=this._index,e=this._itemNodes.length-1;e<0?this._previousIndex=this._nextIndex=e:t>=e?(t>e&&(t=this._index=e),this._previousIndex=t-1,this._nextIndex=this._isInfinite?0:-1):t<=0?(t<0&&(t=this._index=0),this._previousIndex=this._isInfinite?e:-1,this._nextIndex=t+1):(this._previousIndex=t-1,this._nextIndex=t+1)},i.prototype._goToNext=function(t){var e=this;return this._Promise.all(this._addQueue).then(function(){var i=!1;if(e._index>=e._itemNodes.length-1&&!(i=e._isInfinite))return e._isAuto&&!e._isPaused&&(e.pause(),e._selfPause=!0),e._Promise.resolve(!1);var s=e._getLength();return s?e._fade?e._fadeNext(t,i):e._translateNext(s,t,i):e.goToIndex(e._nextIndex,!0)})},i.prototype._goToPrevious=function(t){var e=this;return this._Promise.all(this._addQueue).then(function(){var i=!1;if(e._index<=0&&!(i=e._isInfinite))return e._Promise.resolve(!1);e._selfPause&&e.resume();var s=e._getLength();return s?e._fade?e._fadePrevious(t,i):e._translatePrevious(s,t,i):e.goToIndex(e._previousIndex,!0)})},i.prototype._goToIndex=function(t,e,i){var s=this;return this._Promise.all(this._addQueue).then(function(){var n=s._index;return s.utils.isUndefined(n)?(s._initializeIndex(0),s.inputChanged(s._index,t),s._isInfinite||(t<s.context.length-1?s._selfPause&&s.resume():s._isAuto&&!s._isPaused&&(s.pause(),s._selfPause=!0)),s._Promise.resolve(!0)):t===n?s._Promise.resolve(!1):!0===i?(s._initializeIndex(t),s.inputChanged(s._index,t),s._isInfinite||(t<s.context.length-1?s._selfPause&&s.resume():s._isAuto&&!s._isPaused&&(s.pause(),s._selfPause=!0)),s._Promise.resolve(!0)):t-n>0&&t===s._nextIndex?s._goToNext(e):t===s._previousIndex?s._goToPrevious(e):s._handleGoToIndex(t,e)})},i.prototype._handleGoToIndex=function(t,e){var i=this._index;if(t===i||t<0||t>=this.context.length)return this._Promise.resolve(!1);if(this._selfPause&&this.resume(),!this._getLength())return this._initializeIndex(t),this._Promise.resolve(!0);var s,n,r,o=this._Promise,a=this.utils.defer;t>i?(s=this._goToNext,n=t-i,this._isInfinite&&(r=this._itemNodes.length-t+i)<n&&(s=this._goToPrevious,n=r)):(s=this._goToPrevious,n=i-t,this._isInfinite&&(r=this._itemNodes.length-i+t)<n&&(s=this._goToNext,n=r)),s=s.bind(this);for(var l=[],h=this._removeListeners,p=this._goToIntervalConstant,u=0;--n>0;)l.push(new o(function(t){var i=a(function(){var n=h.indexOf(i);-1!==n&&h.splice(n,1),t(s(e))},u+=Math.round(p/n));h.push(i)}));return l.push(s(e)),o.all(l).then(function(t){for(var e=!1;t.length>0&&!(e=e||t.pop()););return e})},i.prototype._translateNext=function(t,e,i){var s=this;return this._cancelCurrentAnimations().then(function(){s._outerEnd||s._initializeOuterNodes();var n={};n[s._transform]=s._calculateStaticTranslation(-t);var r,o=s._initiateAnimation({properties:n}),a=s._index;return i?s._index=r=0:r=++s._index,e||s.inputChanged(s._index,a),o.then(function(){return s._handleNext(r,t),s._checkArrows(),!0})})},i.prototype._fadeNext=function(t,e){var i=this;return this._cancelCurrentAnimations().then(function(){i._outerEnd||i._initializeOuterNodes();var s,n,r,o,a=i._index,l=i._animator,h=i.dom,p=i._container,d=Array.prototype.slice.call(p.childNodes),c=d.length,_=d[c-5],f=d[c-2],m=i._fade;return 2===m?(r=l.animate(f,u),h.addClass(_,"plat-middle"),h.addClass(f,"plat-top"),o=function(){h.removeClass(_,"plat-top"),h.removeClass(_,"plat-middle")}):3===m?(n=l.animate(_,u),h.addClass(f,"plat-top"),h.toggleClass(_,"plat-top plat-middle"),o=function(){h.removeClass(_,"plat-middle")}):(n=l.animate(_,u),r=l.animate(f,u),h.toggleClass(_,"plat-top plat-middle"),h.addClass(f,"plat-top"),o=function(){h.removeClass(_,"plat-middle")}),e?i._index=s=0:s=++i._index,t||i.inputChanged(i._index,a),i._nextAnimationThenable=r,i._animationThenable=n,i._Promise.all([r,n]).then(function(){return o(),i._handleNext(s,length),i._checkArrows(),!0})})},i.prototype._handleNext=function(t,e){var i=this._isInfinite,s=this._itemNodes,n=s.length,r=this.utils.isArray;if(i&&(n<3||r(this._preClonedNodes)||r(this._postClonedNodes)))this._initializeIndex(t);else{var o=this._container;this._outerStart?(i||t>1)&&(this.dom.insertBefore(s[this._previousIndex],Array.prototype.slice.call(o.childNodes,0,3)),this._fade||(o.style[this._transform]=this._calculateStaticTranslation(e),this._forceRepaint(o))):this._outerStart=!0,this._setIndexWindow(),(i||t<n-1)&&o.insertBefore(s[this._nextIndex],null)}},i.prototype._translatePrevious=function(t,e,i){var s=this;return this._cancelCurrentAnimations().then(function(){s._outerStart||s._initializeOuterNodes();var n={};n[s._transform]=s._calculateStaticTranslation(t);var r,o=s._initiateAnimation({properties:n}),a=s._index;return i?s._index=r=s._itemNodes.length-1:r=--s._index,e||s.inputChanged(s._index,a),o.then(function(){return s._handlePrevious(r,-t),s._checkArrows(),!0})})},i.prototype._fadePrevious=function(t,e){var i=this;return this._cancelCurrentAnimations().then(function(){i._outerStart||i._initializeOuterNodes();var s,n,r,o,a=i._index,l=i._animator,h=i.dom,p=i._container,d=Array.prototype.slice.call(p.childNodes),c=d[4],_=d[1],f=i._fade;return 2===f?(r=l.animate(_,u),h.addClass(c,"plat-middle"),h.addClass(_,"plat-top"),o=function(){h.removeClass(c,"plat-top"),h.removeClass(c,"plat-middle")}):3===f?(n=l.animate(c,u),h.addClass(_,"plat-top"),h.toggleClass(c,"plat-top plat-middle"),o=function(){h.removeClass(c,"plat-middle")}):(n=l.animate(c,u),r=l.animate(_,u),h.toggleClass(c,"plat-top plat-middle"),h.addClass(_,"plat-top"),o=function(){h.removeClass(c,"plat-middle")}),e?i._index=s=i._itemNodes.length-1:s=--i._index,t||i.inputChanged(i._index,a),i._nextAnimationThenable=r,i._animationThenable=n,i._Promise.all([r,n]).then(function(){return o(),i._handlePrevious(s,-length),i._checkArrows(),!0})})},i.prototype._handlePrevious=function(t,e){var i=this._isInfinite,s=this._itemNodes,n=s.length,r=this.utils.isArray;if(i&&(n<3||r(this._preClonedNodes)||r(this._postClonedNodes)))this._initializeIndex(t);else{var o=this._container;this._outerEnd?(i||t<n-2)&&this.dom.insertBefore(s[this._nextIndex],Array.prototype.slice.call(o.childNodes,-3)):this._outerEnd=!0,this._setIndexWindow(),(i||t>0)&&(o.insertBefore(s[this._previousIndex],o.firstChild),this._fade||(o.style[this._transform]=this._calculateStaticTranslation(e),this._forceRepaint(o)))}},i.prototype._clearInnerNodes=function(){this._removeClones(),this._outerStart=this._outerEnd=!1;var t=this._itemNodes;if(0===t.length)return!1;var e=Array.prototype.slice.call(this._container.childNodes),i=this.dom.insertBefore;switch(e.length){case 9:i(t[this._previousIndex],e.splice(0,3)),i(t[this._nextIndex],e.splice(-3,3)),i(t[this._index],e);break;case 6:var s=this._nextIndex,n=this._index;if(s<0||s===n){i(t[n],e.splice(-3,3)),i(t[0===n?this._previousIndex+1:n-1],e);break}i(t[s],e.splice(-3,3)),i(t[n],e);break;case 3:i(t[this._index],e)}return!0},i.prototype._initializeIndex=function(t){var e=this._clearInnerNodes();if(0===this._itemNodes.length?t=-1:t<0&&(t=0),this._index=t,this._setIndexWindow(),!e)return!1;var i=this._fade,s=this._itemNodes[t];if(i){var n=s.childNodes[1];this.dom.addClass(n,"plat-top")}var r=this._container;return r.insertBefore(s,null),i||(r.style[this._transform]=this._calculateStaticTranslation(-this._currentOffset),this._forceRepaint(r)),this._initializeOuterNodes(),this._checkArrows(),!0},i.prototype._initializeOuterNodes=function(){var t=this._getLength();if(t){var e,i=this._itemNodes,s=this._container,n=i.length;if(n<=1){if(this._isInfinite)return void this._cloneForInfinite(-t)}else{var r=this.utils.isNode;this._outerEnd||r(e=i[this._nextIndex])&&(s.insertBefore(e,null),this._outerEnd=!0),n>2?!this._outerStart&&(this._isInfinite||this._index>0)&&r(e=i[this._previousIndex])&&(s.insertBefore(e,s.firstChild),this._fade||(s.style[this._transform]=this._calculateStaticTranslation(-t),this._forceRepaint(s)),this._outerStart=!0):this._isInfinite&&this._cloneForInfinite(-t)}}else this._outerStart=this._outerEnd=!1},i.prototype._initiateAnimation=function(t){return this._animationThenable=this._animator.animate(this._container,u,t)},i.prototype._init=function(){var t=this,e=this._addQueue,i=this.context.length;this._setAliases();var s=this._addItems(0,i,0).then(function(){var i=e.indexOf(s);-1!==i&&e.splice(i,1),t._onLoad()}).catch(function(){t._log.debug("An error occurred while processing the "+t.type+". Please ensure you're context is correct."),t._loaded=!1});e.push(s),this._setListener(),this._setTransform()},i.prototype._addEventListeners=function(){var t=this,e=this._type.split(" ");if(-1!==e.indexOf("tap")&&this._initializeTap(),-1!==e.indexOf("swipe")&&this._initializeSwipe(),-1!==e.indexOf("track")&&this._initializeTrack(),-1!==e.indexOf("auto")&&this._initializeAuto(),!this._fade){var i=!1;this.addEventListener(this._window,"resize",function(){i||(i=!0,t.utils.requestAnimationFrame(function(){i=!1;var e=t._length,s=t._getLength();s&&e!==s&&(t._isInfinite||0!==t._index)&&(t._container.style[t._transform]=t._calculateStaticTranslation(e-s))}))},!1)}},i.prototype._removeEventListeners=function(){for(var t=this._removeListeners;t.length>0;)t.pop()();this._removeInterval(),this._removeSuspend(),this._isInfinite&&this._removeClones(),this._onLoad=f},i.prototype._cloneForInfinite=function(t){this._removeClones();var e=this.context;if(this.utils.isArray(e)&&0!==e.length){var i=this._outerStart,s=this._outerEnd;if(!i||!s){var r,o,a,l=this._container,h=this._document;s||(r=h.createComment(n+" clone: start node"),o=h.createComment(n+" clone: end node"),a=l.firstElementChild.cloneNode(!0),this._postClonedNodes=[r,a,o],l.insertBefore(r,null),l.insertBefore(a,null),l.insertBefore(o,null),this._outerEnd=!0),i||(r=h.createComment(n+" clone: start node"),o=h.createComment(n+" clone: end node"),a=l.lastElementChild.cloneNode(!0),this._preClonedNodes=[r,a,o],l.insertBefore(o,l.firstChild),l.insertBefore(a,l.firstChild),l.insertBefore(r,l.firstChild),this._outerStart=!0,this._fade||(l.style[this._transform]=this._calculateStaticTranslation(t),this._forceRepaint(l)))}}},i.prototype._removeClones=function(){var t=this._container,e=this._preClonedNodes,i=this._postClonedNodes,s=this.utils.isArray;s(e)&&(t.removeChild(e[0]),t.removeChild(e[1]),t.removeChild(e[2])),s(i)&&(t.removeChild(i[0]),t.removeChild(i[1]),t.removeChild(i[2])),this._preClonedNodes=this._postClonedNodes=null},i.prototype._initializeAuto=function(){this._isAuto=!0,this._initiateInterval()},i.prototype._initiateInterval=function(){this._removeInterval=this.utils.setInterval(this.goToNext,this._interval,null,this)},i.prototype._suspendInterval=function(){var t=this;this._isAuto&&!this._isPaused&&(this._removeSuspend(),this._removeInterval(),this._removeSuspend=this.utils.defer(function(){t._initiateInterval(),t._removeSuspend=f},this._suspend))},i.prototype._initializeTap=function(){var t=this;this.utils.isNode(this._forwardArrow)||this._createArrowElements();var e=this._removeListeners;e.push(this.addEventListener(this._backArrow,"$tap",function(){t._suspendInterval(),t.goToPrevious()},!1)),e.push(this.addEventListener(this._forwardArrow,"$tap",function(){t._suspendInterval(),t.goToNext()},!1)),this._checkArrows()},i.prototype._createArrowElements=function(){var t=this._document,e=this._viewport,i=this._backArrow=t.createElement("div"),s=this._forwardArrow=t.createElement("div"),n=t.createElement("span"),r=t.createElement("span");this._isVertical?(n.className="plat-icon-arrow-up",r.className="plat-icon-arrow-down"):(n.className="plat-icon-arrow-left",r.className="plat-icon-arrow-right"),i.className="plat-back-arrow",s.className="plat-forward-arrow",i.appendChild(n),s.appendChild(r),e.appendChild(i),e.appendChild(s)},i.prototype._checkArrows=function(){var t=this.utils,e=t.isNode;if(!this._isInfinite&&e(this._forwardArrow)&&e(this._backArrow)){var i=this.context.length,s=this._index;if(t.isNull(s))return this._backArrow.setAttribute(a,""),void this._forwardArrow.setAttribute(a,"");s<=0?this._backArrow.setAttribute(a,""):this._backArrow.removeAttribute(a),s>=i-1?this._forwardArrow.setAttribute(a,""):this._forwardArrow.removeAttribute(a)}},i.prototype._initializeSwipe=function(){var t,e,i=this._viewport,s=this._handleSwipe;this._isVertical?(t="$swipeup",e="$swipedown"):(t="$swipeleft",e="$swiperight");var n=this._removeListeners;n.push(this.addEventListener(i,t,s,!1)),n.push(this.addEventListener(i,e,s,!1))},i.prototype._initializeTrack=function(){var t,e,i=this._viewport,s=this._track,n=this._touchEnd;this._isVertical?(t="$trackup",e="$trackdown"):(t="$trackleft",e="$trackright");var r=this._removeListeners;r.push(this.addEventListener(i,t,s,!1)),r.push(this.addEventListener(i,e,s,!1)),r.push(this.addEventListener(i,"$touchstart",this._touchStart,!1)),r.push(this.addEventListener(i,"$trackend",n,!1)),r.push(this.addEventListener(i,"$touchend",n,!1))},i.prototype._handleSwipe=function(t){var e=!1;switch(t.direction.primary){case"left":!this._isVertical&&(this._isInfinite||this._index<this.context.length-1)&&(this._suspendInterval(),e=!0,this.goToNext());break;case"right":!this._isVertical&&(this._isInfinite||this._index>0)&&(this._suspendInterval(),e=!0,this.goToPrevious());break;case"up":this._isVertical&&(this._isInfinite||this._index<this.context.length-1)&&(this._suspendInterval(),e=!0,this.goToNext());break;case"down":this._isVertical&&(this._isInfinite||this._index>0)&&(this._suspendInterval(),e=!0,this.goToPrevious());break;default:return}this._hasSwiped=e},i.prototype._touchStart=function(t){this._inTouch||(this._isAuto&&(this._removeInterval(),this._removeInterval=f),this._inTouch=!0,this._hasMoved=!1,this._lastTouch={x:t.clientX,y:t.clientY})},i.prototype._touchEnd=function(t){var e=this,i=this._inTouch,s=this._hasMoved,n=this._hasSwiped;if(this._inTouch=this._hasSwiped=this._hasMoved=!1,i&&!n&&(this._isAuto&&!this._isPaused&&this._initiateInterval(),s)){var r=this._isVertical?t.clientY-this._lastTouch.y:t.clientX-this._lastTouch.x,o=this._getLength();if(o)return Math.abs(r)>Math.ceil(o/2)?r<0?void this.goToNext().then(function(t){t||e._reset()}):void this.goToPrevious().then(function(t){t||e._reset()}):void this._reset();this._reset()}},i.prototype._track=function(t){var e=this;this._inTouch&&(this._fade?this._hasMoved=!0:(this._hasMoved||this._cancelCurrentAnimations().then(function(){e._outerStart&&e._outerEnd||e._initializeOuterNodes()}),this._hasMoved=!0,this.utils.requestAnimationFrame(function(){var i=e._calculateDynamicTranslation(t);null!==i&&(e._container.style[e._transform]=i)})))},i.prototype._calculateStaticTranslation=function(t){return this._isVertical?"translate3d(0,"+(this._currentOffset+=t)+"px,0)":"translate3d("+(this._currentOffset+=t)+"px,0,0)"},i.prototype._calculateDynamicTranslation=function(t){var e;return this._isVertical?(e=t.clientY-this._lastTouch.y,Math.abs(e)>this._getLength()?(this._touchEnd(t),null):"translate3d(0,"+(this._currentOffset+e)+"px,0)"):(e=t.clientX-this._lastTouch.x,Math.abs(e)>this._getLength()?(this._touchEnd(t),null):"translate3d("+(this._currentOffset+e)+"px,0,0)")},i.prototype._setTransform=function(){var t=this._container.style,e=this.utils.isUndefined,i=this._compat.vendorPrefix;e(t[i.lowerCase+"Transform"])?e(t[i.upperCase+"Transform"])?this._transform="transform":this._transform=i.upperCase+"Transform":this._transform=i.lowerCase+"Transform"},i.prototype._getLength=function(){return this._length=this._isVertical?this._viewport.offsetHeight:this._viewport.offsetWidth},i.prototype._validateOrientation=function(t){if(this.utils.isUndefined(t))return"horizontal";var e;return"horizontal"===t?e=t:"vertical"===t?(e=t,this._isVertical=!0):(this._log.debug('Invalid orientation "'+t+'" for '+this.type+'. Defaulting to "horizontal."'),e="horizontal"),e},i.prototype._appendItems=function(t){if(this._itemNodes=this._itemNodes.concat(t),this._loaded){var e=this._index;if(0===this._removeListeners.length)return this._addEventListeners(),this._initializeIndex(0),void this.inputChanged(0,e);e>=this._itemNodes.length-2&&this._initializeIndex(e)}},i.prototype._removeItems=function(t,e){for(var i=this._TemplateControlFactory.dispose,s=this.controls,n=this._itemNodes,r=t+e;r-- >t;)i(s[r]),n.pop();this._updateResource(s.length-1),this._verifyLength()},i.prototype._cancelCurrentAnimations=function(){if(this._fade){var t=this.utils.isNull,e=void 0,i=void 0;return t(this._nextAnimationThenable)||(i=this._nextAnimationThenable.cancel()),t(this._animationThenable)||(e=this._animationThenable.cancel()),this._Promise.all([e,i])}return this.utils.isNull(this._animationThenable)?this._Promise.resolve():this._animationThenable.cancel()},i.prototype._forceRepaint=function(t){var e=t.style,i=e.display;"none"!==e.display?(e.display="none",t.offsetWidth,e.display=i):t.offsetWidth},i._inject={_document:"$Document",_window:"$Window",_compat:"$Compat",_TemplateControlFactory:"$TemplateControlFactory"},i}(plat.ui.controls.ForEach);t.Carousel=I,plat.register.control(n,I);var L=function(t){function i(){var e=t.call(this)||this;return e._aliases={index:p.index,even:p.even,odd:p.odd,first:p.first,last:p.last,group:p.group},e._templates={},e._isVertical=!0,e._scrollReady=!0,e._isLoading=!1,e._scrollPosition=0,e._removeScroll=f,e._isRefreshing=!1,e._touchState=0,e._hasMoved=!1,e._lastTouch={x:0,y:0},e._nodeNormalizeRegex=/-|\.|_/g,e._isGrouped=!1,e._visibilityRemoveListeners=[],e.__templateString='<div class="plat-listview-viewport">\n    <div class="plat-scroll-container">\n        <div class="plat-listview-container"></div>\n    </div>\n</div>\n',e.__listenerSet=!1,e.templateString=e.__templateString,e.itemsLoaded=new e._Promise(function(t,i){e.__resolveFn=t,e.__rejectFn=i}).catch(f),e}return __extends(i,t),i.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,r+" "+(t||""))},i.prototype.initialize=function(){var t=this.options||(this.options={}),e=t.value||(t.value={});this.templateUrl=e.templateUrl||this.templateUrl,this.setClasses()},i.prototype.setTemplate=function(){if(this.templateString!==this.__templateString||this.utils.isString(this.templateUrl)){var t=this.dom.serializeHtml(this.__templateString),e=this.element;this.innerTemplate=this.dom.appendChildren(e.childNodes),e.appendChild(t)}},i.prototype.contextChanged=function(t,e){this.utils.isArray(t)?this._setListener():(this._log.debug(this.type+" context set to something other than an Array."),t=[]),this._executeEvent([{object:t,type:"splice"}])},i.prototype.loaded=function(){var t=this.options.value,i=this.utils,s=i.isString,n=this.element,r=this._viewport=n.firstElementChild,o=this._scrollContainer=r.firstElementChild,a=this._loading=t.loading,l=this._animate=!0===t.animate,h=t.onItemsRequested,p=t.onRefresh,u=t.itemTemplate,d=t.scrollElement;if(this._container=o.firstElementChild,this.dom.addClass(n,e+this._validateOrientation(t.orientation)+(l?" plat-animated":"")),s(d)&&(d=this._document.querySelector(d)),i.isNode(d)&&(this._scrollContainer=d,this.dom.addClass(n,"plat-no-scroller")),s(u)){var c=this._normalizeTemplateName(u),_=t.headerTemplate,f=s(_)?this._normalizeTemplateName(_):null;this._parseInnerTemplate(c,f),this._determineTemplates(u,c,f),this._defaultGroup={name:null,control:this,itemContainer:this._container,element:n,index:null,itemCount:0,addQueue:[],animationQueue:[]};var m=!1;s(a)&&(s(h)?this._determineLoading(h,!1!==t.infiniteProgress):this._log.debug(this.type+' loading type specified as "'+a+'" but no option specifying an onItemsRequested handler.')),s(p)&&(m=!0,this._initializeRefresh(p)),this._initializeTracking("incremental"===a,m),i.isArray(this.context)?(this._setAliases(),this._setContainerHeight(),this.render(),this._setListener()):i.isNull(this.context)||this._log.debug(this.type+"'s context must be an Array.")}else this._log.debug("No item template or item template selector specified for "+this.type+".")},i.prototype.dispose=function(){for(var t=this._visibilityRemoveListeners;t.length>0;)t.pop()();this._removeScroll(),this.utils.isFunction(this.__rejectFn)&&(this.__rejectFn(),this.__resolveFn=this.__rejectFn=null)},i.prototype.render=function(t,e,i){var s=this.utils.isNumber,n=i||this._defaultGroup,r=n.control,o=this===r?this.context:r.context.items;s(t)||(t=0);var a=o.length-t,l=s(e)&&a>=e?e:a;this._createItems(t,l,n,0)},i.prototype.rerender=function(t){this.render(0,null,t)},i.prototype._childContextChanged=function(t,e,i){this._executeChildEvent(t,[{object:e||[],type:"splice"}])},i.prototype._setListener=function(){this.__listenerSet||(this.observeArray(this._executeEvent),this.__listenerSet=!0)},i.prototype._setAliases=function(){var t=this.options.value.aliases,e=this.utils;if(e.isObject(t))for(var i,s=this._aliases,n=e.isString,r=Object.keys(s),o=r.length,a=0;a<o;++a)n(i=t[r[a]])&&(s[r[a]]=i)},i.prototype._determineTemplates=function(t,e,i){var s,n=this.utils,o=this.bindableTemplates,a=this._templates;if(n.isString(i)&&(this._isGrouped=!0,this.dom.addClass(this._container,"plat-grouped"),s=a[i],n.isNode(s)?(this._headerTemplate=i,this.bindableTemplates.add(i,s),delete a[i]):this._log.debug(r+' group header template "'+i+'" was not a template defined in the DOM.'),this._headerTemplatePromise=this._createGroupTemplate()),s=a[e],n.isNode(s))return this._itemTemplate=e,this.bindableTemplates.add(e,s),void delete a[e];var l=this.findProperty(t)||{};if(n.isFunction(l.value)){this._templateSelector=l.value.bind(l.control),this._templateSelectorKeys={};for(var h,p=Object.keys(a);p.length>0;)h=p.pop(),o.add(h,a[h]),delete a[h]}else this._log.debug(r+' item template "'+t+'" was neither a template defined in the DOM nor a template selector function in its control hiearchy.')},i.prototype._createGroupTemplate=function(){var t,e=this,i=this._document,s=this.bindableTemplates,n=this._headerTemplate,o=i.createElement("div"),a=i.createElement("div");return o.className="plat-listview-group",a.className=r+"-items",this.utils.isString(n)&&(t=s.templates[n].then(function(t){o.insertBefore(t.cloneNode(!0),null)})),this._Promise.resolve(t).then(function(){o.insertBefore(a,null),s.add("plat-listview-group",o)}).then(null,function(t){e._log.debug(e.type+" error: "+t)})},i.prototype._addGroups=function(t,e,i){for(var s=this,n=e,r=+(e+t),o=[];e<r;)o.push(this._bindGroup(e++));return this._Promise.all(o).then(function(t){for(var e=t.length,r=0;r<e;++r)s._addGroup(r+n,t[r],r<i)})},i.prototype._addGroup=function(e,i,s){var n,r,o=this,a=this.utils,l=this.context,h=this._groups||(this._groups={}),p=l[e],u=p.group,c=i.childNodes[1],_=c.lastElementChild,f=this.controls[e],m=h[u]={name:u,index:e,element:c,itemContainer:_,control:f,itemCount:0,addQueue:[],animationQueue:[]};if(f.dispose=function(){t.prototype.dispose.call(o),delete h[u]},f.observe(function(t,e){var i=t.group;if(i!==u&&a.isObject(t)){var s=h[u];delete h[u],s.name=i,h[i]=s,u=i,n(),r(),n=f.observe(o._childContextChanged.bind(o,u),"items"),r=f.observeArray(o._executeChildEvent.bind(o,u),"items")}}),n=f.observe(this._childContextChanged.bind(this,u),"items"),r=f.observeArray(this._executeChildEvent.bind(this,u),"items"),this._createItems(0,(p.items||[]).length,m,0),s){var v=this._defaultGroup.animationQueue,g={animation:this._animator.enter(i,d,this._container).then(function(){var t=v.indexOf(g);t>-1&&v.splice(t,1),a.requestAnimationFrame(o._setGroupContainerPadding.bind(o,c))}),op:null};v.push(g)}else this._container.insertBefore(i,null),a.requestAnimationFrame(this._setGroupContainerPadding.bind(this,c))},i.prototype._bindGroup=function(t){return this.bindableTemplates.bind(r+"-group",t,this._getAliases(this.context,t))},i.prototype._createItems=function(t,e,i,s){var n=this,r=this.utils,o=i||this._defaultGroup,l=o.control,h=this._isVertical,p=this===l;if(p&&this._isGrouped)this._headerTemplatePromise.then(function(){n._addGroups(e,t,s)}).then(null,function(t){n._log.debug(n.type+" error: "+t)});else{var u,d=o.addQueue,c=function(){var t=d.indexOf(u);-1!==t&&d.splice(t,1),p||(o.element.removeAttribute(a),h||p||!n._isGrouped||r.requestAnimationFrame(n._setGroupContainerWidth.bind(n,o.itemContainer)))},_=function(t){n._log.debug(n.type+" error: "+(r.isString(t.message)?t.message:t))};if(r.isFunction(this._templateSelector)){var f=[];o.itemCount+=e;for(var m=0;m<e;++m,++t)f.push(this._renderUsingFunction(t,o));var v=this.itemsLoaded=this._Promise.all(f).then(function(t){for(var e=t.length,i=0;i<e;++i)n._appendRenderedItem(t[i],o,i<s)}).then(c,_);d.push(v)}else{var g=this._itemTemplate;r.isUndefined(this.bindableTemplates.templates[g])||(this._disposeFromIndex(t,o),o.itemCount+=e,u=this._addItems(t,e,o,s).then(c,_),d.push(u))}}},i.prototype._addItems=function(t,e,i,s){var n,r,o=this,a=i||this._defaultGroup,l=a.control,h=a.itemContainer,p=+(t+e),u=[],d=this._itemTemplate,c=l.bindableTemplates,_=t;for(this===l?(n="",r=this.context):(n="items.",r=l.context.items);t<p;)u.push(c.bind(d,n+t,this._getAliases(r,t++)));return u.length>0&&(this.itemsLoaded=this._Promise.all(u).then(function(t){if(s>0)for(var e=t.length,i=0;i<e;++i)i<s?o._appendAnimatedItem(t[i],a):h.insertBefore(t[i],null);else o._appendItems(t,h);o._updateResource(_-1,l),o.utils.isFunction(o.__resolveFn)&&(o.__resolveFn(),o.__resolveFn=o.__rejectFn=null)}).catch(function(t){o.utils.postpone(function(){o._log.debug(t)})})),this.itemsLoaded},i.prototype._renderUsingFunction=function(t,e){var i,s,n,r=this,o=this._Promise,a=this.utils,l=e||this._defaultGroup,h=l.control;return this===h?(i=t,s=this.context):(i="items."+t,s=h.context.items,n=l.name),o.resolve(this._templateSelectorPromise).then(function(){return r._templateSelectorPromise=o.resolve(r._templateSelector(s[t],t,n))}).then(function(e){var n=h.bindableTemplates,o=n.templates,p=h.controls,u=r._normalizeTemplateName(e),d=l.name,c=r._templateSelectorKeys[d],_=t<p.length;if(a.isUndefined(c)&&(c=r._templateSelectorKeys[d]={}),!a.isUndefined(o[u])){if(_){if(u===c[t])return;return c[t]=u,n.replace(t,u,i,r._getAliases(s,t))}return c[t]=u,n.bind(u,i,r._getAliases(s,t))}r._log.debug(r.type+' template "'+e+'" was not found.'),_&&r._TemplateControlFactory.dispose(p[t])})},i.prototype._appendRenderedItem=function(t,e,i){var s=this.utils,n=e||this._defaultGroup;if(!s.isNull(t)&&!s.isArray(t)){if(!0===i){var r=n.animationQueue,o={animation:this._animator.enter(t,d,n.itemContainer).then(function(){var t=r.indexOf(o);-1!==t&&r.splice(t,1)}),op:null};r.push(o)}else n.itemContainer.insertBefore(t,null);s.isFunction(this.__resolveFn)&&(this.__resolveFn(),this.__resolveFn=null)}},i.prototype._updateResource=function(t,e){var i=e.controls;t<0||t>=i.length||i[t].resources.add(this._getAliases(this===e?this.context:e.context.items,t))},i.prototype._getAliases=function(t,e){var i=0==(1&e),s={},n=this._aliases,r="literal";return s[n.index]={value:e,type:r},s[n.even]={value:i,type:r},s[n.odd]={value:!i,type:r},s[n.first]={value:0===e,type:r},s[n.last]={value:e===t.length-1,type:r},s},i.prototype._appendItems=function(t,e){this.dom.appendChildren(t,e)},i.prototype._appendAnimatedItem=function(t,e){if(this.utils.isNode(t)){var i=e.animationQueue,s={animation:this._animator.enter(t,d,e.itemContainer).then(function(){var t=i.indexOf(s);-1!==t&&i.splice(t,1)}),op:null};i.push(s)}},i.prototype._removeItems=function(t,e,i){for(var s=this._TemplateControlFactory.dispose,n=i.control,r=n.controls,o=t+e,l=o>t;o-- >t;)s(r[o]);this._updateResource(r.length-1,n),this!==n&&(0===r.length?i.element.setAttribute(a,""):l&&this._isGrouped&&!this._isVertical&&this.utils.requestAnimationFrame(this._setGroupContainerWidth.bind(this,i.itemContainer)))},i.prototype._disposeFromIndex=function(t,e){for(var i=(e||this._defaultGroup).control,s=i.controls,n=this._TemplateControlFactory.dispose,r=s.length,o=r>t;r-- >t;)n(s[r]);this!==i&&(0===s.length?e.element.setAttribute(a,""):o&&this._isGrouped&&!this._isVertical&&this.utils.requestAnimationFrame(this._setGroupContainerWidth.bind(this,e.itemContainer)))},i.prototype._determineLoading=function(t,e){var i=this,s=this.findProperty(t)||{};if(this.utils.isFunction(s.value)){this._requestItems=s.value.bind(s.control);var n;switch(this._loading){case"infinite":var o,l=f;o=this.addEventListener(this._scrollContainer,"scroll",function(){i._scrollReady&&(i._scrollReady=!1,l=i.utils.requestAnimationFrame(function(){i._scrollReady=!0,i._onScroll()}))},!1),this._removeScroll=function(){i._scrollReady=!1,l(),o()},e&&((n=this._loadingProgressRing=this._document.createElement("div")).className="plat-infinite",n.insertBefore(this._generateProgressRing(),null)),this.itemsLoaded.then(this._onScroll.bind(this));break;case"incremental":(n=this._loadingProgressRing=this._document.createElement("div")).className="plat-incremental",n.setAttribute(a,""),n.insertBefore(this._generateProgressRing(),null),this.element.insertBefore(n,null)}}else this._log.debug(r+' onItemsRequested function "'+t+'" was not found.')},i.prototype._onScroll=function(){var t=this._scrollContainer,e=this._scrollPosition,i=this._isVertical?t.scrollTop+t.offsetHeight:t.scrollLeft+t.offsetWidth;e>i?this._scrollPosition=i:e+5>i||(this._scrollPosition=i,this._handleScroll())},i.prototype._handleScroll=function(){var t=this,e=this._scrollContainer,i=.8*(this._isVertical?e.scrollHeight:e.scrollWidth);if(0!==i&&this._scrollPosition>=i){var s=this.utils,n=this._requestItems();if(!1===n)this._removeScroll();else if(s.isPromise(n)){var r=this._loadingProgressRing,o=!s.isNull(r),a=this._container;this._scrollReady=!1,o&&s.requestAnimationFrame(function(){a.insertBefore(r,null)}),n.then(function(e){o&&s.requestAnimationFrame(function(){a.removeChild(r)}),!1!==e&&(t._scrollReady=!0)})}else s.postpone(function(){t.itemsLoaded.then(function(){t._scrollReady&&t._handleScroll()})})}},i.prototype._initializeRefresh=function(t){var e=this.findProperty(t)||{};if(this.utils.isFunction(e.value)){this._refresh=e.value.bind(e.control);var i=this._refreshProgressRing=this._document.createElement("div");i.className="plat-refresh",i.setAttribute(a,""),i.insertBefore(this._generateProgressRing(),null),this.element.insertBefore(i,null)}else this._log.debug(r+' onRefresh function "'+t+'" was not found.')},i.prototype._initializeTracking=function(t,e){if(t||e){this._setTransform();var i,s;this._isVertical?(i="$trackdown",s="$trackup"):(i="$trackright",s="$trackleft");var n,r,o=this._viewport;this.addEventListener(o,"$touchstart",this._touchStart,!1),t&&(n=this._touchEndLoad,r=this._trackLoad,this.addEventListener(o,"$touchend",n,!1),this.addEventListener(o,"$trackend",n,!1),this.addEventListener(o,"$touchcancel",n,!1),this.addEventListener(o,i,r,!1),this.addEventListener(o,s,r,!1)),e&&(n=this._touchEndRefresh,r=this._trackRefresh,this.addEventListener(o,"$touchend",n,!1),this.addEventListener(o,"$trackend",n,!1),this.addEventListener(o,"$touchcancel",n,!1),this.addEventListener(o,i,r,!1),this.addEventListener(o,s,r,!1))}},i.prototype._touchStart=function(t){var e=this;0===this._touchState&&(!this._isVertical&&Math.ceil(t.offsetY)>=this._viewport.offsetHeight-20||(this._touchState=1,this._lastTouch={x:t.clientX,y:t.clientY},this.utils.isNull(this._touchAnimationThenable)?this._touchState=2:this._touchAnimationThenable.cancel().then(function(){e._touchAnimationThenable=null,e._touchState=2})))},i.prototype._touchEndLoad=function(t){var e=this._isLoading;if(this._isLoading=!1,e){var i,s,n=this._scrollContainer;this._isVertical?(i=n.scrollTop+n.offsetHeight,s=n.scrollHeight):(i=n.scrollLeft+n.offsetWidth,s=n.scrollWidth),i+1<s?this._touchState=0:this._touchEnd(t,!1)}else this._isRefreshing||(this._touchState=0)},i.prototype._touchEndRefresh=function(t){var e=this._isRefreshing;this._isRefreshing=!1,e?(this._isVertical?this._scrollContainer.scrollTop:this._scrollContainer.scrollLeft)>0?this._touchState=0:this._touchEnd(t,!0):this._isLoading||(this._touchState=0)},i.prototype._touchEnd=function(t,e){var i=this,s=this._touchState,n=this._hasMoved;if(this._hasMoved=!1,!(s<2)&&n){var r,o={},l=this.dom,h=this._viewport,p=e?this._refreshProgressRing:this._loadingProgressRing,d=3===s;if(d){r=this._isVertical?"translate3d(0,"+(e?p.offsetHeight:-p.offsetHeight)+"px,0)":"translate3d("+(e?p.offsetWidth:-p.offsetWidth)+"px,0,0)"}else r=this._preTransform;o[this._transform]=r,this._touchAnimationThenable=this._animator.animate(h,u,{properties:o}).then(function(){return i._touchState=4,i._hasMoved=!1,i._touchAnimationThenable=null,d?i._Promise.resolve(e?i._refresh():i._requestItems()):(l.removeClass(h,"plat-manipulation-prep"),p.setAttribute(a,""),i._Promise.resolve())}).then(function(){if(d)return l.removeClass(p,"plat-play"),o[i._transform]=i._preTransform,i._touchAnimationThenable=i._animator.animate(h,u,{properties:o}).then(function(){i._touchState=0,i._touchAnimationThenable=null,l.removeClass(h,"plat-manipulation-prep"),p.setAttribute(a,"")});i._touchState=0}).then(null,function(t){i._touchState=0,i._log.debug(i.type+" error: "+t)})}},i.prototype._trackLoad=function(t){if(!this._isRefreshing){if(!this._isLoading){var e=this._scrollContainer,i=void 0,s=void 0;if(this._isVertical){if("up"!==t.direction.y)return;i=e.scrollTop+e.offsetHeight,s=e.scrollHeight}else{if("left"!==t.direction.x)return;i=e.scrollLeft+e.offsetWidth,s=e.scrollWidth}if(i+1<s)return;this._isLoading=!0}this._track(t,!1)}},i.prototype._trackRefresh=function(t){if(!this._isLoading){if(!this._isRefreshing){if(this._isVertical){if("down"!==t.direction.y||this._scrollContainer.scrollTop>0)return}else if("right"!==t.direction.x||this._scrollContainer.scrollLeft>0)return;this._isRefreshing=!0}this._track(t,!0)}},i.prototype._track=function(t,e){var i=this,s=this._touchState;if(2===s||3===s){var n=this._calculateTranslation(t,e);this.utils.requestAnimationFrame(function(){i._viewport.style[i._transform]=n})}},i.prototype._calculateTranslation=function(t,e){var i,s,n=this._isVertical,r=e?this._refreshProgressRing:this._loadingProgressRing;return n?(i=t.clientY-this._lastTouch.y,s=r.offsetHeight):(i=t.clientX-this._lastTouch.x,s=r.offsetWidth),e&&i<0||!e&&i>0?i=0:this._hasMoved?Math.abs(i)>=s?this._touchState<3&&(this._touchState=3,this.dom.addClass(r,"plat-play")):3===this._touchState&&(this._touchState=2,this.dom.removeClass(r,"plat-play")):(this._hasMoved=!0,this.dom.addClass(this._viewport,"plat-manipulation-prep"),r.removeAttribute(a)),n?"translate3d(0,"+i+"px,0)":"translate3d("+i+"px,0,0)"},i.prototype._setTransform=function(){var t=this._viewport.style,e=this.utils.isUndefined,i=this._compat.vendorPrefix;e(this._preTransform=t[i.lowerCase+"Transform"])?e(this._preTransform=t[i.upperCase+"Transform"])?(this._preTransform=t.transform,this._transform="transform"):this._transform=i.upperCase+"Transform":this._transform=i.lowerCase+"Transform"},i.prototype._parseInnerTemplate=function(t,e){for(var i,s,n,r=this._templates,o=Array.prototype.slice,a=this.dom.appendChildren,l=this._document,h=!this.utils.isNull(e),p=o.call(this.innerTemplate.childNodes);p.length>0;)(i=p.pop()).nodeType===Node.ELEMENT_NODE&&(s=this._normalizeTemplateName(i.nodeName),h&&s===e?(n=l.createElement("div")).className="plat-header":n=l.createDocumentFragment(),a(i.childNodes,n),r[s]=n)},i.prototype._executeEvent=function(t){var e="_"+t[0].type;this.utils.isFunction(this[e])&&this[e](t)},i.prototype._executeChildEvent=function(t,e){var i=this.utils,s="_"+e[0].type;if(i.isFunction(this[s])){var n=this._groups[t];if(i.isNull(n))return;this[s](e,n)}},i.prototype._push=function(t,e){var i=t[0],s=i.addedCount;this._createItems(i.index,s,e,this._animate?s:0)},i.prototype._pop=function(t,e){var i=this,s=e||this._defaultGroup,n=s.addQueue,r=t[0],o=r.object.length;if(0!==r.removed.length){var a=r.object.length;s.itemCount>0&&s.itemCount--,this._Promise.all(n).then(function(){i._animate?i._animateItems(o,1,"plat-leave",s,"leave",!1).then(function(){i._removeItems(a,1,s)}):i._removeItems(a,1,s)})}},i.prototype._unshift=function(t,e){if(this.utils.isFunction(this._templateSelector))this.rerender(e);else{var i=e||this._defaultGroup,s=t[0],n=s.addedCount;if(this._animate){var r=i.animationQueue,o=r.length;this._animateItems(0,n,d,i,null,o>0&&"clone"===r[o-1].op)}this._createItems(s.object.length-n,n,i,0)}},i.prototype._shift=function(t,e){var i=this,s=e||this._defaultGroup,n=s.addQueue,r=t[0];if(0!==r.removed.length){this._animate&&0===n.length&&(n=n.concat([this._animateItems(0,1,"plat-leave",s,"clone",!0)]));var o=r.object.length;s.itemCount>0&&s.itemCount--,this._Promise.all(n).then(function(){i._removeItems(o,1,s)})}},i.prototype._splice=function(t,e){var i=this,s=this.utils,n=t[0],r=e||this._defaultGroup,o=n.addedCount,a=r.itemCount,l=(r.control,r.addQueue),h=this._animate;if(s.isNull(o)){h&&this._cancelCurrentAnimations();var p=n.object.length,u=a-p;if(p>a){if(s.isFunction(this._templateSelector))return void(s.isNull(n.index)?this.rerender(r):this.render(n.index,o,r));this._createItems(a,-u,r,0)}else a>p&&(r.itemCount>=u?r.itemCount-=u:r.itemCount=0,this._Promise.all(l).then(function(){i._removeItems(a-u,u,r)}))}else{var c=n.removed.length,_=r.animationQueue;if(o>c){var f=o-c,m=void 0;if(s.isFunction(this._templateSelector))return void(s.isNull(n.index)?this.rerender(r):this.render(n.index,o,r));if(h){m=o;var v=_.length,g=n.index;a<o-g&&(m=a-g),this._animateItems(g,m,d,r,null,v>0&&"clone"===_[v-1].op),m=o-m}else m=0;this._createItems(n.object.length-f,f,r,m)}else if(c>o){var y=o>0;h&&!y&&0===l.length&&(l=l.concat([this._animateItems(n.index,c,"plat-leave",r,"clone",!0)]));var b=c-o;r.itemCount>=b?r.itemCount-=b:r.itemCount=0,this._Promise.all(l).then(function(){if(h&&y){var t=_.length;i._animateItems(n.index,o,d,r,null,t>0&&"clone"===_[t-1].op)}i._removeItems(a-b,b,r)})}}},i.prototype._animateItems=function(t,e,i,s,n,r){switch(n){case"clone":return this._handleClonedContainerAnimation(this._getAnimatedNodes(t,e,s),i,s,!0===r);case"leave":return this._handleLeave(this._getAnimatedNodes(t,e,s),i,s);default:return this._handleSimpleAnimation(this._getAnimatedNodes(t,e,s),i,s,!0===r)}},i.prototype._getAnimatedNodes=function(t,e,i){if(this._isGrouped&&i===this._defaultGroup){var s=3*t;return Array.prototype.slice.call(i.itemContainer.childNodes,s,3*e+s)}var n=this.utils.isNode,r=Array.prototype.slice.call(i.itemContainer.childNodes),o=t+e-1,a=i.control.controls;a.length<=o&&(o=a.length-1);var l=a[t].startNode,h=a[o].endNode;if(!n(l)||!n(h))return[];var p=r.indexOf(l),u=r.indexOf(h);return-1===p||-1===u?[]:r.slice(p,u+1)},i.prototype._handleSimpleAnimation=function(t,e,i,s){if(0===t.length)return this._Promise.resolve();i.itemContainer;var n,r=i.animationQueue,o=this._animator.create(t,e),a=o.current.then(function(){var t=r.indexOf(n);-1!==t&&r.splice(t,1)}),l=function(){return o.previous.then(function(){a.start()}),a};if(n={animation:a,op:null},s&&r.length>0){var h=this._cancelCurrentAnimations().then(l);return r.push(n),h}return r.push(n),l()},i.prototype._handleLeave=function(t,e,i){if(0===t.length)return this._Promise.resolve();i.itemContainer;var s,n=i.animationQueue,r=this._animator.leave(t,e).then(function(){var t=n.indexOf(s);-1!==t&&n.splice(t,1)});return s={animation:r,op:"leave"},n.push(s),r},i.prototype._handleClonedContainerAnimation=function(t,e,i,s){if(0===t.length)return this._Promise.resolve();var n,r,o=i.itemContainer,a=o.cloneNode(!0),l=i.animationQueue,h=this.utils.isNull,p=this._animator.create(t,e),u=p.current.then(function(){var t=l.indexOf(r);t>-1&&l.splice(t,1),h(n)||n.replaceChild(o,a)}),d=function(){return n=o.parentNode,h(n)||u.isCanceled()?u:(n.replaceChild(a,o),p.previous.then(function(){u.start()}),u)};if(r={animation:u,op:"clone"},s&&l.length>0){var c=this._cancelCurrentAnimations().then(d);return l.push(r),c}return l.push(r),d()},i.prototype._cancelCurrentAnimations=function(t){for(var e=(t||this._defaultGroup).animationQueue,i=[],s=e.length,n=0;n<s;++n)i.push(e[n].animation.cancel());return this._Promise.all(i)},i.prototype._normalizeTemplateName=function(t){if(this.utils.isString(t))return t.toLowerCase().replace(this._nodeNormalizeRegex,"")},i.prototype._generateProgressRing=function(){var t=this._document,e=t.createElement("div"),i=t.createElement("div");return e.className="plat-listview-ring plat-ring plat-ring-0",i.className="plat-animated-ring",e.insertBefore(i,null),e},i.prototype._validateOrientation=function(t){if(this.utils.isUndefined(t))return"vertical";var e;return"vertical"===t?e=t:"horizontal"===t?(e=t,this._isVertical=!1):(this._log.debug('Invalid orientation "'+t+'" for '+this.type+'. Defaulting to "vertical."'),e="vertical"),e},i.prototype._setContainerHeight=function(){if(!this._isVertical&&this._isGrouped){var t=this.element,e=t.offsetHeight;e?((e-=this._getScrollBarWidth())<0&&(e=0),this._container.style.height=e+"px"):this._addVisibilityListener(this._setContainerHeight.bind(this),t)}},i.prototype._setGroupContainerWidth=function(t){var e=t.scrollWidth;e?t.parentElement.style.width=e+"px":this._addVisibilityListener(this._setGroupContainerWidth.bind(this,t),t)},i.prototype._setGroupContainerPadding=function(t){if(t.offsetHeight){var e=t.firstElementChild,i=e.offsetHeight;i?t.style.paddingTop=i+"px":this._addVisibilityListener(this._setGroupContainerPadding.bind(this,t),e)}else this._addVisibilityListener(this._setGroupContainerPadding.bind(this,t),t)},i.prototype._getScrollBarWidth=function(){var t=this._document,e=t.body,i=t.createElement("div"),s=t.createElement("div"),n=i.style,r=s.style;n.width=n.height=r.height="100px",r.width="50px",r.position="absolute",r.top=r.left="0px",r.visibility=r.overflow="hidden",s.insertBefore(i,null),e.insertBefore(s,null);var o=i.offsetHeight;r.overflow="scroll";var a=i.offsetHeight;return o===a&&(a=s.clientHeight),e.removeChild(s),o-a},i.prototype._addVisibilityListener=function(t,e){var i,s=this,n=this._visibilityRemoveListeners;i=this.dom.whenVisible(this.utils.requestAnimationFrame.bind(this,function(){t();var e=n.indexOf(i);-1!==e&&n.splice(e,1),0===n.length&&s.element.removeAttribute("plat-hidden")}),e),0===n.length&&this.element.setAttribute("plat-hidden",""),n.push(i)},i._inject={_document:"$Document",_window:"$Window",_compat:"$Compat",_animator:"$Animator",_Promise:"$Promise",_TemplateControlFactory:"$TemplateControlFactory"},i}(plat.ui.TemplateControl);t.Listview=L,plat.register.control(r,L);var k=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateString='<div class="plat-navbar-left">\n    <div class="plat-navbar-items" plat-control="'+l+'" plat-context="left">\n        <div class="plat-navbar-item" plat-control="'+h+'" plat-options="{ html: content, compile: true }" plat-tap="leftAction(@index)"></div>\n    </div>\n</div>\n<div class="plat-navbar-center">\n    <div class="plat-navbar-items" plat-control="'+l+'" plat-context="center">\n        <div class="plat-navbar-item" plat-control="'+h+'" plat-options="{ html: content, compile: true }" plat-tap="centerAction(@index)"></div>\n    </div>\n</div>\n<div class="plat-navbar-right">\n    <div class="plat-navbar-items" plat-control="'+l+'" plat-context="right">\n        <div class="plat-navbar-item" plat-control="'+h+'" plat-options="{ html: content, compile: true }" plat-tap="rightAction(@index)"></div>\n    </div>\n</div>\n',e.context={left:[{content:"",action:f}],center:[{content:"",action:f}],right:[{content:"",action:f}]},e.hasOwnContext=!0,e._overrides={left:!1,center:!1,right:!1},e}return __extends(e,t),e.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,o+" "+(t||""))},e.prototype.initialize=function(){this.setClasses()},e.prototype.setTemplate=function(){var t=this.utils.isNull,e=this.innerTemplate;if(!t(e))for(var i,s,n=this._document,r=this._overrides,a=Array.prototype.slice,l=this.dom.appendChildren,h=a.call(e.childNodes),p=this.element,u=a.call(p.children);h.length>0;)if((i=h.shift()).nodeType===Node.ELEMENT_NODE)switch(i.nodeName.toLowerCase()){case"left":r.left=!0,(s=n.createElement("div")).className=o+"-left",s.setAttribute("plat-context","left"),p.replaceChild(l(a.call(i.childNodes),s),u[0]);break;case"center":r.center=!0,(s=n.createElement("div")).className=o+"-center",s.setAttribute("plat-context","center"),p.replaceChild(l(a.call(i.childNodes),s),u[1]);break;case"right":r.right=!0,(s=n.createElement("div")).className=o+"-right",s.setAttribute("plat-context","right"),p.replaceChild(l(a.call(i.childNodes),s),u[2])}},e.prototype.loaded=function(){var t=(this.options||{}).value||{},e=this.utils.isString(t.position)&&"bottom"===t.position.toLowerCase()?"-bottom":"-top";this.dom.addClass(this.element,o+e)},e.prototype.setLeft=function(t){this._setComponent("left",t)},e.prototype.setCenter=function(t){this._setComponent("center",t)},e.prototype.setRight=function(t){this._setComponent("right",t)},e.prototype.leftAction=function(t,e){this._executeAction(e,"left",t)},e.prototype.centerAction=function(t,e){this._executeAction(e,"center",t)},e.prototype.rightAction=function(t,e){this._executeAction(e,"right",t)},e.prototype._setComponent=function(t,e){var i=this.context;if(!this.utils.isArray(e)){if(this._overrides[t])return this._parseComponent(e),void(i[t]=e);e=[e]}for(var s=e.length;s-- >0;)this._parseComponent(e[s],i[t][s]);i[t]=e},e.prototype._parseComponent=function(t,e){var i,s,n,r,o=this.utils,a=o.isObject,l=a(e);if(l&&o.isUndefined(t.content)&&(t.content=e.content),o.isFunction(t.action)||(t.action=l?e.action:f),i=t.customActions,a(i))for(r=(s=Object.keys(i)).length;r-- >0;)this[n=s[r]]=i[n]},e.prototype._executeAction=function(t,e,i){var s=this.utils,n=this.context[e];s.isArray(n)&&!s.isNull(i)&&(n=n[i]),s.isFunction(n.action)?n.action(t):this._log.debug("An action function is not defined for the component "+n+".")},e._inject={_document:"$Document"},e}(plat.ui.TemplateControl);t.Navbar=k,plat.register.control(o,k,null,!0);var O=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateString='<div plat-control="'+s+'" class="plat-image-ring"></div>\n',e._isBackground=!1,e._img=e._document.createElement("img"),e}return __extends(e,t),e.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,"plat-image "+(t||""))},e.prototype.initialize=function(){this.setClasses()},e.prototype.loaded=function(){var t,e=this.element,i=this.utils,s=i.isString,n=i.isObject,r=this.attributes,o=this.options;if(s(t=r.platSrc))r.observe(this._setSrc,"platSrc");else{if(!s(t=r.src))return;r.observe(this._setSrc,"src")}n(o)&&n(o.value)&&(this._isBackground=!0===o.value.isBackground),this._isBackground&&this.dom.addClass(e,"plat-background"),this._loader=e.firstElementChild,this._NodeManagerStatic.hasMarkup(t)||this._setSrc(t)},e.prototype._setSrc=function(t,e){var i=this,s=this._img,n=this.element,r=this.dom,o=this._loader;r.addClass(s,"plat-load-image"),s.src=t,s.onload=function(){i.utils.requestAnimationFrame(function(){if(r.removeClass(n,"plat-image-error"),i._isBackground)return n.style.backgroundImage='url("'+t+'")',n.contains(s)&&n.removeChild(s),void(n.contains(o)&&n.removeChild(o));r.removeClass(s,"plat-load-image"),n.contains(o)&&n.removeChild(o)})},s.onerror=function(){i.utils.requestAnimationFrame(function(){r.addClass(n,"plat-image-error"),n.contains(s)&&n.removeChild(s),n.contains(o)&&n.removeChild(o)})},n.insertBefore(o,null),n.insertBefore(s,null)},e._inject={_compat:"$Compat",_document:"$Document",_NodeManagerStatic:"$NodeManagerStatic"},e}(plat.ui.TemplateControl);t.Image=O,plat.register.control("plat-image",O)}(platui||(platui={})),module.exports=platui;