"use strict";var platui,__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function s(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}}();!function(t){var e="$Promise",i="$Compat",s="$Window",n="$Document",o="$Animator",r="$DomEventInstance",a="$TemplateControlFactory",l="plat",h=l+"-",u=h+"button",p=h+"checkbox",d=h+"drawer",_=d+"-controller",c=h+"modal",f=h+"progress",m=h+"ring",v=h+"radio",g=h+"toggle",y=h+"slider",b=h+"range",C=h+"select",x=h+"input",T=h+"file",w=h+"carousel",E=h+"listview",P=h+"navbar",N=h+"image",S=h+"hide",A=h+"hidden",I=h+"context",L=h+"foreach",k=h+"html",O=l+"Checked",V=l+"Bind",z=l+"Src",F={index:"index",even:"even",odd:"odd",first:"first",last:"last",group:"group"},R=h+"transition",B=h+"enter",M=h+"leave",j="$tap",K="$touchstart",D="$touchend",q="$touchcancel",U="$swipe",G="$track",W="$trackend",H="__plat-button-",Y="__plat-radio-",X="__platDrawerControllerFetch",Q="__platDrawerFound",$="-reversed",J={right:"left",left:"right",up:"down",down:"up"},Z=function(t){return t.preventDefault(),!1},tt=function(){};"undefined"!=typeof window&&(void 0===window.platui&&(window.platui=t),void 0===window.module&&(window.module={}));var et=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.replaceWith="button",e._isSelected=!1,e}return __extends(e,t),e.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,u+" "+(t||""))},e.prototype.initialize=function(){this.setClasses()},e.prototype.loaded=function(){var t=this.element,e=((this.options||{}).value||{}).group,i=this.utils.isString;i(e)?(this._group=e,this.dom.hasClass(t,h+"selected")&&this._onTap(),this._addEventListeners()):i(e=this.attributes[V])&&(this._group=e,this.dom.hasClass(t,h+"selected")&&this._onTap(),this._addEventListeners())},e.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty)},e.prototype._setBoundProperty=function(t,e,i,s){this.utils.isString(t)&&t===this.element.textContent&&this._onTap()},e.prototype._addEventListeners=function(){var t=this;this.addEventListener(this.element,j,this._onTap,!1),this.on(H+this._group,function(){t._isSelected&&(t.dom.removeClass(t.element,h+"selected"),t._isSelected=!1)})},e.prototype._onTap=function(){if(!this._isSelected){var t=this.element;this.dom.addClass(t,h+"selected"),this.dispatchEvent(H+this._group,plat.events.EventManager.DIRECT),this._isSelected=!0,this.inputChanged(t.hasAttribute("value")?t.getAttribute("value").trim():t.textContent.trim())}},e._inject={_document:n},e}(plat.ui.BindControl);t.Button=et,plat.register.control(u,et);var it=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateString='<div class="plat-toggle-container">\n    <div class="plat-knob"></div>\n</div>\n',e.isActive=!1,e._targetType="slide",e}return __extends(e,t),e.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,g+" "+(t||""))},e.prototype.initialize=function(){this.setClasses()},e.prototype.setTemplate=function(){var t=this.utils.isNull,e=this.innerTemplate;if(!t(e)){var i=this._document.createElement("span");this.dom.appendChildren(e.childNodes,i),this.element.insertBefore(i,null)}},e.prototype.loaded=function(){var t=this.element;this._targetElement=t.firstElementChild,this.addEventListener(t,j,this._onTap),this._convertChecked()},e.prototype.toggle=function(){this._toggle(!0)},e.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty)},e.prototype._setBoundProperty=function(t,e,i,s){t!==e&&(!0===s&&this.utils.isNull(t)?this.inputChanged(this.isActive):!!t!==this.isActive&&this._toggle(s))},e.prototype._convertChecked=function(){var t=this.element;this.utils.isNull(this.attributes[O])?t.hasAttribute("checked")&&this._convertAttribute(!0):(this._convertAttribute(this.attributes[O]),this.attributes.observe(this._convertAttribute,O))},e.prototype._convertAttribute=function(t,e){var i=this.utils;if(i.isBoolean(t))return this._setBoundProperty(t,e,null,!0);i.isString(t)&&this._setBoundProperty("true"===t,"true"===e,null,!0)},e.prototype._onTap=function(t){this.element.hasAttribute("disabled")||(this._toggle(!0),this._trigger("change"))},e.prototype._trigger=function(t){var e=plat.acquire(r);e.initialize(this.element,t),e.trigger()},e.prototype._toggle=function(t){var e=this.isActive,i=!e,s=this.element;this._activate(this._targetElement||(this._targetElement=s.firstElementChild)),this.isActive=s.checked=i,i?s.setAttribute("checked","checked"):s.removeAttribute("checked"),!0===t&&this.inputChanged(i,e)},e.prototype._activate=function(t){this.dom.toggleClass(t,h+this._targetType)},e._inject={_document:n},e}(plat.ui.BindControl);t.Toggle=it,plat.register.control(g,it);var st=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateString='<div class="plat-checkbox-container">\n    <span class="plat-mark"></span>\n</div>\n',e._targetTypeSet=!1,e}return __extends(e,t),e.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,p+" "+(t||""))},e.prototype.loaded=function(){t.prototype.loaded.call(this);var e=(this.options||{}).value||{},i=this._targetType;switch((this._targetType=e.mark||"check").toLowerCase()){case"check":case"x":break;default:this._log.debug("Invalid mark option specified for "+this.type+". Defaulting to checkmark."),this._targetType="check"}if(this._targetTypeSet){var s=this._targetElement;this.dom.removeClass(s,i),this._activate(s)}this._targetTypeSet=!0},e.prototype._activate=function(t){this._targetTypeSet?this.dom.toggleClass(t,h+this._targetType):this._targetTypeSet=!0},e}(it);t.Checkbox=st,plat.register.control(p,st);var nt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateString='<div class="plat-radio-container">\n    <div class="plat-mark"></div>\n</div>\n',e.groupName="",e._targetType="bullet",e._targetTypeSet=!0,e}return __extends(e,t),e.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,v+" "+(t||""))},e.prototype.loaded=function(){var t=this.element;this._targetElement=t.firstElementChild,this.addEventListener(t,j,this._onTap),t.hasAttribute("name")?this.groupName=t.getAttribute("name"):this.utils.isNull(this.attributes[V])||(this.groupName=this.attributes[V]),this._convertChecked()},e.prototype.inputChanged=function(e,i){this.isActive&&t.prototype.inputChanged.call(this,this._getValue())},e.prototype._setBoundProperty=function(t,e,i,s){var n=this.utils;if(t!==e)if(!0===s&&n.isNull(t))this.inputChanged();else{var o=this._getValue(),r=t===o,a=this.isActive;if(r){if(a)return}else if(n.isNull(t)){if(!a)return}else{var l=n.isFunction(t.toString)?t.toString():Object.prototype.toString.call(t);if(a){if(l===o)return}else if(l!==o)return}this._toggle(s)}},e.prototype._onTap=function(e){this.isActive||t.prototype._onTap.call(this,e)},e.prototype._toggle=function(e){var i=this;if(t.prototype._toggle.call(this,e),this.utils.isFunction(this._removeListener)&&(this._removeListener(),this._removeListener=null),this.isActive){var s=this.groupName;this.dispatchEvent(Y+s,plat.events.EventManager.DIRECT);var n=this._removeListener=this.on(Y+s,function(){i._toggle(),n()})}},e.prototype._convertAttribute=function(t,e){var i=this.utils;i.isBoolean(t)?t&&this._setBoundProperty(this._getValue(),null,null,!0):i.isString(t)&&"true"===t&&this._setBoundProperty(this._getValue(),null,null,!0)},e.prototype._getValue=function(){var t=this.element;return t.hasAttribute("value")?t.getAttribute("value").trim():t.textContent.trim()},e}(st);t.Radio=nt,plat.register.control(v,nt);var ot=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateString='<div class="plat-animated-ring"></div>',e}return __extends(e,t),e.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,m+" "+(t||""))},e.prototype.initialize=function(){this.setClasses()},e.prototype.loaded=function(){var t=this.options,e=this.utils,i=e.isObject,s=0;i(t)&&i(t.value)&&(s=t.value.style,e.isNumber(s)||(s=0)),this.dom.addClass(this.element,m+"-"+s),0!==s&&this._addAnimatedElements(s)},e.prototype._addAnimatedElements=function(t){for(var e,i=plat.acquire(n),s=i.createDocumentFragment(),o=2===t?12:4,r=0;r<o;++r)(e=i.createElement("div")).className="plat-animated-child plat-animated-child-"+r,s.insertBefore(e,null);this.element.firstElementChild.insertBefore(s,null)},e}(plat.ui.TemplateControl);t.ProgressRing=ot,plat.register.control(m,ot);var rt=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateString='<div class="plat-progress-container">\n    <div class="plat-animated-bar"></div>\n</div>\n',e._removeVisibilityListener=tt,e}return __extends(i,t),i.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,f+" "+(t||""))},i.prototype.initialize=function(){this.setClasses()},i.prototype.loaded=function(){var t=this;this._barElement=this.element.firstElementChild.firstElementChild,this.addEventListener(this._window,"resize",function(){t.setProgress(t.context)}),this.setProgress(this.context)},i.prototype.dispose=function(){this._removeVisibilityListener()},i.prototype.contextChanged=function(){this.setProgress(this.context)},i.prototype.setProgress=function(t){var e=this;return new this._Promise(function(i,s){if(!e.utils.isNumber(t)||t>1||t<0){var n='The value of a "'+e.type+'" control must be a number between 0 and 1.';return e._log.debug(n),void s(n)}var o=e._barElement,r=o.parentElement.clientWidth;if(!r)return e._removeVisibilityListener(),void(e._removeVisibilityListener=e.dom.whenVisible(function(){e.setProgress(t).then(i)},e.element));e._animator.animate(o,R,{properties:{width:Math.ceil(r*t)+"px"}}).then(function(){i()})})},i._inject={_window:s,_Promise:e,_animator:o},i}(plat.ui.TemplateControl);t.ProgressBar=rt,plat.register.control(f,rt);var at=function(t){function i(){var e=t.call(this)||this;return e._controllers=[],e._isInitialized=!1,e._preInitializedValue=!1,e.__state=!1,e.__nextState=!1,e.ready=e._Promise.resolve(),e}return __extends(i,t),i.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,d+" "+(t||""))},i.prototype.initialize=function(){this.setClasses()},i.prototype.setTemplate=function(){this.innerTemplate=this.dom.appendChildren(this.element.childNodes)},i.prototype.loaded=function(){var t=this,e=this.element,i=this.utils,s=(this.options||{}).value||{},n=this._currentPosition=s.position||"left",o=s.id||"",r=s.templateUrl,a=!0===s.elastic;e.setAttribute(S,""),this.dom.addClass(e,h+n),i.isString(r)?plat.ui.TemplateControl.determineTemplate(this,r).then(function(e){t.innerTemplate=e,t._initializeEvents(o,n,a)}):this._initializeEvents(o,n,a)},i.prototype.open=function(){var t=this._controllers[0];return this.utils.isNull(t)?(this._log.debug("No controller, such as a "+_+", found for the "+this.type+" attempting to open."),this._Promise.resolve()):t.open()},i.prototype.close=function(){var t=this._controllers[0];return this.utils.isNull(t)?(this._log.debug("No controller, such as a "+_+", found for the "+this.type+" attempting to close."),this._Promise.resolve()):t.close()},i.prototype.toggle=function(){var t=this._controllers[0];return this.utils.isNull(t)?(this._log.debug("No controller, such as a "+_+", found for the "+this.type+" attempting to toggle."),this._Promise.resolve()):t.toggle()},i.prototype.isOpen=function(){var t=this._controllers[0];return this.utils.isNull(t)?(this._log.debug("No controller, such as a "+_+", found for the "+this.type+" attempting to check if open."),!1):t.isOpen()},i.prototype.bindTemplate=function(t,e){var i=this,s=this.bindableTemplates;return s.add(t,e),s.bind(t).then(function(t){var e=i.element;i.dom.clearNode(e),e.appendChild(t)}).catch(function(t){i._log.debug("Error binding template for "+i.type+": "+t)})},i.prototype.controllerCount=function(){return this._controllers.length},i.prototype.spliceController=function(t){var e=this._controllers,i=e.indexOf(t);-1!==i&&(this.__state=this.__nextState=e[i].isOpen(),e.splice(i,1))},i.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty)},i.prototype._setBoundProperty=function(t,e,i,s){var n=this.utils,o=this._controllers[0];if(!0===s&&n.isNull(t))this.inputChanged(!n.isNull(o)&&o.isOpen());else{var r=!!t;if(r!==t&&this.inputChanged(r),this._isInitialized)if(n.isNull(o))this.__nextState=r;else if(r){if(o.isOpen())return;o.open()}else o.isOpen()&&o.close();else this._preInitializedValue=r}},i.prototype._changeDirection=function(t){if(!this.utils.isNull(t)&&t!==this._currentPosition){var e=this.dom,i=this.element;e.removeClass(i,h+this._currentPosition),e.addClass(i,h+t),this._currentPosition=t}},i.prototype._initializeEvents=function(t,e,i){var s=this,n=this.utils,o=this.innerTemplate;this.on(X+"_"+t,function(r,a){var l=a.control;n.isNull(l)||(n.isString(a.position)&&(e=a.position,s._changeDirection(e)),s._controllers.unshift(l),a.received||s.ready.then(function(){s.dispatchEvent(Q+"_"+t,plat.events.EventManager.DIRECT,{control:s,received:!0,position:e,template:n.isNode(o)?o.cloneNode(!0):null,elastic:i,state:s.__state,nextState:s.__nextState})}),s._isInitialized=!0,a.useContext?s._checkPreInit():s.bindTemplate("drawer",o.cloneNode(!0)).then(function(){s._checkPreInit()}))}),this.dispatchEvent(Q+"_"+t,plat.events.EventManager.DIRECT,{control:this,received:!1,position:e,template:n.isNode(o)?o.cloneNode(!0):null,elastic:i,state:this.__state,nextState:this.__nextState})},i.prototype._checkPreInit=function(){var t=this;if(this._preInitializedValue){var e=this.utils;e.postpone(function(){var i=t._controllers[0];e.isNull(i)||i.open()})}},i._inject={_Promise:e},i}(plat.ui.BindControl);t.Drawer=at,plat.register.control(d,at);var lt=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e._hasSwiped=!1,e._hasTapped=!1,e._isOpen=!1,e._touchState=0,e._isVertical=!1,e._removeClickEaterListener=tt,e._toggleDelay=tt,e._isInitialized=!1,e}return __extends(r,t),r.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,_+" "+(t||""))},r.prototype.initialize=function(){this.dom.addClass(this.element,_)},r.prototype.loaded=function(){var t=(this.options||{}).value||{},e=t.position,i=t.id||"";this._type=t.type||"tap track",this._isElastic=t.elastic,this._useContext=!0===t.useContext,this._templateUrl=t.templateUrl,this._initializeEvents(i,e)},r.prototype.dispose=function(){var e=this;t.prototype.dispose.call(this);var i=this._drawer;this.utils.isNull(i)||(i.controllerCount()>1?i.spliceController(this):this._isOpen?i.ready=this.close().then(function(){i.spliceController(e),i.controllerCount()>0||e._cleanRootElement()}):i.ready.then(function(){i.spliceController(e),i.controllerCount()>0||e._cleanRootElement()}))},r.prototype.open=function(){var t=this,e=!this._isOpen,i=this.utils;this._toggleDelay();var s=new this._Promise(function(e){t._toggleDelay=i.requestAnimationFrame(function(){t._open().then(e)})});if(e){var n=this._drawer;this.inputChanged(!0),i.isNull(n)||n.inputChanged(!0)}return s},r.prototype.close=function(){var t=this,e=this._isOpen,i=this.utils;this._toggleDelay();var s=new this._Promise(function(e){t._toggleDelay=i.requestAnimationFrame(function(){t._close().then(e)})});if(e){var n=this._drawer;this.inputChanged(!1),i.isNull(n)||(n.ready=s,n.inputChanged(!1))}return s},r.prototype.toggle=function(){return this._isOpen?this.close():this.open()},r.prototype.isOpen=function(){return this._isOpen},r.prototype.bindTemplate=function(t,e){var i=this,s=this.bindableTemplates;return s.add(t,e),s.bind(t).then(function(t){var e=i._drawerElement;i.dom.clearNode(e),e.appendChild(t)}).catch(function(t){i._log.debug("Error binding template for "+i.type+": "+t)})},r.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty)},r.prototype._setBoundProperty=function(t,e,i,s){var n=this,o=this.utils;if(!0===s&&o.isNull(t))this.inputChanged(this._isOpen);else{var r=!!t;if(r!==t&&this.inputChanged(r),this._isInitialized){if(r){if(this._isOpen)return;this._toggleDelay(),this._toggleDelay=o.requestAnimationFrame(function(){n._open()})}else if(this._isOpen){this._toggleDelay();var a=new this._Promise(function(t){n._toggleDelay=o.requestAnimationFrame(function(){t(n._close())})}),l=this._drawer;o.isNull(l)||(l.ready=a)}}else this._preInitializedValue=r}},r.prototype._open=function(t){var e,i=this,s=this._rootElement,n=this.utils.isNode,o=this._isOpen,r=this._getOffset();if(o&&!t||!(r&&n(s)&&n(this._drawerElement)))return this._Promise.resolve();switch(this._position){case"left":e="translate3d("+r+"px,0,0)";break;case"right":e="translate3d("+-r+"px,0,0)";break;case"top":e="translate3d(0,"+r+"px,0)";break;case"bottom":e="translate3d(0,"+-r+"px,0)";break;default:return this._Promise.resolve()}this._isOpen=!0,this.dom.addClass(s,this._directionalTransitionPrep),o||this._addClickEater();var a={};return a[this._transform]=e,this._animationThenable=this._animator.animate(s,R,{properties:a}).then(function(){i._animationThenable=null,i._drawerElement.removeEventListener("selectstart",Z,!1)})},r.prototype._close=function(t){var e=this,i=this._rootElement,s=this.utils.isNode;if(!this._isOpen&&!t||!s(i)||!s(this._drawerElement))return this._Promise.resolve();this._isOpen=!1;var n={};return n[this._transform]=this._preTransform,this._animationThenable=this._animator.animate(i,R,{properties:n}).then(function(){e._animationThenable=null,e._drawerElement.removeEventListener("selectstart",Z,!1),e._isOpen||e._touchState<2&&e._removeClickEater()})},r.prototype._reset=function(){if(this._isOpen)return this._open(!0);var t=this._close(!0),e=this._drawer;return this.utils.isNull(e)||(e.ready=t),t},r.prototype._addClickEater=function(){var t=this,e=this._clickEater,i=e.style,s=this._rootElement;if(!s.contains(e)){i.top=s.scrollTop+"px",i.left=s.scrollLeft+"px",s.insertBefore(e,null),this.dom.addClass(this._rootElement,this._directionalTransitionPrep);var n,o=tt,r=!0;n=this.addEventListener(s,"scroll",function(){r&&(r=!1,o=t.utils.requestAnimationFrame(function(){var t=e.style;r=!0,t.top=s.scrollTop+"px",t.left=s.scrollLeft+"px"}))}),this._removeClickEaterListener=function(){o(),n()}}},r.prototype._removeClickEater=function(){var t=this._rootElement,e=this._clickEater;this._removeClickEaterListener(),t.contains(e)&&t.removeChild(e),this.dom.removeClass(t,this._directionalTransitionPrep)},r.prototype._addSwipeToggle=function(){var t=this,e=this.element,i=this.addEventListener(e,U+J[this._position],function(){t._hasSwiped=!0,t.open()},!1),s=this.addEventListener(e,U+this._position,function(){t._hasSwiped=!0,t.close()},!1);this._removeSwipeToggle=function(){i(),s()}},r.prototype._addSwipeClose=function(){var t=this;this._openSwipeRemover=this.addEventListener(this._clickEater,U+this._position,function(){t._hasSwiped=!0,t.close()},!1)},r.prototype._addTapToggle=function(){var t=this;this._removeTap=this.addEventListener(this.element,j,function(){t._hasTapped=!0,t.toggle()},!1)},r.prototype._addTapClose=function(){var t=this;this._openTapRemover=this.addEventListener(this._clickEater,j,function(){t._hasTapped=!0,t.close()},!1)},r.prototype._addEventListeners=function(){var t=this.element,e=this.utils.isNull,i=this._type.split(" "),s=this._position;if((this._isTap=-1!==i.indexOf("tap"))&&(this._addTapToggle(),this._addTapClose()),(this._isSwipe=-1!==i.indexOf("swipe"))&&(this._addSwipeToggle(),this._addSwipeClose()),this._isTrack=-1!==i.indexOf("track")){var n=this._track,o=void 0,r=this._clickEater;switch(s){case"left":case"right":o=s;break;case"top":o="up";break;case"bottom":o="down";break;default:return}var a=G+J[o],l=G+o,h=this.addEventListener(t,a,n,!1),u=this.addEventListener(t,l,n,!1),p=this.addEventListener(r,a,n,!1),d=this.addEventListener(r,l,n,!1);if(this._removeTrack=function(){h(),u()},this._openTrackRemover=function(){p(),d()},e(this._lastTouch)){var _=this._touchStart,c=this._touchEnd;this._lastTouch={x:0,y:0},this.addEventListener(t,K,_,!1),this.addEventListener(t,D,c,!1),this.addEventListener(t,W,c,!1),this.addEventListener(r,K,_,!1),this.addEventListener(r,W,c,!1),this.addEventListener(r,D,c,!1)}}this.addEventListener(this._window,"resize",this._handleResize,!1)},r.prototype._handleResize=function(){if(this._isOpen){var t=this.utils.isNull,e=this._rootElement,i=this._drawer;this._isOpen=!1,this.inputChanged(!1),t(e)||(e.style[this._transform]=this._preTransform),t(i)||(i.inputChanged(!1),this._drawerElement.removeEventListener("selectstart",Z,!1)),this._touchState<2&&this._removeClickEater()}},r.prototype._removeEventListeners=function(){var t=this.utils.isFunction;this._isTap&&(t(this._removeTap)&&(this._removeTap(),this._removeTap=null),t(this._openTapRemover)&&(this._openTapRemover(),this._openTapRemover=null)),this._isTrack&&(t(this._removeTrack)&&(this._removeTrack(),this._removeTrack=null),t(this._openTrackRemover)&&(this._openTrackRemover(),this._openTrackRemover=null)),this._isSwipe&&(t(this._removeSwipeToggle)&&(this._removeSwipeToggle(),this._removeSwipeToggle=null),t(this._openSwipeRemover)&&(this._openSwipeRemover(),this._openSwipeRemover=null))},r.prototype._touchStart=function(t){1!==this._touchState&&(this._touchState=1,this._lastTouch={x:t.clientX,y:t.clientY})},r.prototype._touchEnd=function(t){var e=0===this._touchState,i=this._hasSwiped,s=this._hasTapped;if(this._hasSwiped=this._hasTapped=!1,this._touchState=0,!(s||e||i)){var n=this._isVertical?t.clientY-this._lastTouch.y:t.clientX-this._lastTouch.x;if(this._isRightDirection(n)){var o=this._getOffset();if(!o)return;if(Math.abs(n)>Math.ceil(o/2))return void this.toggle();this._reset()}else this._isElastic?Math.abs(n)>0&&this._reset():this._isOpen||this._removeClickEater()}},r.prototype._track=function(t){var e=this,i=this._touchState;0!==i&&(1===i&&(this.utils.isNull(this._animationThenable)?(this._addClickEater(),this.utils.isNode(this._drawerElement)&&this._drawerElement.addEventListener("selectstart",Z,!1)):this._animationThenable.cancel().then(function(){e._addClickEater(),e.utils.isNode(e._drawerElement)&&e._drawerElement.addEventListener("selectstart",Z,!1)}),this._touchState=2),this.utils.requestAnimationFrame(function(){e._rootElement.style[e._transform]=e._calculateTranslation(t)}))},r.prototype._isRightDirection=function(t){switch(this._position){case"left":case"top":return this._isOpen?t<0:t>0;case"right":case"bottom":return this._isOpen?t>0:t<0;default:return!1}},r.prototype._calculateTranslation=function(t){var e,i=this._getOffset();if(!i)return this._preTransform;switch(this._position){case"left":return 0===(e=this._checkElasticity(i,t.clientX-this._lastTouch.x))?this._preTransform:"translate3d("+e+"px,0,0)";case"right":return 0===(e=this._checkElasticity(i,this._lastTouch.x-t.clientX))?this._preTransform:"translate3d("+-e+"px,0,0)";case"top":return 0===(e=this._checkElasticity(i,t.clientY-this._lastTouch.y))?this._preTransform:"translate3d(0,"+e+"px,0)";case"bottom":return 0===(e=this._checkElasticity(i,this._lastTouch.y-t.clientY))?this._preTransform:"translate3d(0,"+-e+"px,0)";default:return this._preTransform}},r.prototype._checkElasticity=function(t,e){var i=this._isOpen?t+e:e;return this._isElastic?i:(i<0?i=0:i>t&&(i=t),i)},r.prototype._initializeEvents=function(t,e){var i=this,s=this._useContext,n=this.on(Q+"_"+t,function(o,r){n();var a=i.utils,l=a.isString,h=a.isUndefined,u=(i._drawer=r.control)||{},p=i._drawerElement=u.element;if(!l(e)){if(!l(r.position))return void i._log.debug('"position" is incorrectly defined for a control such as "'+d+'" or "'+i.type+'." Please ensure it is a string.');e=r.position}if(p.removeAttribute(S),i._controllerIsValid(e.toLowerCase())){i._setTransform(),i._addEventListeners(),h(i._isElastic)&&(i._isElastic=!0===r.elastic),r.received||i.dispatchEvent(X+"_"+t,plat.events.EventManager.DIRECT,{control:i,received:!0,position:e,useContext:s}),r.state?(i._isOpen=!0,i.inputChanged(!0),!r.nextState&&a.isNull(i._preInitializedValue)&&(i._preInitializedValue=!1)):r.nextState&&a.isNull(i._preInitializedValue)&&(i._preInitializedValue=!0);var _=function(){i._isInitialized=!0,i._checkPreInit()};s?i._determineTemplate(r.template).then(_):_()}});this.dispatchEvent(X+"_"+t,plat.events.EventManager.DIRECT,{control:this,received:!1,position:e,useContext:s})},r.prototype._checkPreInit=function(){var t=this,e=this._preInitializedValue,i=this.utils,s=i.isNull;if(!s(e)){var n=this._isOpen;if(!(n&&e||!n&&!e))if(this._toggleDelay(),e)this._toggleDelay=i.requestAnimationFrame(this._open.bind(this));else{var o=new this._Promise(function(e){t._toggleDelay=i.requestAnimationFrame(function(){e(t._close())})}),r=this._drawer;s(r)||(r.ready=o)}}},r.prototype._determineTemplate=function(t){var e=this,i=this.utils;return i.isString(this._templateUrl)?plat.ui.TemplateControl.determineTemplate(this,this._templateUrl).then(function(t){return e.bindTemplate("drawer",t)}):i.isNode(t)?this.bindTemplate("drawer",t):this._Promise.resolve()},r.prototype._setTransform=function(){var t=this._rootElement.style,e=this.utils.isUndefined,i=this._compat.vendorPrefix;e(this._preTransform=t[i.lowerCase+"Transform"])?e(this._preTransform=t[i.upperCase+"Transform"])?this._transform="transform":this._transform=i.upperCase+"Transform":this._transform=i.lowerCase+"Transform"},r.prototype._controllerIsValid=function(t){var e=this.utils.isNull;if(e(this._drawerElement))return this._log.debug('Could not find a corresponding control such as "'+d+'" for this "'+this.type+'."'),!1;switch(t){case"top":case"bottom":this._isVertical=!0;case"left":case"right":this._position=t;break;default:return this._log.debug('Incorrect position: "'+t+'" defined for the a control such as a "'+d+'", or "'+this.type+'."'),!1}var i=this._rootElement=this._getRootElement();if(e(i))return this._log.debug('Cannot have a "'+this.type+'" in a hierarchy above the corresponding control such as "'+d+'."'),!1;var s=this.dom;return s.addClass(i,d+"-root"),s.addClass(this.element,this._isVertical?h+"vertical":h+"horizontal"),this._directionalTransitionPrep=d+"-transition-"+t,this._clickEater=this._document.createElement("div"),this._clickEater.className=h+"clickeater",this._styleRootElement(),!0},r.prototype._getRootElement=function(){var t=this._drawer,e=this.utils;if(!e.isNull(t.storedProperties))return t.storedProperties.rootElement;for(var i,s=e.isNode,n=this.root,o=e.isObject(n)&&s(n.element)?n.element:this.element,r=this._drawerElement;s(i=o.parentElement)&&!i.contains(r);)o=i;return o},r.prototype._styleRootElement=function(){var t=this._window,e=this.utils,i=this._drawer,s=this._rootElement,n=s.parentElement,o=t.getComputedStyle(s),r=s.style,a=o.position,l=Number(o.zIndex),h={rootElement:s};if("static"===a&&(h.position=r.position,r.position="relative"),(!e.isNumber(l)||l<1)&&(h.zIndex=r.zIndex,r.zIndex="1"),e.isNode(n)){var u=t.getComputedStyle(n);if("hidden"!==u.overflow){var p=void 0,d=void 0;if(this._isVertical?(d="overflowY",p=u.overflowY):(d="overflowX",p=u.overflowX),"hidden"!==p){var _=n.style;h.parentOverflow={key:d,value:_[d]},_[d]="hidden"}}}i.storedProperties=h},r.prototype._cleanRootElement=function(){var t=this.utils,e=t.isObject,i=t.isNode,s=this._rootElement,n=this._drawer;if(i(s)&&(this.dom.removeClass(s,d+"-root "+this._directionalTransitionPrep),!t.isNull(n))){var o=n.storedProperties;if(e(o)){var r=s.style,a=s.parentElement,l=o.parentOverflow;r.position=o.position,r.zIndex=o.zIndex,e(l)&&i(a)&&(a.style[l.key]=l.value),delete n.storedProperties,this._drawerElement.setAttribute(S,"")}}},r.prototype._getOffset=function(){return this._isVertical?this._drawerElement.offsetHeight:this._drawerElement.offsetWidth},r._inject={_document:n,_window:s,_compat:i,_animator:o,_Promise:e},r}(plat.ui.BindControl);t.DrawerController=lt,plat.register.control(_,lt);var ht=function(t){function o(){var e=t.call(this)||this;e._isVisible=!1,e._scrollRemover=tt,e._presenceRemover=tt,e._scrollTop=0,e._transitionHash={up:!0,down:!0,left:!0,right:!0,fade:!0},e.__templateString='<div class="plat-modal-container"></div>\n',e.templateString=e.__templateString;var i=e._Promise;return e._showingPromise=i.resolve(),e._hidingPromise=i.resolve(),e.modalLoaded=new i(function(t,i){e.__resolveFn=t,e.__rejectFn=i}).catch(tt),e}return __extends(o,t),o.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,c+" "+S+" "+(t||""))},o.prototype.initialize=function(){var t=this.options||(this.options={}),e=t.value||(t.value={});this.templateUrl=e.templateUrl||this.templateUrl,this.setClasses()},o.prototype.setTemplate=function(){if(this.templateString!==this.__templateString||this.utils.isString(this.templateUrl)){var t=this.dom,e=t.serializeHtml(this.__templateString),i=this.element;this._container=e.firstChild;this.innerTemplate=t.appendChildren(i.childNodes),i.appendChild(e)}},o.prototype.loaded=function(){var t=this.options.value.transition,e=this.element;if(this._container=this._container||e.firstElementChild,this._presenceRemover=this.dom.whenPresent(this._injectElement.bind(this),e),this.utils.isString(t)&&"none"!==t){this._transitionHash[t]||this._log.debug('Custom transition: "'+t+'" defined for "'+this.type+'." Please ensure the transition is defined to avoid errors.');var i=this._compat.animationEvents;if(this.utils.isNull(i))return this._log.debug("This browser does not support CSS3 animations."),void this.dom.addClass(this._container,h+"no-transition");this._transitionEnd=i.$transitionEnd,this.dom.addClass(this._container,h+t+" "+h+"modal-transition")}else this.dom.addClass(this._container,h+"no-transition")},o.prototype.dispose=function(){t.prototype.dispose.call(this),this._scrollRemover(),this._presenceRemover(),this.utils.isFunction(this.__rejectFn)&&(this.__rejectFn(),this.__rejectFn=this.__resolveFn=null),this._hidingPromise=this._showingPromise=null},o.prototype.show=function(){var t=!this._isVisible,e=this._show();return t&&this.inputChanged(!0),e},o.prototype.hide=function(){var t=this.isVisible,e=this._hide();return t&&this.inputChanged(!1),e},o.prototype.toggle=function(){return this._isVisible?this.hide():this.show()},o.prototype.isVisible=function(){return this._isVisible},o.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty)},o.prototype._setBoundProperty=function(t,e,i,s){var n=this.utils;if(!0===s&&n.isNull(t))this.inputChanged(this._isVisible);else if(n.isBoolean(t)){if(t){if(this._isVisible)return;return void this._show()}this._isVisible&&this._hide()}else this._log.debug("Attempting to show or hide a "+this.type+" with a bound value that is something other than a boolean.")},o.prototype._show=function(){var t=this,e=this.dom,i=this.utils;return i.isNull(this.innerTemplate)?this._isVisible?this._showingPromise:(this._isVisible=!0,this._showingPromise=new this._Promise(function(s){i.requestAnimationFrame(function(){t._alignModal(),e.removeClass(t.element,S),i.defer(function(){i.requestAnimationFrame(function(){e.addClass(t._container,h+"activate"),s()})},20)})})):this._bindInnerTemplate()},o.prototype._alignModal=function(t){var e=this,i=this.utils,s=i.isNull,n=this._document,o=n.documentElement,r=(s(o)||!o.scrollTop?n.body:o).scrollTop;this._scrollTop!==r&&(s(t)?(this.element.style.top=r+"px",this._scrollRemover=this.addEventListener(this._window,"scroll",this._alignModal,!1)):i.requestAnimationFrame(function(){e.element.style.top=r+"px"}),this._scrollTop=r)},o.prototype._hide=function(){var t,e=this,i=this.dom,s=this.utils;return this._isVisible?(this._scrollRemover(),this._scrollRemover=tt,this._isVisible=!1,s.isString(this._transitionEnd)?(t=this._addHideOnTransitionEnd(),s.requestAnimationFrame(function(){i.removeClass(e._container,h+"activate")})):t=new this._Promise(function(t){s.requestAnimationFrame(function(){i.addClass(e.element,S),i.removeClass(e._container,h+"activate"),t()})}),this._hidingPromise=t):this._hidingPromise},o.prototype._bindInnerTemplate=function(){var t=this,e=this.innerTemplate;return this.innerTemplate=null,this.bindableTemplates.once(e).then(function(e){return t._container.insertBefore(e,null),t.utils.isFunction(t.__resolveFn)&&(t.__resolveFn(),t.__resolveFn=t.__rejectFn=null),t._show()})},o.prototype._injectElement=function(){var t=this.element,e=t.parentElement,i=this._document.body;this.utils.isNode(e)&&e!==i&&i.insertBefore(t,null)},o.prototype._addHideOnTransitionEnd=function(){var t=this;return new this._Promise(function(e){var i=t.element,s=t.addEventListener(i,t._transitionEnd,function(){s(),t.dom.addClass(i,S),e()},!1)})},o._inject={_window:s,_document:n,_compat:i,_Promise:e},o}(plat.ui.BindControl);t.Modal=ht,plat.register.control(c,ht);var ut=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateString='<div class="plat-slider-container">\n    <div class="plat-slider-track">\n        <div class="plat-knob"></div>\n    </div>\n</div>\n',e._isVertical=!1,e._knobOffset=0,e._touchState=0,e._removeVisibilityListener=tt,e}return __extends(i,t),i.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,y+" "+(t||""))},i.prototype.initialize=function(){this.setClasses()},i.prototype.loaded=function(){var t=this.element,e=this._slider=t.firstElementChild.firstElementChild,i=this.utils.isNumber,s=(this.options||{}).value||{},n=Number(s.value),o=s.min,r=s.max,a=s.step,l=this._reversed=!0===s.reverse,u=this.min=i(o)?Math.floor(o):0,p=this.max=i(r)?Math.ceil(r):100,d=i(n)?Math.round(n):u,_=h+this._validateOrientation(s.orientation);this._knob=e.firstElementChild,l&&(_+=$),this.dom.addClass(t,_),this.value=u,this._step=i(a)&&a>0?Math.round(a):1,u>=p&&(this._log.debug('"'+this.type+"'s\" min is greater than or equal to its max. Setting max to min + 1."),this.max=u+1),this._setLength(),this._initializeEvents(),this.setValue(d)},i.prototype.dispose=function(){t.prototype.dispose.call(this),this._removeVisibilityListener(),this._sliderVisible=null},i.prototype.setValue=function(t){this._setValue(t,!0)},i.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty)},i.prototype._setBoundProperty=function(t,e,i,s){this._setValue(t,!1)},i.prototype._setValue=function(t,e){var i=this.utils;if(1!==this._touchState){if(i.isNull(t)&&(t=this.min,e=!0),!i.isNumber(t)){var s=Number(t);if(!i.isNumber(s))return void this._log.warn(this.type+" has its value bound to a property that cannot be interpreted as a Number.");t=s,e=!0}this._setValueProperty(t,!0,e)}else this._log.debug("Cannot set the value of "+this.type+" while the user is manipulating it.")},i.prototype._initializeEvents=function(){var t,e,i=this,s=this.element,n=this._track,o=this._touchEnd;this._isVertical?(t=G+"down",e=G+"up"):(t=G+"right",e=G+"left"),this.addEventListener(s,K,this._touchStart,!1),this.addEventListener(s,t,n,!1),this.addEventListener(s,e,n,!1),this.addEventListener(s,D,o,!1),this.addEventListener(s,W,o,!1),this.addEventListener(this._window,"resize",function(){i.utils.isNull(i._sliderVisible)&&(i._setLength(),i._setKnob())},!1)},i.prototype._touchStart=function(t){var e=this;if(1!==this._touchState){this._touchState=1,this._lastTouch={x:t.clientX,y:t.clientY,value:this.value};var i,s=t.target;if(s!==this._knob)i=this._isVertical?s===this.element?this._reversed?t.offsetY-this._sliderOffset:this._maxOffset-(t.offsetY-this._sliderOffset):s===this._slider?this._reversed?t.offsetY:this._knobOffset-t.offsetY:this._reversed?t.offsetY:this._maxOffset-t.offsetY:s===this.element?this._reversed?this._maxOffset-(t.offsetX-this._sliderOffset):t.offsetX-this._sliderOffset:s===this._slider?this._reversed?this._knobOffset-t.offsetX:t.offsetX:this._reversed?this._maxOffset-t.offsetX:t.offsetX,this.utils.requestAnimationFrame(function(){e._knobOffset=e._setSliderProperties(i)})}},i.prototype._touchEnd=function(t){var e=this;if(1===this._touchState){this._touchState=2;var i=this._calculateOffset(t),s=this._maxOffset;this.utils.requestAnimationFrame(function(){e._touchState=0,e._lastTouch.value!==e.value&&e._trigger("change"),e._knobOffset=i<0?0:i>s?s:i})}else this._touchState=0},i.prototype._track=function(t){var e=this;0!==this._touchState&&this.utils.requestAnimationFrame(function(){e._setSliderProperties(e._calculateOffset(t))})},i.prototype._setSliderProperties=function(t){var e,i=this._maxOffset;if(t<=0){if(t=0,(e=this.min)-this.value>=0)return t}else if(t>=i){if(t=i,(e=this.max)-this.value<=0)return t}else e=this._calculateValue(t);return this._setValueProperty(e,!1,!0),this._slider.style[this._lengthProperty]=t+"px",t},i.prototype._calculateValue=function(t){var e=this._step;return this.min+Math.round(t/this._increment/e)*e},i.prototype._calculateKnobPosition=function(t){return(t-this.min)*this._increment},i.prototype._calculateOffset=function(t){return this._isVertical?this._reversed?this._knobOffset+t.clientY-this._lastTouch.y:this._knobOffset+this._lastTouch.y-t.clientY:this._reversed?this._knobOffset+this._lastTouch.x-t.clientX:this._knobOffset+t.clientX-this._lastTouch.x},i.prototype._setLength=function(){var t=this,e=this._slider.parentElement;this._isVertical?(this._lengthProperty="height",this._maxOffset=e.clientHeight,this._sliderOffset=e.offsetTop):(this._lengthProperty="width",this._maxOffset=e.clientWidth,this._sliderOffset=e.offsetLeft),this._maxOffset?this._setIncrement():this._sliderVisible=new this._Promise(function(i){t._removeVisibilityListener=t.dom.whenVisible(function(){t._sliderVisible=null,t._setLength(),i()},e)})},i.prototype._setIncrement=function(){return this._increment=this._maxOffset/(this.max-this.min)},i.prototype._setValueProperty=function(t,e,i){var s=this.value;if(t!==s){if(t>=this.max)t=this.max;else if(t<=this.min)t=this.min;else if(Math.abs(t-s)<this._step)return;this.value=this.element.value=t,e&&this._setKnob(),i&&this.inputChanged(t,s),this._trigger("input")}},i.prototype._setKnob=function(t){var e=this;this._Promise.resolve(this._sliderVisible).then(function(){var i={},s=e._calculateKnobPosition(t||e.value);s!==e._knobOffset&&(i[e._lengthProperty]=s+"px",e._animator.animate(e._slider,R,{properties:i}),e._knobOffset=s)})},i.prototype._trigger=function(t){var e=plat.acquire(r);e.initialize(this.element,t),e.trigger()},i.prototype._validateOrientation=function(t){return this.utils.isUndefined(t)?"horizontal":("horizontal"===t?e=t:"vertical"===t?(e=t,this._isVertical=!0):(this._log.debug('Invalid orientation "'+t+'" for '+this.type+'. Defaulting to "horizontal."'),e="horizontal"),e);var e},i._inject={_document:n,_window:s,_Promise:e,_animator:o},i}(plat.ui.BindControl);t.Slider=ut,plat.register.control(y,ut);var pt=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateString='<div class="plat-range-container">\n    <div class="plat-range-track">\n        <div class="plat-lower-knob"></div>\n        <div class="plat-upper-knob"></div>\n    </div>\n</div>\n',e._isVertical=!1,e._touchState=0,e._removeVisibilityListener=tt,e._forceFirstTime=!1,e}return __extends(i,t),i.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,b+" "+(t||""))},i.prototype.initialize=function(){this.setClasses()},i.prototype.loaded=function(){var t=this.element,e=this._slider=t.firstElementChild.firstElementChild,i=this.utils.isNumber,s=(this.options||{}).value||{},n=Number(s.lower),o=Number(s.upper),r=s.identifiers||{},a=s.min,l=s.max,u=s.step,p=this._reversed=!0===s.reverse,d=this.min=i(a)?Math.floor(a):0,_=this.max=i(l)?Math.ceil(l):100,c=i(n)?Math.round(n):d,f=i(o)?Math.round(o):_,m=h+this._validateOrientation(s.orientation);if(this._lowerKnob=e.firstElementChild,this._upperKnob=e.lastElementChild,this._lowerIdentifier=r.lower||"lower",this._upperIdentifier=r.upper||"upper",p){var v=this._lowerKnob;this._lowerKnob=this._upperKnob,this._upperKnob=v,m+=$}this.dom.addClass(t,m),this.lower=d,this.upper=_,this._step=i(u)&&u>0?Math.round(u):1,d>=_&&(this._log.debug('"'+this.type+"'s\" min is greater than or equal to its max. Setting max to min + 1."),this.max=d+1),this._setPositionAndLength(),this._setLowerKnobPosition(d),this._initializeEvents(),this.setLower(c),this.setUpper(f)},i.prototype.setLower=function(t){this._setLower(t,!0)},i.prototype.setUpper=function(t){this._setUpper(t,!0)},i.prototype.observeProperties=function(t){t.observeProperty(this._setLowerBoundProperty,this._lowerIdentifier),t.observeProperty(this._setUpperBoundProperty,this._upperIdentifier)},i.prototype._setLowerBoundProperty=function(t,e,i,s){this._setLower(t,!1,s)},i.prototype._setUpperBoundProperty=function(t,e,i,s){this._setUpper(t,!1,s)},i.prototype._setLower=function(t,e,i){var s=this.utils;if(2!==this._touchState){if(s.isNull(t)&&(t=this.min,!0===i?this._forceFirstTime=!0:e=!0),!s.isNumber(t)){var n=Number(t);if(!s.isNumber(n))return void this._log.warn(this.type+" has its lower value bound to a property that cannot be interpreted as a Number.");t=n,!0===i?this._forceFirstTime=!0:e=!0}this._setLowerValue(t,!0,e,!0)}else this._log.debug("Cannot set the value of the "+this.type+"'s lower knob while the user is manipulating it.")},i.prototype._setUpper=function(t,e,i){var s=this.utils;if(3!==this._touchState){if(s.isNull(t)&&(t=this.max,e=!0),!s.isNumber(t)){var n=Number(t);if(!s.isNumber(n))return void this._log.warn(this.type+" has its upper value bound to a property that cannot be interpreted as a Number.");t=n,e=!0}this._setUpperValue(t,!0,e||!0===i&&this._forceFirstTime,!0)}else this._log.debug("Cannot set the value of the "+this.type+"'s upper knob while the user is manipulating it.")},i.prototype._initializeEvents=function(){var t,e,i=this,s=this._lowerKnob,n=this._upperKnob,o=this._touchStart,r=this._touchEnd,a=this._trackLower,l=this._trackUpper;this._isVertical?(t=G+"down",e=G+"up"):(t=G+"right",e=G+"left"),this.addEventListener(s,K,o,!1),this.addEventListener(n,K,o,!1),this.addEventListener(s,t,a,!1),this.addEventListener(s,e,a,!1),this.addEventListener(n,t,l,!1),this.addEventListener(n,e,l,!1),this.addEventListener(s,D,r,!1),this.addEventListener(n,D,r,!1),this.addEventListener(s,W,r,!1),this.addEventListener(n,W,r,!1),this.addEventListener(this._window,"resize",function(){i.utils.isNull(i._rangeVisible)&&(i._setPositionAndLength(),i._setLowerKnobPosition(),i._setUpperKnobPosition())},!1)},i.prototype._touchStart=function(t){var e=this._touchState;if(1!==e&&2!==e&&3!==e){this._touchState=1;var i=t.currentTarget,s=this._lastTouch;if(this.utils.isNull(s))this.dom.addClass(i,h+"top");else if(s.target!==i){var n=this.dom;n.addClass(i,h+"top"),n.removeClass(s.target,h+"top")}this._lastTouch={x:t.clientX,y:t.clientY,value:i===this._lowerKnob?this.lower:this.upper,target:i}}},i.prototype._touchEnd=function(t){var e=this,i=this._touchState;if(0!==i&&4!==i){this._touchState=4;var s=this._lastTouch,n=t.currentTarget;this.utils.isNull(s)||s.target!==n||this.utils.requestAnimationFrame(function(){e._touchState=0;var i=n===e._lowerKnob,o=e._calculateOffset(t,i);i?s.value!==e.lower&&e._trigger("change"):s.value!==e.upper&&e._trigger("change"),e._setOffset(o,i)})}else this._touchState=0},i.prototype._setOffset=function(t,e){var i=this._maxOffset;return t<0?e?this._lowerKnobOffset=0:this._upperKnobOffset=0:t>i?e?this._lowerKnobOffset=i:this._upperKnobOffset=i:e?this._lowerKnobOffset=t:this._upperKnobOffset=t},i.prototype._trackLower=function(t){var e=this._touchState;if(2!==e)if(1===e)this._touchState=2;else if(0===e||3===e)return;var i,s=this._maxOffset,n=this._calculateOffset(t,!0);if(n<=0?((i=this.min)-this.lower>=0&&(i=null),n=0):n>=s?((i=this.max)-this.lower<=0&&(i=null),n=s):(i=this._calculateValue(n))-this.lower==0&&(i=null),n>this._upperKnobOffset)return this._positionTogether(n,i),void this._setOffset(n,!1);this._positionLower(n,i)},i.prototype._trackUpper=function(t){var e=this._touchState;if(3!==e)if(1===e)this._touchState=3;else if(0===e||2===e)return;var i,s=this._maxOffset,n=this._calculateOffset(t,!1);if(n<=0?((i=this.min)-this.upper>=0&&(i=null),n=0):n>=s?((i=this.max)-this.upper<=0&&(i=null),n=s):(i=this._calculateValue(n))-this.upper==0&&(i=null),n<this._lowerKnobOffset)return this._positionTogether(n,i),void this._setOffset(n,!0);this._positionUpper(n,i)},i.prototype._positionLower=function(t,e){var i=this;this.utils.requestAnimationFrame(function(){var s=i._slider.style;s[i._positionProperty]=t+"px",s[i._lengthProperty]=i._upperKnobOffset-t+"px",null!==e&&i._setLowerValue(e,!1,!0,!0)})},i.prototype._positionUpper=function(t,e){var i=this;this.utils.requestAnimationFrame(function(){i._slider.style[i._lengthProperty]=t-i._lowerKnobOffset+"px",null!==e&&i._setUpperValue(e,!1,!0,!0)})},i.prototype._positionTogether=function(t,e){var i=this;this.utils.requestAnimationFrame(function(){var s=i._slider.style;s[i._positionProperty]=t+"px",s[i._lengthProperty]="0px",null!==e&&(i._setLowerValue(e,!1,!1,!1),i._setUpperValue(e,!1,!0,!0))})},i.prototype._calculateValue=function(t){var e=this._step;return this.min+Math.round(t/this._increment/e)*e},i.prototype._calculateOffset=function(t,e){return(e?this._lowerKnobOffset:this._upperKnobOffset)+(this._isVertical?this._reversed?t.clientY-this._lastTouch.y:this._lastTouch.y-t.clientY:this._reversed?this._lastTouch.x-t.clientX:t.clientX-this._lastTouch.x)},i.prototype._calculateKnobPosition=function(t){return(t-this.min)*this._increment},i.prototype._setLowerValue=function(t,e,i,s){var n=this.lower;if(t!==n){if(t>=this.max)t=this.max;else if(t<=this.min)t=this.min;else if(Math.abs(t-n)<this._step)return;this.lower=t,e&&this._setLowerKnobPosition(),i&&this._fireChange(),s&&this._trigger("input")}},i.prototype._setUpperValue=function(t,e,i,s){var n=this.upper;if(t!==n){if(t>=this.max)t=this.max;else if(t<=this.min)t=this.min;else if(Math.abs(t-n)<this._step)return;this.upper=t,e&&this._setUpperKnobPosition(),i&&this._fireChange(),s&&this._trigger("input")}},i.prototype._setIncrement=function(){return this._increment=this._maxOffset/(this.max-this.min)},i.prototype._setPositionAndLength=function(){var t=this,e=this._slider.parentElement;this._isVertical?(this._lengthProperty="height",this._positionProperty=this._reversed?"top":"bottom",this._maxOffset=e.clientHeight):(this._lengthProperty="width",this._positionProperty=this._reversed?"right":"left",this._maxOffset=e.clientWidth),this._maxOffset?this._setIncrement():this._rangeVisible=new this._Promise(function(i){t._removeVisibilityListener=t.dom.whenVisible(function(){t._rangeVisible=null,t._setPositionAndLength(),i()},e)})},i.prototype._setLowerKnobPosition=function(t){var e=this;this._Promise.resolve(this._rangeVisible).then(function(){var i={},s=e._upperKnobOffset,n=e.utils.isNumber(s)?s:e._setOffset(e._calculateKnobPosition(e.upper),!1),o=e._calculateKnobPosition(t||e.lower);o!==e._lowerKnobOffset&&(i[e._positionProperty]=o+"px",i[e._lengthProperty]=n-o+"px",e._animator.animate(e._slider,R,{properties:i}),e._lowerKnobOffset=o)})},i.prototype._setUpperKnobPosition=function(t){var e=this;this._Promise.resolve(this._rangeVisible).then(function(){var i={},s=e._calculateKnobPosition(t||e.upper);s!==e._upperKnobOffset&&(i[e._lengthProperty]=s-e._lowerKnobOffset+"px",e._animator.animate(e._slider,R,{properties:i}),e._upperKnobOffset=s)})},i.prototype._fireChange=function(){var t={};t[this._lowerIdentifier]=this.lower,t[this._upperIdentifier]=this.upper,this.inputChanged(t)},i.prototype._trigger=function(t){var e=plat.acquire(r);e.initialize(this.element,t),e.trigger()},i.prototype._validateOrientation=function(t){return this.utils.isUndefined(t)?"horizontal":("horizontal"===t?e=t:"vertical"===t?(e=t,this._isVertical=!0):(this._log.debug('Invalid orientation "'+t+'" for '+this.type+'. Defaulting to "horizontal."'),e="horizontal"),e);var e},i._inject={_document:n,_window:s,_Promise:e,_animator:o},i}(plat.ui.BindControl);t.Range=pt,plat.register.control(b,pt);var dt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,C+" "+(t||""))},e.prototype.initialize=function(){t.prototype.initialize.call(this),this.setClasses()},e}(plat.ui.controls.Select);t.Select=dt,plat.register.control(C,dt);var _t=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.replaceWith="input",e.value="",e}return __extends(e,t),e.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,x+" "+(t||""))},e.prototype.initialize=function(){this.setClasses()},e.prototype.setTemplate=function(){this.dom.clearNode(this.element)},e.prototype.loaded=function(){var t=(this.options||{}).value||{},e=t.pattern,i=t.validation,s=this.utils.isString;this._type=this.attributes.type||t.type||"text",s(e)&&""!==e&&("/"===e[0]&&"/"===e[e.length-1]&&(e=e.slice(1,-1)),this._pattern=new RegExp(e)),s(i)&&""!==i&&("/"===i[0]&&"/"===i[i.length-1]&&(i=i.slice(1,-1)),this._validation=new RegExp(i)),this._initializeType()},e.prototype.validate=function(){return this._validation.test(this.element.value)},e.prototype.clear=function(){var t=this.element,e=t.value;""!==e&&(t.value=this.value="",this.inputChanged(this.value,e))},e.prototype.focus=function(){this.element.focus()},e.prototype.blur=function(){this.element.blur()},e.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty,null,!0)},e.prototype._setBoundProperty=function(t,e,i,s){var n=this.element.value;if(this.utils.isNull(t)){if(t="",!0===s)return void(this.utils.isNull(n)&&this._onInputChanged(t))}else if(t===n)return;this._onInputChanged(t)},e.prototype._initializeType=function(){var t=this._type;switch(t){case"text":this._pattern=this._pattern||/[\S\s]*/,this._validation=this._validation||this._pattern;break;case"email":this._pattern=this._pattern||/[\S\s]*/,this._validation=this._validation||this._regex.validateEmail;break;case"password":this._pattern=this._pattern||/[\S\s]*/,this._validation=this._validation||this._pattern;break;case"telephone":t="tel";case"tel":this._pattern=this._pattern||this._regex.validateTelephone,this._validation=this._validation||this._pattern;break;case"number":this._pattern=this._pattern||/^[0-9\.,]*$/,this._validation=this._validation||this._pattern,t="tel";break;case"hidden":return void this.element.setAttribute(S,"");case"radio":return void this._log.debug(t+" is not supported by "+this.type+". Please use a "+v+" instead.");case"checkbox":return void this._log.debug(t+" is not supported by "+this.type+". Please use a "+p+" instead.");case"range":return void this._log.debug(t+" is not supported by "+this.type+". Please use a "+y+" instead.");case"file":return void this._log.debug(t+" is not supported by "+this.type+". Please use a "+T+" instead.");default:this._log.debug(t+" is not yet fully supported by "+this.type+'. Defaulting to type="text".'),t="text",this._pattern=this._pattern||/[\S\s]*/,this._validation=this._validation||this._pattern}this._addTextEventListener()},e.prototype._addTextEventListener=function(){var t,e=this,i=this.element,s=this._compat,n=this.utils,o=!1,r=function(){o||e._onInput()},a=function(){n.isFunction(t)||(t=n.postpone(function(){r(),t=null}))};n.isUndefined(s.ANDROID)&&(this.addEventListener(i,"compositionstart",function(){return o=!0},!1),this.addEventListener(i,"compositionend",function(){o=!1,r()},!1)),s.hasEvent("input")?this.addEventListener(i,"input",r,!1):(this.addEventListener(i,"keydown",function(t){var s=t.keyCode;if(!(91===s||92===s||s>15&&s<28||s>32&&s<41)){var n=e._pattern,o=t.char;n.test(o)&&n.test(i.value+o)?a():t.preventDefault()}},!1),this.addEventListener(i,"cut",a,!1),this.addEventListener(i,"paste",a,!1)),this.addEventListener(i,"change",r,!1)},e.prototype._onInput=function(){var t=this.element,e=t.value,i=this._stripInput(t.value);e!==i&&(e=t.value=i),e!==this.value&&(this.value=t.value,this.inputChanged(this.value))},e.prototype._onInputChanged=function(t){var e=this.element;t=this._stripInput(t),e.value=t,this.value=e.value},e.prototype._stripInput=function(t){for(var e,i="",s=i,n=this._pattern,o=t.length,r=0;r<o;++r)e=t[r],n.test(e)&&(i+=e,n.test(i)?s=i:i=s);return i},e._inject={_compat:i,_regex:"$Regex"},e}(plat.ui.BindControl);t.Input=_t,plat.register.control(x,_t);var ct=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateString='<div class="plat-file-container">\n    <input type="file" class="plat-file-hidden" />\n    <input type="text" class="plat-file-input" plat-keydown="_onKeyDown" />\n    <button class="plat-file-button" plat-tap="_selectFiles"></button>\n</div>\n',e._removeListener=tt,e}return __extends(e,t),e.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,T+" "+(t||""))},e.prototype.initialize=function(){this.setClasses()},e.prototype.setTemplate=function(){for(var t,e,i,s=this.element,n=this._hiddenInput=s.firstElementChild.firstElementChild,o=this._visibleInput=n.nextElementSibling,r=o.nextElementSibling,a=this.attributes,l=Object.keys(a),h=l.length,u=plat.dependency.injectors.control,p=/plat-(?:control|hide|context)|class|style/,d=!1,_=this.utils,c=_.isNull,f=_.delimit,m=_.isString,v=0;v<h;++v)e=f(t=l[v],"-"),m(i=a[t])&&!p.test(e)&&c(u[e])?"id"===e?(s.removeAttribute(e),n.setAttribute(e,i)):"multiple"===e?(d=!0,n.setAttribute(e,i)):"disabled"===e?(n.setAttribute(e,i),o.setAttribute(e,i),r.setAttribute(e,i)):n.setAttribute(e,i):"plat-disabled"===e&&(n.setAttribute(e,i),o.setAttribute(e,i),r.setAttribute(e,i));if(c(this.innerTemplate))r.textContent=d?"Select files":"Select a file";else{var g=this.innerTemplate.textContent.replace(/\r|\n/g,"");_.isEmpty(g)?r.textContent=d?"Select files":"Select a file":r.textContent=g}},e.prototype.loaded=function(){var t=this._hiddenInput=this._hiddenInput||this.element.firstElementChild.firstElementChild;this._visibleInput=this._visibleInput||t.nextElementSibling,this._addChangeListener()},e.prototype.validate=function(){return!this.utils.isEmpty(this._hiddenInput.value)},e.prototype.clear=function(){var t=this._hiddenInput;if(!this.utils.isEmpty(t.value)){t.value=null;var e=this._hiddenInput=t.cloneNode(!0);this.element.firstElementChild.replaceChild(e,t),this._addChangeListener(),this._visibleInput.value="",this.inputChanged(null),this._trigger("change")}},e.prototype.click=function(){this._selectFiles()},e.prototype.value=function(){var t=this._hiddenInput,e=t.files;if(!this.utils.isNull(e))return t.multiple?Array.prototype.slice.call(e):e[0]},e.prototype.disable=function(){var t="disabled",e=this._visibleInput;this._hiddenInput.setAttribute(t,t),e.setAttribute(t,t),e.nextElementSibling.setAttribute(t,t),this.element.setAttribute(t,t)},e.prototype.enable=function(){var t="disabled",e=this._visibleInput;this._hiddenInput.removeAttribute(t),e.removeAttribute(t),e.nextElementSibling.removeAttribute(t),this.element.removeAttribute(t)},e.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty)},e.prototype._setBoundProperty=function(t,e,i,s){var n=this.utils;if(n.isFile(t)){var o=this._hiddenInput,r=o.files;n.isNull(r)||(o.multiple?(this.inputChanged(Array.prototype.slice.call(r)),this._trigger("change")):t!==r[0]&&(this.inputChanged(r[0]),this._trigger("change")))}else this.clear()},e.prototype._addChangeListener=function(){this._removeListener(),this._removeListener=this.addEventListener(this._hiddenInput,"change",this._filesSelected,!1)},e.prototype._onKeyDown=function(t){var e=t.keyCode,i=plat.controls.KeyCodes;return e===i.tab||(e!==i.backspace&&e!==i.delete||this.clear(),t.preventDefault(),!1)},e.prototype._selectFiles=function(){this._hiddenInput.click()},e.prototype._filesSelected=function(){var t=this._hiddenInput,e=this._visibleInput,i=t.files;if(this.utils.isEmpty(i))this.clear();else{if(t.multiple){for(var s=[],n=i.length,o=0;o<n;++o)s.push(i[o].name);e.value=s.join(", "),this.inputChanged(Array.prototype.slice.call(i))}else{var r=i[0];e.value=r.name,this.inputChanged(r)}this._trigger("change")}},e.prototype._trigger=function(t){var e=plat.acquire(r);e.initialize(this.element,t),e.trigger()},e._inject={_compat:i},e}(plat.ui.BindControl);t.File=ct,plat.register.control(T,ct);var ft=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateString='<div class="plat-carousel-viewport">\n    <div class="plat-carousel-container"></div>\n</div>\n',e._listeners=[],e._isVertical=!1,e._hasSwiped=!1,e._inTouch=!1,e._hasMoved=!1,e._lastTouch={x:0,y:0},e._loaded=!1,e._index=-1,e._previousIndex=-1,e._nextIndex=-1,e._currentOffset=0,e._removeInterval=tt,e._removeSuspend=tt,e._isAuto=!1,e._isPaused=!1,e._selfPause=!1,e._itemNodes=[],e._removeListeners=[],e._outerStart=!1,e._outerEnd=!1,e._goToIntervalConstant=125,e}return __extends(e,t),Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),e.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,w+" "+(t||""))},e.prototype.contextChanged=function(t,e){var i=this.utils;if(i.isFunction(this._onLoad))return i.isArray(t)?this._setListener():(this._log.debug(this.type+" context set to something other than an Array."),t=[]),this._executeEvent([{object:t,type:"splice"}]),void this._initializeIndex(0);this.loaded()},e.prototype.initialize=function(){this.setClasses()},e.prototype.setTemplate=function(){var t=this._document.createElement("div");t.className=w+"-item",t.appendChild(this.innerTemplate),this.bindableTemplates.add("item",t)},e.prototype.loaded=function(){var t=this,e=this.utils,i=this.context;if(e.isArray(i)){this._animate=!1;var s,n=(this.options||{}).value||{},o=n.index,r=e.isNumber,a=this._validateOrientation(n.orientation),l=n.interval,u=this._interval=r(l)?Math.abs(l):3e3,p=n.suspend,d=this.dom,_=this.element,c=this._viewport=_.firstElementChild;switch(n.transition){case"fade":s="fade",this._fade=1;break;case"fade-in":s="fade",this._fade=2;break;case"fade-out":s="fade",this._fade=3;break;default:s="translate",this._fade=0}this._container=c.firstElementChild,this._type=n.type||"track swipe",this._isInfinite=!0===n.infinite,this._suspend=Math.abs(r(p)?u-p:u-3e3),d.addClass(_,h+a+" "+(h+s)),this._onLoad=function(){var e=t._index;o=r(o)&&o>=0?o<i.length?o:i.length-1:null,t._index=0,d.whenVisible(function(){t._initializeIndex(null===o?e:o),t._addEventListeners(),t._loaded=!0},_)},this._init()}else this._log.warn("The context of a "+this.type+" must be an Array.")},e.prototype.goToNext=function(){return this._goToNext(!1)},e.prototype.goToPrevious=function(){return this._goToPrevious(!1)},e.prototype.goToIndex=function(t,e){return this._goToIndex(t,!1,e)},e.prototype.pause=function(){this._selfPause=!1,this._isAuto&&!this._isPaused&&(this._isPaused=!0,this._removeSuspend(),this._removeSuspend=tt,this._removeInterval(),this._removeInterval=tt)},e.prototype.resume=function(){this._isAuto&&this._isPaused&&(this._isPaused=this._selfPause=!1,this._initiateInterval())},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._listeners=[],this._removeEventListeners()},e.prototype.onInput=function(t){var e=this._listeners;return e.push(t),function(){var i=e.indexOf(t);-1!==i&&e.splice(i,1)}},e.prototype.inputChanged=function(t,e){if(t!==e)for(var i=this._listeners,s=i.length,n=0;n<s;++n)i[n](t,e)},e.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty)},e.prototype._setBoundProperty=function(t,e,i,s){var n=this.utils;if(n.isNull(t)){if(!0===s)return this._index=0,void this.inputChanged(0,t)}else if(n.isNumber(t)){if(t<0)return this._index=0,this.inputChanged(0,t),void this._initializeIndex(0)}else if(t=Number(t),!n.isNumber(t))return void this._log.warn(this.type+" has its index bound to a property that cannot be interpreted as a Number.");this._loaded?this._goToIndex(t,!0,!0===s):this._index=t},e.prototype._reset=function(){if(!this._fade){var t={};t[this._transform]=this._calculateStaticTranslation(0),this._initiateAnimation({properties:t})}},e.prototype._verifyLength=function(){var t=this.context,e=this._index;if(!this.utils.isArray(t)||0===t.length)return this.utils.isUndefined(e)||this.inputChanged(this._index=void 0,e),this._fade||(this._container.style[this._transform]=this._calculateStaticTranslation(-this._currentOffset)),this._removeEventListeners(),void this._checkArrows();var i=t.length-1;e>i?this.goToIndex(i):this._checkArrows()},e.prototype._setIndexWindow=function(){var t=this._index,e=this._itemNodes.length-1;e<0?this._previousIndex=this._nextIndex=e:t>=e?(t>e&&(t=this._index=e),this._previousIndex=t-1,this._nextIndex=this._isInfinite?0:-1):t<=0?(t<0&&(t=this._index=0),this._previousIndex=this._isInfinite?e:-1,this._nextIndex=t+1):(this._previousIndex=t-1,this._nextIndex=t+1)},e.prototype._goToNext=function(t){var e=this;return this._Promise.all(this._addQueue).then(function(){var i=!1;if(e._index>=e._itemNodes.length-1&&!(i=e._isInfinite))return e._isAuto&&!e._isPaused&&(e.pause(),e._selfPause=!0),e._Promise.resolve(!1);var s=e._getLength();return s?e._fade?e._fadeNext(t,i):e._translateNext(s,t,i):e.goToIndex(e._nextIndex,!0)})},e.prototype._goToPrevious=function(t){var e=this;return this._Promise.all(this._addQueue).then(function(){var i=!1;if(e._index<=0&&!(i=e._isInfinite))return e._Promise.resolve(!1);e._selfPause&&e.resume();var s=e._getLength();return s?e._fade?e._fadePrevious(t,i):e._translatePrevious(s,t,i):e.goToIndex(e._previousIndex,!0)})},e.prototype._goToIndex=function(t,e,i){var s=this;return this._Promise.all(this._addQueue).then(function(){var n=s._index;return s.utils.isUndefined(n)?(s._initializeIndex(0),s.inputChanged(s._index,t),s._isInfinite||(t<s.context.length-1?s._selfPause&&s.resume():s._isAuto&&!s._isPaused&&(s.pause(),s._selfPause=!0)),s._Promise.resolve(!0)):t===n?s._Promise.resolve(!1):!0===i?(s._initializeIndex(t),s.inputChanged(s._index,t),s._isInfinite||(t<s.context.length-1?s._selfPause&&s.resume():s._isAuto&&!s._isPaused&&(s.pause(),s._selfPause=!0)),s._Promise.resolve(!0)):t-n>0&&t===s._nextIndex?s._goToNext(e):t===s._previousIndex?s._goToPrevious(e):s._handleGoToIndex(t,e)})},e.prototype._handleGoToIndex=function(t,e){var i=this._index;if(t===i||t<0||t>=this.context.length)return this._Promise.resolve(!1);if(this._selfPause&&this.resume(),!this._getLength())return this._initializeIndex(t),this._Promise.resolve(!0);var s,n,o,r=this._Promise,a=this.utils.defer;t>i?(s=this._goToNext,n=t-i,this._isInfinite&&(o=this._itemNodes.length-t+i)<n&&(s=this._goToPrevious,n=o)):(s=this._goToPrevious,n=i-t,this._isInfinite&&(o=this._itemNodes.length-i+t)<n&&(s=this._goToNext,n=o)),s=s.bind(this);for(var l=[],h=this._removeListeners,u=this._goToIntervalConstant,p=0,d=function(t){var i=a(function(){var n=h.indexOf(i);-1!==n&&h.splice(n,1),t(s(e))},p+=Math.round(u/n));h.push(i)};--n>0;)l.push(new r(d));return l.push(s(e)),r.all(l).then(function(t){for(var e=!1;t.length>0&&!(e=e||t.pop()););return e})},e.prototype._translateNext=function(t,e,i){var s=this;return this._cancelCurrentAnimations().then(function(){s._outerEnd||s._initializeOuterNodes();var n={};n[s._transform]=s._calculateStaticTranslation(-t);var o,r=s._initiateAnimation({properties:n}),a=s._index;return i?s._index=o=0:o=++s._index,e||s.inputChanged(s._index,a),r.then(function(){return s._handleNext(o,t),s._checkArrows(),!0})})},e.prototype._fadeNext=function(t,e){var i=this;return this._cancelCurrentAnimations().then(function(){i._outerEnd||i._initializeOuterNodes();var s,n,o,r,a=i._index,l=i._animator,u=i.dom,p=i._container,d=Array.prototype.slice.call(p.childNodes),_=d.length,c=d[_-5],f=d[_-2],m=i._fade;return 2===m?(o=l.animate(f,R),u.addClass(c,h+"middle"),u.addClass(f,h+"top"),r=function(){u.removeClass(c,h+"top"),u.removeClass(c,h+"middle")}):3===m?(n=l.animate(c,R),u.addClass(f,h+"top"),u.toggleClass(c,h+"top "+h+"middle"),r=function(){u.removeClass(c,h+"middle")}):(n=l.animate(c,R),o=l.animate(f,R),u.toggleClass(c,h+"top "+h+"middle"),u.addClass(f,h+"top"),r=function(){u.removeClass(c,h+"middle")}),e?i._index=s=0:s=++i._index,t||i.inputChanged(i._index,a),i._nextAnimationThenable=o,i._animationThenable=n,i._Promise.all([o,n]).then(function(){return r(),i._handleNext(s,length),i._checkArrows(),!0})})},e.prototype._handleNext=function(t,e){var i=this._isInfinite,s=this._itemNodes,n=s.length,o=this.utils.isArray;if(i&&(n<3||o(this._preClonedNodes)||o(this._postClonedNodes)))this._initializeIndex(t);else{var r=this._container;this._outerStart?(i||t>1)&&(this.dom.insertBefore(s[this._previousIndex],Array.prototype.slice.call(r.childNodes,0,3)),this._fade||(r.style[this._transform]=this._calculateStaticTranslation(e),this._forceRepaint(r))):this._outerStart=!0,this._setIndexWindow(),(i||t<n-1)&&r.insertBefore(s[this._nextIndex],null)}},e.prototype._translatePrevious=function(t,e,i){var s=this;return this._cancelCurrentAnimations().then(function(){s._outerStart||s._initializeOuterNodes();var n={};n[s._transform]=s._calculateStaticTranslation(t);var o,r=s._initiateAnimation({properties:n}),a=s._index;return i?s._index=o=s._itemNodes.length-1:o=--s._index,e||s.inputChanged(s._index,a),r.then(function(){return s._handlePrevious(o,-t),s._checkArrows(),!0})})},e.prototype._fadePrevious=function(t,e){var i=this;return this._cancelCurrentAnimations().then(function(){i._outerStart||i._initializeOuterNodes();var s,n,o,r,a=i._index,l=i._animator,u=i.dom,p=i._container,d=Array.prototype.slice.call(p.childNodes),_=d[4],c=d[1],f=i._fade;return 2===f?(o=l.animate(c,R),u.addClass(_,h+"middle"),u.addClass(c,h+"top"),r=function(){u.removeClass(_,h+"top"),u.removeClass(_,h+"middle")}):3===f?(n=l.animate(_,R),u.addClass(c,h+"top"),u.toggleClass(_,h+"top "+h+"middle"),r=function(){u.removeClass(_,h+"middle")}):(n=l.animate(_,R),o=l.animate(c,R),u.toggleClass(_,h+"top "+h+"middle"),u.addClass(c,h+"top"),r=function(){u.removeClass(_,h+"middle")}),e?i._index=s=i._itemNodes.length-1:s=--i._index,t||i.inputChanged(i._index,a),i._nextAnimationThenable=o,i._animationThenable=n,i._Promise.all([o,n]).then(function(){return r(),i._handlePrevious(s,-length),i._checkArrows(),!0})})},e.prototype._handlePrevious=function(t,e){var i=this._isInfinite,s=this._itemNodes,n=s.length,o=this.utils.isArray;if(i&&(n<3||o(this._preClonedNodes)||o(this._postClonedNodes)))this._initializeIndex(t);else{var r=this._container;this._outerEnd?(i||t<n-2)&&this.dom.insertBefore(s[this._nextIndex],Array.prototype.slice.call(r.childNodes,-3)):this._outerEnd=!0,this._setIndexWindow(),(i||t>0)&&(r.insertBefore(s[this._previousIndex],r.firstChild),this._fade||(r.style[this._transform]=this._calculateStaticTranslation(e),this._forceRepaint(r)))}},e.prototype._clearInnerNodes=function(){this._removeClones(),this._outerStart=this._outerEnd=!1;var t=this._itemNodes;if(0===t.length)return!1;var e=Array.prototype.slice.call(this._container.childNodes),i=this.dom.insertBefore;switch(e.length){case 9:i(t[this._previousIndex],e.splice(0,3)),i(t[this._nextIndex],e.splice(-3,3)),i(t[this._index],e);break;case 6:var s=this._nextIndex,n=this._index;if(s<0||s===n){i(t[n],e.splice(-3,3)),i(t[0===n?this._previousIndex+1:n-1],e);break}i(t[s],e.splice(-3,3)),i(t[n],e);break;case 3:i(t[this._index],e)}return!0},e.prototype._initializeIndex=function(t){var e=this._clearInnerNodes();if(0===this._itemNodes.length?t=-1:t<0&&(t=0),this._index=t,this._setIndexWindow(),!e)return!1;var i=this._fade,s=this._itemNodes[t];if(i){var n=s.childNodes[1];this.dom.addClass(n,h+"top")}var o=this._container;return o.insertBefore(s,null),i||(o.style[this._transform]=this._calculateStaticTranslation(-this._currentOffset),this._forceRepaint(o)),this._initializeOuterNodes(),this._checkArrows(),!0},e.prototype._initializeOuterNodes=function(){var t=this._getLength();if(t){var e,i=this._itemNodes,s=this._container,n=i.length;if(n<=1){if(this._isInfinite)return void this._cloneForInfinite(-t)}else{var o=this.utils.isNode;this._outerEnd||o(e=i[this._nextIndex])&&(s.insertBefore(e,null),this._outerEnd=!0),n>2?!this._outerStart&&(this._isInfinite||this._index>0)&&o(e=i[this._previousIndex])&&(s.insertBefore(e,s.firstChild),this._fade||(s.style[this._transform]=this._calculateStaticTranslation(-t),this._forceRepaint(s)),this._outerStart=!0):this._isInfinite&&this._cloneForInfinite(-t)}}else this._outerStart=this._outerEnd=!1},e.prototype._initiateAnimation=function(t){return this._animationThenable=this._animator.animate(this._container,R,t)},e.prototype._init=function(){var t=this,e=this._addQueue,i=this.context.length;this._setAliases();var s=this._addItems(0,i,0).then(function(){var i=e.indexOf(s);-1!==i&&e.splice(i,1),t._onLoad()}).catch(function(){t._log.debug("An error occurred while processing the "+t.type+". Please ensure you're context is correct."),t._loaded=!1});e.push(s),this._setListener(),this._setTransform()},e.prototype._addEventListeners=function(){var t=this,e=this._type.split(" ");if(-1!==e.indexOf("tap")&&this._initializeTap(),-1!==e.indexOf("swipe")&&this._initializeSwipe(),-1!==e.indexOf("track")&&this._initializeTrack(),-1!==e.indexOf("auto")&&this._initializeAuto(),!this._fade){var i=!1;this.addEventListener(this._window,"resize",function(){i||(i=!0,t.utils.requestAnimationFrame(function(){i=!1;var e=t._length,s=t._getLength();s&&e!==s&&(t._isInfinite||0!==t._index)&&(t._container.style[t._transform]=t._calculateStaticTranslation(e-s))}))},!1)}},e.prototype._removeEventListeners=function(){for(var t=this._removeListeners;t.length>0;)t.pop()();this._removeInterval(),this._removeSuspend(),this._isInfinite&&this._removeClones(),this._onLoad=tt},e.prototype._cloneForInfinite=function(t){this._removeClones();var e=this.context;if(this.utils.isArray(e)&&0!==e.length){var i=this._outerStart,s=this._outerEnd;if(!i||!s){var n,o,r,a=this._container,l=this._document;s||(n=l.createComment(w+" clone: start node"),o=l.createComment(w+" clone: end node"),r=a.firstElementChild.cloneNode(!0),this._postClonedNodes=[n,r,o],a.insertBefore(n,null),a.insertBefore(r,null),a.insertBefore(o,null),this._outerEnd=!0),i||(n=l.createComment(w+" clone: start node"),o=l.createComment(w+" clone: end node"),r=a.lastElementChild.cloneNode(!0),this._preClonedNodes=[n,r,o],a.insertBefore(o,a.firstChild),a.insertBefore(r,a.firstChild),a.insertBefore(n,a.firstChild),this._outerStart=!0,this._fade||(a.style[this._transform]=this._calculateStaticTranslation(t),this._forceRepaint(a)))}}},e.prototype._removeClones=function(){var t=this._container,e=this._preClonedNodes,i=this._postClonedNodes,s=this.utils.isArray;s(e)&&(t.removeChild(e[0]),t.removeChild(e[1]),t.removeChild(e[2])),s(i)&&(t.removeChild(i[0]),t.removeChild(i[1]),t.removeChild(i[2])),this._preClonedNodes=this._postClonedNodes=null},e.prototype._initializeAuto=function(){this._isAuto=!0,this._initiateInterval()},e.prototype._initiateInterval=function(){this._removeInterval=this.utils.setInterval(this.goToNext,this._interval,null,this)},e.prototype._suspendInterval=function(){var t=this;this._isAuto&&!this._isPaused&&(this._removeSuspend(),this._removeInterval(),this._removeSuspend=this.utils.defer(function(){t._initiateInterval(),t._removeSuspend=tt},this._suspend))},e.prototype._initializeTap=function(){var t=this;this.utils.isNode(this._forwardArrow)||this._createArrowElements();var e=this._removeListeners;e.push(this.addEventListener(this._backArrow,j,function(){t._suspendInterval(),t.goToPrevious()},!1)),e.push(this.addEventListener(this._forwardArrow,j,function(){t._suspendInterval(),t.goToNext()},!1)),this._checkArrows()},e.prototype._createArrowElements=function(){var t=this._document,e=this._viewport,i=this._backArrow=t.createElement("div"),s=this._forwardArrow=t.createElement("div"),n=t.createElement("span"),o=t.createElement("span");this._isVertical?(n.className=h+"icon-arrow-up",o.className=h+"icon-arrow-down"):(n.className=h+"icon-arrow-left",o.className=h+"icon-arrow-right"),i.className=h+"back-arrow",s.className=h+"forward-arrow",i.appendChild(n),s.appendChild(o),e.appendChild(i),e.appendChild(s)},e.prototype._checkArrows=function(){var t=this.utils,e=t.isNode;if(!this._isInfinite&&e(this._forwardArrow)&&e(this._backArrow)){var i=this.context.length,s=this._index;if(t.isNull(s))return this._backArrow.setAttribute(S,""),void this._forwardArrow.setAttribute(S,"");s<=0?this._backArrow.setAttribute(S,""):this._backArrow.removeAttribute(S),s>=i-1?this._forwardArrow.setAttribute(S,""):this._forwardArrow.removeAttribute(S)}},e.prototype._initializeSwipe=function(){var t,e,i=this._viewport,s=this._handleSwipe;this._isVertical?(t=U+"up",e=U+"down"):(t=U+"left",e=U+"right");var n=this._removeListeners;n.push(this.addEventListener(i,t,s,!1)),n.push(this.addEventListener(i,e,s,!1))},e.prototype._initializeTrack=function(){var t,e,i=this._viewport,s=this._track,n=this._touchEnd;this._isVertical?(t=G+"up",e=G+"down"):(t=G+"left",e=G+"right");var o=this._removeListeners;o.push(this.addEventListener(i,t,s,!1)),o.push(this.addEventListener(i,e,s,!1)),o.push(this.addEventListener(i,K,this._touchStart,!1)),o.push(this.addEventListener(i,W,n,!1)),o.push(this.addEventListener(i,D,n,!1))},e.prototype._handleSwipe=function(t){var e=!1;switch(t.direction.primary){case"left":!this._isVertical&&(this._isInfinite||this._index<this.context.length-1)&&(this._suspendInterval(),e=!0,this.goToNext());break;case"right":!this._isVertical&&(this._isInfinite||this._index>0)&&(this._suspendInterval(),e=!0,this.goToPrevious());break;case"up":this._isVertical&&(this._isInfinite||this._index<this.context.length-1)&&(this._suspendInterval(),e=!0,this.goToNext());break;case"down":this._isVertical&&(this._isInfinite||this._index>0)&&(this._suspendInterval(),e=!0,this.goToPrevious());break;default:return}this._hasSwiped=e},e.prototype._touchStart=function(t){this._inTouch||(this._isAuto&&(this._removeInterval(),this._removeInterval=tt),this._inTouch=!0,this._hasMoved=!1,this._lastTouch={x:t.clientX,y:t.clientY})},e.prototype._touchEnd=function(t){var e=this,i=this._inTouch,s=this._hasMoved,n=this._hasSwiped;if(this._inTouch=this._hasSwiped=this._hasMoved=!1,i&&!n&&(this._isAuto&&!this._isPaused&&this._initiateInterval(),s)){var o=this._isVertical?t.clientY-this._lastTouch.y:t.clientX-this._lastTouch.x,r=this._getLength();if(r)return Math.abs(o)>Math.ceil(r/2)?o<0?void this.goToNext().then(function(t){t||e._reset()}):void this.goToPrevious().then(function(t){t||e._reset()}):void this._reset();this._reset()}},e.prototype._track=function(t){var e=this;this._inTouch&&(this._fade?this._hasMoved=!0:(this._hasMoved||this._cancelCurrentAnimations().then(function(){e._outerStart&&e._outerEnd||e._initializeOuterNodes()}),this._hasMoved=!0,this.utils.requestAnimationFrame(function(){var i=e._calculateDynamicTranslation(t);null!==i&&(e._container.style[e._transform]=i)})))},e.prototype._calculateStaticTranslation=function(t){return this._isVertical?"translate3d(0,"+(this._currentOffset+=t)+"px,0)":"translate3d("+(this._currentOffset+=t)+"px,0,0)"},e.prototype._calculateDynamicTranslation=function(t){var e;return this._isVertical?(e=t.clientY-this._lastTouch.y,Math.abs(e)>this._getLength()?(this._touchEnd(t),null):"translate3d(0,"+(this._currentOffset+e)+"px,0)"):(e=t.clientX-this._lastTouch.x,Math.abs(e)>this._getLength()?(this._touchEnd(t),null):"translate3d("+(this._currentOffset+e)+"px,0,0)")},e.prototype._setTransform=function(){var t=this._container.style,e=this.utils.isUndefined,i=this._compat.vendorPrefix;e(t[i.lowerCase+"Transform"])?e(t[i.upperCase+"Transform"])?this._transform="transform":this._transform=i.upperCase+"Transform":this._transform=i.lowerCase+"Transform"},e.prototype._getLength=function(){return this._length=this._isVertical?this._viewport.offsetHeight:this._viewport.offsetWidth},e.prototype._validateOrientation=function(t){return this.utils.isUndefined(t)?"horizontal":("horizontal"===t?e=t:"vertical"===t?(e=t,this._isVertical=!0):(this._log.debug('Invalid orientation "'+t+'" for '+this.type+'. Defaulting to "horizontal."'),e="horizontal"),e);var e},e.prototype._appendItems=function(t){if(this._itemNodes=this._itemNodes.concat(t),this._loaded){var e=this._index;if(0===this._removeListeners.length)return this._addEventListeners(),this._initializeIndex(0),void this.inputChanged(0,e);e>=this._itemNodes.length-2&&this._initializeIndex(e)}},e.prototype._removeItems=function(t,e){for(var i=this._TemplateControlFactory.dispose,s=this.controls,n=this._itemNodes,o=t+e;o-- >t;)i(s[o]),n.pop();this._updateResource(s.length-1),this._verifyLength()},e.prototype._cancelCurrentAnimations=function(){if(this._fade){var t=this.utils.isNull,e=void 0,i=void 0;return t(this._nextAnimationThenable)||(i=this._nextAnimationThenable.cancel()),t(this._animationThenable)||(e=this._animationThenable.cancel()),this._Promise.all([e,i])}return this.utils.isNull(this._animationThenable)?this._Promise.resolve():this._animationThenable.cancel()},e.prototype._forceRepaint=function(t){var e=t.style,i=e.display;"none"!==e.display?(e.display="none",t.offsetWidth,e.display=i):t.offsetWidth},e._inject={_document:n,_window:s,_compat:i,_TemplateControlFactory:a},e}(plat.ui.controls.ForEach);t.Carousel=ft,plat.register.control(w,ft);var mt=function(t){function r(){var e=t.call(this)||this;return e._aliases={index:F.index,even:F.even,odd:F.odd,first:F.first,last:F.last,group:F.group},e._templates={},e._isVertical=!0,e._scrollReady=!0,e._isLoading=!1,e._scrollPosition=0,e._removeScroll=tt,e._isRefreshing=!1,e._touchState=0,e._hasMoved=!1,e._lastTouch={x:0,y:0},e._nodeNormalizeRegex=/-|\.|_/g,e._isGrouped=!1,e._visibilityRemoveListeners=[],e.__templateString='<div class="plat-listview-viewport">\n    <div class="plat-scroll-container">\n        <div class="plat-listview-container"></div>\n    </div>\n</div>\n',e.__listenerSet=!1,e.templateString=e.__templateString,e.itemsLoaded=new e._Promise(function(t,i){e.__resolveFn=t,e.__rejectFn=i}).catch(tt),e}return __extends(r,t),r.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,E+" "+(t||""))},r.prototype.initialize=function(){var t=this.options||(this.options={}),e=t.value||(t.value={});this.templateUrl=e.templateUrl||this.templateUrl,this.setClasses()},r.prototype.setTemplate=function(){if(this.templateString!==this.__templateString||this.utils.isString(this.templateUrl)){var t=this.dom.serializeHtml(this.__templateString),e=this.element;this.innerTemplate=this.dom.appendChildren(e.childNodes),e.appendChild(t)}},r.prototype.contextChanged=function(t,e){this.utils.isArray(t)?this._setListener():(this._log.debug(this.type+" context set to something other than an Array."),t=[]),this._executeEvent([{object:t,type:"splice"}])},r.prototype.loaded=function(){var t=this.options.value,e=this.utils,i=e.isString,s=this.element,n=this._viewport=s.firstElementChild,o=this._scrollContainer=n.firstElementChild,r=this._loading=t.loading,a=this._animate=!0===t.animate,l=t.onItemsRequested,u=t.onRefresh,p=t.itemTemplate,d=t.scrollElement;if(this._container=o.firstElementChild,this.dom.addClass(s,h+this._validateOrientation(t.orientation)+(a?" plat-animated":"")),i(d)&&(d=this._document.querySelector(d)),e.isNode(d)&&(this._scrollContainer=d,this.dom.addClass(s,h+"no-scroller")),i(p)){var _=this._normalizeTemplateName(p),c=t.headerTemplate,f=i(c)?this._normalizeTemplateName(c):null;this._parseInnerTemplate(_,f),this._determineTemplates(p,_,f),this._defaultGroup={name:null,control:this,itemContainer:this._container,element:s,index:null,itemCount:0,addQueue:[],animationQueue:[]};var m=!1;i(r)&&(i(l)?this._determineLoading(l,!1!==t.infiniteProgress):this._log.debug(this.type+' loading type specified as "'+r+'" but no option specifying an onItemsRequested handler.')),i(u)&&(m=!0,this._initializeRefresh(u)),this._initializeTracking("incremental"===r,m),e.isArray(this.context)?(this._setAliases(),this._setContainerHeight(),this.render(),this._setListener()):e.isNull(this.context)||this._log.debug(this.type+"'s context must be an Array.")}else this._log.debug("No item template or item template selector specified for "+this.type+".")},r.prototype.dispose=function(){for(var t=this._visibilityRemoveListeners;t.length>0;)t.pop()();this._removeScroll(),this.utils.isFunction(this.__rejectFn)&&(this.__rejectFn(),this.__resolveFn=this.__rejectFn=null)},r.prototype.render=function(t,e,i){var s=this.utils.isNumber,n=i||this._defaultGroup,o=n.control,r=this===o?this.context:o.context.items;s(t)||(t=0);var a=r.length-t,l=s(e)&&a>=e?e:a;this._createItems(t,l,n,0)},r.prototype.rerender=function(t){this.render(0,null,t)},r.prototype._childContextChanged=function(t,e,i){this._executeChildEvent(t,[{object:e||[],type:"splice"}])},r.prototype._setListener=function(){this.__listenerSet||(this.observeArray(this._executeEvent),this.__listenerSet=!0)},r.prototype._setAliases=function(){var t=this.options.value.aliases,e=this.utils;if(e.isObject(t))for(var i,s=this._aliases,n=e.isString,o=Object.keys(s),r=o.length,a=0;a<r;++a)n(i=t[o[a]])&&(s[o[a]]=i)},r.prototype._determineTemplates=function(t,e,i){var s,n=this.utils,o=this.bindableTemplates,r=this._templates;if(n.isString(i)&&(this._isGrouped=!0,this.dom.addClass(this._container,h+"grouped"),s=r[i],n.isNode(s)?(this._headerTemplate=i,this.bindableTemplates.add(i,s),delete r[i]):this._log.debug(E+' group header template "'+i+'" was not a template defined in the DOM.'),this._headerTemplatePromise=this._createGroupTemplate()),s=r[e],n.isNode(s))return this._itemTemplate=e,this.bindableTemplates.add(e,s),void delete r[e];var a=this.findProperty(t)||{};if(n.isFunction(a.value)){this._templateSelector=a.value.bind(a.control),this._templateSelectorKeys={};for(var l,u=Object.keys(r);u.length>0;)l=u.pop(),o.add(l,r[l]),delete r[l]}else this._log.debug(E+' item template "'+t+'" was neither a template defined in the DOM nor a template selector function in its control hiearchy.')},r.prototype._createGroupTemplate=function(){var t,e=this,i=this._document,s=this.bindableTemplates,n=this._headerTemplate,o=E+"-group",r=i.createElement("div"),a=i.createElement("div");return r.className=o,a.className=E+"-items",this.utils.isString(n)&&(t=s.templates[n].then(function(t){r.insertBefore(t.cloneNode(!0),null)})),this._Promise.resolve(t).then(function(){r.insertBefore(a,null),s.add(o,r)}).then(null,function(t){e._log.debug(e.type+" error: "+t)})},r.prototype._addGroups=function(t,e,i){for(var s=this,n=e,o=+(e+t),r=[];e<o;)r.push(this._bindGroup(e++));return this._Promise.all(r).then(function(t){for(var e=t.length,o=0;o<e;++o)s._addGroup(o+n,t[o],o<i)})},r.prototype._addGroup=function(e,i,s){var n,o,r=this,a=this.utils,l=this.context,h=this._groups||(this._groups={}),u=l[e],p=u.group,d=i.childNodes[1],_=d.lastElementChild,c=this.controls[e],f=h[p]={name:p,index:e,element:d,itemContainer:_,control:c,itemCount:0,addQueue:[],animationQueue:[]},m="items";if(c.dispose=function(){t.prototype.dispose.call(r),delete h[p]},c.observe(function(t,e){var i=t.group;if(i!==p&&a.isObject(t)){var s=h[p];delete h[p],s.name=i,h[i]=s,p=i,n(),o(),n=c.observe(r._childContextChanged.bind(r,p),m),o=c.observeArray(r._executeChildEvent.bind(r,p),m)}}),n=c.observe(this._childContextChanged.bind(this,p),m),o=c.observeArray(this._executeChildEvent.bind(this,p),m),this._createItems(0,(u.items||[]).length,f,0),s){var v=this._defaultGroup.animationQueue,g={animation:this._animator.enter(i,B,this._container).then(function(){var t=v.indexOf(g);t>-1&&v.splice(t,1),a.requestAnimationFrame(r._setGroupContainerPadding.bind(r,d))}),op:null};v.push(g)}else this._container.insertBefore(i,null),a.requestAnimationFrame(this._setGroupContainerPadding.bind(this,d))},r.prototype._bindGroup=function(t){return this.bindableTemplates.bind(E+"-group",t,this._getAliases(this.context,t))},r.prototype._createItems=function(t,e,i,s){var n=this,o=this.utils,r=i||this._defaultGroup,a=r.control,l=this._isVertical,h=this===a;if(h&&this._isGrouped)this._headerTemplatePromise.then(function(){n._addGroups(e,t,s)}).then(null,function(t){n._log.debug(n.type+" error: "+t)});else{var u,p=r.addQueue,d=function(){var t=p.indexOf(u);-1!==t&&p.splice(t,1),h||(r.element.removeAttribute(S),l||h||!n._isGrouped||o.requestAnimationFrame(n._setGroupContainerWidth.bind(n,r.itemContainer)))},_=function(t){n._log.debug(n.type+" error: "+(o.isString(t.message)?t.message:t))};if(o.isFunction(this._templateSelector)){var c=[];r.itemCount+=e;for(var f=0;f<e;++f,++t)c.push(this._renderUsingFunction(t,r));var m=this.itemsLoaded=this._Promise.all(c).then(function(t){for(var e=t.length,i=0;i<e;++i)n._appendRenderedItem(t[i],r,i<s)}).then(d,_);p.push(m)}else{var v=this._itemTemplate;o.isUndefined(this.bindableTemplates.templates[v])||(this._disposeFromIndex(t,r),r.itemCount+=e,u=this._addItems(t,e,r,s).then(d,_),p.push(u))}}},r.prototype._addItems=function(t,e,i,s){var n,o,r=this,a=i||this._defaultGroup,l=a.control,h=a.itemContainer,u=+(t+e),p=[],d=this._itemTemplate,_=l.bindableTemplates,c=t;for(this===l?(n="",o=this.context):(n="items.",o=l.context.items);t<u;)p.push(_.bind(d,n+t,this._getAliases(o,t++)));return p.length>0&&(this.itemsLoaded=this._Promise.all(p).then(function(t){if(s>0)for(var e=t.length,i=0;i<e;++i)i<s?r._appendAnimatedItem(t[i],a):h.insertBefore(t[i],null);else r._appendItems(t,h);r._updateResource(c-1,l),r.utils.isFunction(r.__resolveFn)&&(r.__resolveFn(),r.__resolveFn=r.__rejectFn=null)}).catch(function(t){r.utils.postpone(function(){r._log.debug(t)})})),this.itemsLoaded},r.prototype._renderUsingFunction=function(t,e){var i,s,n,o=this,r=this._Promise,a=this.utils,l=e||this._defaultGroup,h=l.control;return this===h?(i=t,s=this.context):(i="items."+t,s=h.context.items,n=l.name),r.resolve(this._templateSelectorPromise).then(function(){return o._templateSelectorPromise=r.resolve(o._templateSelector(s[t],t,n))}).then(function(e){var n=h.bindableTemplates,r=n.templates,u=h.controls,p=o._normalizeTemplateName(e),d=l.name,_=o._templateSelectorKeys[d],c=t<u.length;if(a.isUndefined(_)&&(_=o._templateSelectorKeys[d]={}),!a.isUndefined(r[p])){if(c){if(p===_[t])return;return _[t]=p,n.replace(t,p,i,o._getAliases(s,t))}return _[t]=p,n.bind(p,i,o._getAliases(s,t))}o._log.debug(o.type+' template "'+e+'" was not found.'),c&&o._TemplateControlFactory.dispose(u[t])})},r.prototype._appendRenderedItem=function(t,e,i){var s=this.utils,n=e||this._defaultGroup;if(!s.isNull(t)&&!s.isArray(t)){if(!0===i){var o=n.animationQueue,r={animation:this._animator.enter(t,B,n.itemContainer).then(function(){var t=o.indexOf(r);-1!==t&&o.splice(t,1)}),op:null};o.push(r)}else n.itemContainer.insertBefore(t,null);s.isFunction(this.__resolveFn)&&(this.__resolveFn(),this.__resolveFn=null)}},r.prototype._updateResource=function(t,e){var i=e.controls;t<0||t>=i.length||i[t].resources.add(this._getAliases(this===e?this.context:e.context.items,t))},r.prototype._getAliases=function(t,e){var i=0==(1&e),s={},n=this._aliases,o="literal";return s[n.index]={value:e,type:o},s[n.even]={value:i,type:o},s[n.odd]={value:!i,type:o},s[n.first]={value:0===e,type:o},s[n.last]={value:e===t.length-1,type:o},s},r.prototype._appendItems=function(t,e){this.dom.appendChildren(t,e)},r.prototype._appendAnimatedItem=function(t,e){if(this.utils.isNode(t)){var i=e.animationQueue,s={animation:this._animator.enter(t,B,e.itemContainer).then(function(){var t=i.indexOf(s);-1!==t&&i.splice(t,1)}),op:null};i.push(s)}},r.prototype._removeItems=function(t,e,i){for(var s=this._TemplateControlFactory.dispose,n=i.control,o=n.controls,r=t+e,a=r>t;r-- >t;)s(o[r]);this._updateResource(o.length-1,n),this!==n&&(0===o.length?i.element.setAttribute(S,""):a&&this._isGrouped&&!this._isVertical&&this.utils.requestAnimationFrame(this._setGroupContainerWidth.bind(this,i.itemContainer)))},r.prototype._disposeFromIndex=function(t,e){for(var i=(e||this._defaultGroup).control,s=i.controls,n=this._TemplateControlFactory.dispose,o=s.length,r=o>t;o-- >t;)n(s[o]);this!==i&&(0===s.length?e.element.setAttribute(S,""):r&&this._isGrouped&&!this._isVertical&&this.utils.requestAnimationFrame(this._setGroupContainerWidth.bind(this,e.itemContainer)))},r.prototype._determineLoading=function(t,e){var i,s=this,n=this.findProperty(t)||{};if(this.utils.isFunction(n.value))switch(this._requestItems=n.value.bind(n.control),this._loading){case"infinite":var o,r=tt;o=this.addEventListener(this._scrollContainer,"scroll",function(){s._scrollReady&&(s._scrollReady=!1,r=s.utils.requestAnimationFrame(function(){s._scrollReady=!0,s._onScroll()}))},!1),this._removeScroll=function(){s._scrollReady=!1,r(),o()},e&&((i=this._loadingProgressRing=this._document.createElement("div")).className=h+"infinite",i.insertBefore(this._generateProgressRing(),null)),this.itemsLoaded.then(this._onScroll.bind(this));break;case"incremental":(i=this._loadingProgressRing=this._document.createElement("div")).className=h+"incremental",i.setAttribute(S,""),i.insertBefore(this._generateProgressRing(),null),this.element.insertBefore(i,null)}else this._log.debug(E+' onItemsRequested function "'+t+'" was not found.')},r.prototype._onScroll=function(){var t=this._scrollContainer,e=this._scrollPosition,i=this._isVertical?t.scrollTop+t.offsetHeight:t.scrollLeft+t.offsetWidth;e>i?this._scrollPosition=i:e+5>i||(this._scrollPosition=i,this._handleScroll())},r.prototype._handleScroll=function(){var t=this,e=this._scrollContainer,i=.8*(this._isVertical?e.scrollHeight:e.scrollWidth);if(0!==i&&this._scrollPosition>=i){var s=this.utils,n=this._requestItems();if(!1===n)this._removeScroll();else if(s.isPromise(n)){var o=this._loadingProgressRing,r=!s.isNull(o),a=this._container;this._scrollReady=!1,r&&s.requestAnimationFrame(function(){a.insertBefore(o,null)}),n.then(function(e){r&&s.requestAnimationFrame(function(){a.removeChild(o)}),!1!==e&&(t._scrollReady=!0)})}else s.postpone(function(){t.itemsLoaded.then(function(){t._scrollReady&&t._handleScroll()})})}},r.prototype._initializeRefresh=function(t){var e=this.findProperty(t)||{};if(this.utils.isFunction(e.value)){this._refresh=e.value.bind(e.control);var i=this._refreshProgressRing=this._document.createElement("div");i.className=h+"refresh",i.setAttribute(S,""),i.insertBefore(this._generateProgressRing(),null),this.element.insertBefore(i,null)}else this._log.debug(E+' onRefresh function "'+t+'" was not found.')},r.prototype._initializeTracking=function(t,e){if(t||e){var i,s;this._setTransform(),this._isVertical?(i=G+"down",s=G+"up"):(i=G+"right",s=G+"left");var n,o,r=this._viewport;this.addEventListener(r,K,this._touchStart,!1),t&&(n=this._touchEndLoad,o=this._trackLoad,this.addEventListener(r,D,n,!1),this.addEventListener(r,W,n,!1),this.addEventListener(r,q,n,!1),this.addEventListener(r,i,o,!1),this.addEventListener(r,s,o,!1)),e&&(n=this._touchEndRefresh,o=this._trackRefresh,this.addEventListener(r,D,n,!1),this.addEventListener(r,W,n,!1),this.addEventListener(r,q,n,!1),this.addEventListener(r,i,o,!1),this.addEventListener(r,s,o,!1))}},r.prototype._touchStart=function(t){var e=this;0===this._touchState&&(!this._isVertical&&Math.ceil(t.offsetY)>=this._viewport.offsetHeight-20||(this._touchState=1,this._lastTouch={x:t.clientX,y:t.clientY},this.utils.isNull(this._touchAnimationThenable)?this._touchState=2:this._touchAnimationThenable.cancel().then(function(){e._touchAnimationThenable=null,e._touchState=2})))},r.prototype._touchEndLoad=function(t){var e=this._isLoading;if(this._isLoading=!1,e){var i,s,n=this._scrollContainer;this._isVertical?(i=n.scrollTop+n.offsetHeight,s=n.scrollHeight):(i=n.scrollLeft+n.offsetWidth,s=n.scrollWidth),i+1<s?this._touchState=0:this._touchEnd(t,!1)}else this._isRefreshing||(this._touchState=0)},r.prototype._touchEndRefresh=function(t){var e=this._isRefreshing;this._isRefreshing=!1,e?(this._isVertical?this._scrollContainer.scrollTop:this._scrollContainer.scrollLeft)>0?this._touchState=0:this._touchEnd(t,!0):this._isLoading||(this._touchState=0)},r.prototype._touchEnd=function(t,e){var i=this,s=this._touchState,n=this._hasMoved;if(this._hasMoved=!1,!(s<2)&&n){var o,r={},a=this.dom,l=this._viewport,u=e?this._refreshProgressRing:this._loadingProgressRing,p=3===s;if(p){o=this._isVertical?"translate3d(0,"+(e?u.offsetHeight:-u.offsetHeight)+"px,0)":"translate3d("+(e?u.offsetWidth:-u.offsetWidth)+"px,0,0)"}else o=this._preTransform;r[this._transform]=o,this._touchAnimationThenable=this._animator.animate(l,R,{properties:r}).then(function(){return i._touchState=4,i._hasMoved=!1,i._touchAnimationThenable=null,p?i._Promise.resolve(e?i._refresh():i._requestItems()):(a.removeClass(l,h+"manipulation-prep"),u.setAttribute(S,""),i._Promise.resolve())}).then(function(){if(p)return a.removeClass(u,h+"play"),r[i._transform]=i._preTransform,i._touchAnimationThenable=i._animator.animate(l,R,{properties:r}).then(function(){i._touchState=0,i._touchAnimationThenable=null,a.removeClass(l,h+"manipulation-prep"),u.setAttribute(S,"")});i._touchState=0}).then(null,function(t){i._touchState=0,i._log.debug(i.type+" error: "+t)})}},r.prototype._trackLoad=function(t){if(!this._isRefreshing){if(!this._isLoading){var e=this._scrollContainer,i=void 0,s=void 0;if(this._isVertical){if("up"!==t.direction.y)return;i=e.scrollTop+e.offsetHeight,s=e.scrollHeight}else{if("left"!==t.direction.x)return;i=e.scrollLeft+e.offsetWidth,s=e.scrollWidth}if(i+1<s)return;this._isLoading=!0}this._track(t,!1)}},r.prototype._trackRefresh=function(t){if(!this._isLoading){if(!this._isRefreshing){if(this._isVertical){if("down"!==t.direction.y||this._scrollContainer.scrollTop>0)return}else if("right"!==t.direction.x||this._scrollContainer.scrollLeft>0)return;this._isRefreshing=!0}this._track(t,!0)}},r.prototype._track=function(t,e){var i=this,s=this._touchState;if(2===s||3===s){var n=this._calculateTranslation(t,e);this.utils.requestAnimationFrame(function(){i._viewport.style[i._transform]=n})}},r.prototype._calculateTranslation=function(t,e){var i,s,n=this._isVertical,o=e?this._refreshProgressRing:this._loadingProgressRing;return n?(i=t.clientY-this._lastTouch.y,s=o.offsetHeight):(i=t.clientX-this._lastTouch.x,s=o.offsetWidth),e&&i<0||!e&&i>0?i=0:this._hasMoved?Math.abs(i)>=s?this._touchState<3&&(this._touchState=3,this.dom.addClass(o,h+"play")):3===this._touchState&&(this._touchState=2,this.dom.removeClass(o,h+"play")):(this._hasMoved=!0,this.dom.addClass(this._viewport,h+"manipulation-prep"),o.removeAttribute(S)),n?"translate3d(0,"+i+"px,0)":"translate3d("+i+"px,0,0)"},r.prototype._setTransform=function(){var t=this._viewport.style,e=this.utils.isUndefined,i=this._compat.vendorPrefix;e(this._preTransform=t[i.lowerCase+"Transform"])?e(this._preTransform=t[i.upperCase+"Transform"])?(this._preTransform=t.transform,this._transform="transform"):this._transform=i.upperCase+"Transform":this._transform=i.lowerCase+"Transform"},r.prototype._parseInnerTemplate=function(t,e){for(var i,s,n,o=this._templates,r=Array.prototype.slice,a=this.dom.appendChildren,l=this._document,u=!this.utils.isNull(e),p=r.call(this.innerTemplate.childNodes);p.length>0;)(i=p.pop()).nodeType===Node.ELEMENT_NODE&&(s=this._normalizeTemplateName(i.nodeName),u&&s===e?(n=l.createElement("div")).className=h+"header":n=l.createDocumentFragment(),a(i.childNodes,n),o[s]=n)},r.prototype._executeEvent=function(t){var e="_"+t[0].type;this.utils.isFunction(this[e])&&this[e](t)},r.prototype._executeChildEvent=function(t,e){var i=this.utils,s="_"+e[0].type;if(i.isFunction(this[s])){var n=this._groups[t];if(i.isNull(n))return;this[s](e,n)}},r.prototype._push=function(t,e){var i=t[0],s=i.addedCount;this._createItems(i.index,s,e,this._animate?s:0)},r.prototype._pop=function(t,e){var i=this,s=e||this._defaultGroup,n=s.addQueue,o=t[0],r=o.object.length;if(0!==o.removed.length){var a=o.object.length;s.itemCount>0&&s.itemCount--,this._Promise.all(n).then(function(){i._animate?i._animateItems(r,1,M,s,"leave",!1).then(function(){i._removeItems(a,1,s)}):i._removeItems(a,1,s)})}},r.prototype._unshift=function(t,e){if(this.utils.isFunction(this._templateSelector))this.rerender(e);else{var i=e||this._defaultGroup,s=t[0],n=s.addedCount;if(this._animate){var o=i.animationQueue,r=o.length;this._animateItems(0,n,B,i,null,r>0&&"clone"===o[r-1].op)}this._createItems(s.object.length-n,n,i,0)}},r.prototype._shift=function(t,e){var i=this,s=e||this._defaultGroup,n=s.addQueue,o=t[0];if(0!==o.removed.length){this._animate&&0===n.length&&(n=n.concat([this._animateItems(0,1,M,s,"clone",!0)]));var r=o.object.length;s.itemCount>0&&s.itemCount--,this._Promise.all(n).then(function(){i._removeItems(r,1,s)})}},r.prototype._splice=function(t,e){var i=this,s=this.utils,n=t[0],o=e||this._defaultGroup,r=n.addedCount,a=o.itemCount,l=(o.control,o.addQueue),h=this._animate;if(s.isNull(r)){h&&this._cancelCurrentAnimations();var u=n.object.length,p=a-u;if(u>a){if(s.isFunction(this._templateSelector))return void(s.isNull(n.index)?this.rerender(o):this.render(n.index,r,o));this._createItems(a,-p,o,0)}else a>u&&(o.itemCount>=p?o.itemCount-=p:o.itemCount=0,this._Promise.all(l).then(function(){i._removeItems(a-p,p,o)}))}else{var d=n.removed.length,_=o.animationQueue;if(r>d){var c=r-d,f=void 0;if(s.isFunction(this._templateSelector))return void(s.isNull(n.index)?this.rerender(o):this.render(n.index,r,o));if(h){f=r;var m=_.length,v=n.index;a<r-v&&(f=a-v),this._animateItems(v,f,B,o,null,m>0&&"clone"===_[m-1].op),f=r-f}else f=0;this._createItems(n.object.length-c,c,o,f)}else if(d>r){var g=r>0;h&&!g&&0===l.length&&(l=l.concat([this._animateItems(n.index,d,M,o,"clone",!0)]));var y=d-r;o.itemCount>=y?o.itemCount-=y:o.itemCount=0,this._Promise.all(l).then(function(){if(h&&g){var t=_.length;i._animateItems(n.index,r,B,o,null,t>0&&"clone"===_[t-1].op)}i._removeItems(a-y,y,o)})}}},r.prototype._animateItems=function(t,e,i,s,n,o){switch(n){case"clone":return this._handleClonedContainerAnimation(this._getAnimatedNodes(t,e,s),i,s,!0===o);case"leave":return this._handleLeave(this._getAnimatedNodes(t,e,s),i,s);default:return this._handleSimpleAnimation(this._getAnimatedNodes(t,e,s),i,s,!0===o)}},r.prototype._getAnimatedNodes=function(t,e,i){if(this._isGrouped&&i===this._defaultGroup){var s=3*t;return Array.prototype.slice.call(i.itemContainer.childNodes,s,3*e+s)}var n=this.utils.isNode,o=Array.prototype.slice.call(i.itemContainer.childNodes),r=t+e-1,a=i.control.controls;a.length<=r&&(r=a.length-1);var l=a[t].startNode,h=a[r].endNode;if(!n(l)||!n(h))return[];var u=o.indexOf(l),p=o.indexOf(h);return-1===u||-1===p?[]:o.slice(u,p+1)},r.prototype._handleSimpleAnimation=function(t,e,i,s){if(0===t.length)return this._Promise.resolve();i.itemContainer;var n,o=i.animationQueue,r=this._animator.create(t,e),a=r.current.then(function(){var t=o.indexOf(n);-1!==t&&o.splice(t,1)}),l=function(){return r.previous.then(function(){a.start()}),a};if(n={animation:a,op:null},s&&o.length>0){var h=this._cancelCurrentAnimations().then(l);return o.push(n),h}return o.push(n),l()},r.prototype._handleLeave=function(t,e,i){if(0===t.length)return this._Promise.resolve();i.itemContainer;var s,n=i.animationQueue,o=this._animator.leave(t,e).then(function(){var t=n.indexOf(s);-1!==t&&n.splice(t,1)});return s={animation:o,op:"leave"},n.push(s),o},r.prototype._handleClonedContainerAnimation=function(t,e,i,s){if(0===t.length)return this._Promise.resolve();var n,o,r=i.itemContainer,a=r.cloneNode(!0),l=i.animationQueue,h=this.utils.isNull,u=this._animator.create(t,e),p=u.current.then(function(){var t=l.indexOf(o);t>-1&&l.splice(t,1),h(n)||n.replaceChild(r,a)}),d=function(){return n=r.parentNode,h(n)||p.isCanceled()?p:(n.replaceChild(a,r),u.previous.then(function(){p.start()}),p)};if(o={animation:p,op:"clone"},s&&l.length>0){var _=this._cancelCurrentAnimations().then(d);return l.push(o),_}return l.push(o),d()},r.prototype._cancelCurrentAnimations=function(t){for(var e=(t||this._defaultGroup).animationQueue,i=[],s=e.length,n=0;n<s;++n)i.push(e[n].animation.cancel());return this._Promise.all(i)},r.prototype._normalizeTemplateName=function(t){if(this.utils.isString(t))return t.toLowerCase().replace(this._nodeNormalizeRegex,"")},r.prototype._generateProgressRing=function(){var t=this._document,e=t.createElement("div"),i=t.createElement("div");return e.className=E+"-ring "+h+"ring "+h+"ring-0",i.className=h+"animated-ring",e.insertBefore(i,null),e},r.prototype._validateOrientation=function(t){return this.utils.isUndefined(t)?"vertical":("vertical"===t?e=t:"horizontal"===t?(e=t,this._isVertical=!1):(this._log.debug('Invalid orientation "'+t+'" for '+this.type+'. Defaulting to "vertical."'),e="vertical"),e);var e},r.prototype._setContainerHeight=function(){if(!this._isVertical&&this._isGrouped){var t=this.element,e=t.offsetHeight;e?((e-=this._getScrollBarWidth())<0&&(e=0),this._container.style.height=e+"px"):this._addVisibilityListener(this._setContainerHeight.bind(this),t)}},r.prototype._setGroupContainerWidth=function(t){var e=t.scrollWidth;e?t.parentElement.style.width=e+"px":this._addVisibilityListener(this._setGroupContainerWidth.bind(this,t),t)},r.prototype._setGroupContainerPadding=function(t){if(t.offsetHeight){var e=t.firstElementChild,i=e.offsetHeight;i?t.style.paddingTop=i+"px":this._addVisibilityListener(this._setGroupContainerPadding.bind(this,t),e)}else this._addVisibilityListener(this._setGroupContainerPadding.bind(this,t),t)},r.prototype._getScrollBarWidth=function(){var t=this._document,e=t.body,i=t.createElement("div"),s=t.createElement("div"),n=i.style,o=s.style;n.width=n.height=o.height="100px",o.width="50px",o.position="absolute",o.top=o.left="0px",o.visibility=o.overflow="hidden",s.insertBefore(i,null),e.insertBefore(s,null);var r=i.offsetHeight;o.overflow="scroll";var a=i.offsetHeight;return r===a&&(a=s.clientHeight),e.removeChild(s),r-a},r.prototype._addVisibilityListener=function(t,e){var i,s=this,n=this._visibilityRemoveListeners;i=this.dom.whenVisible(this.utils.requestAnimationFrame.bind(this,function(){t();var e=n.indexOf(i);-1!==e&&n.splice(e,1),0===n.length&&s.element.removeAttribute(A)}),e),0===n.length&&this.element.setAttribute(A,""),n.push(i)},r._inject={_document:n,_window:s,_compat:i,_animator:o,_Promise:e,_TemplateControlFactory:a},r}(plat.ui.TemplateControl);t.Listview=mt,plat.register.control(E,mt);var vt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateString='<div class="plat-navbar-left">\n    <div class="plat-navbar-items" plat-control="'+L+'" plat-context="left">\n        <div class="plat-navbar-item" plat-control="'+k+'" plat-options="{ html: content, compile: true }" plat-tap="leftAction(@index)"></div>\n    </div>\n</div>\n<div class="plat-navbar-center">\n    <div class="plat-navbar-items" plat-control="'+L+'" plat-context="center">\n        <div class="plat-navbar-item" plat-control="'+k+'" plat-options="{ html: content, compile: true }" plat-tap="centerAction(@index)"></div>\n    </div>\n</div>\n<div class="plat-navbar-right">\n    <div class="plat-navbar-items" plat-control="'+L+'" plat-context="right">\n        <div class="plat-navbar-item" plat-control="'+k+'" plat-options="{ html: content, compile: true }" plat-tap="rightAction(@index)"></div>\n    </div>\n</div>\n',e.context={left:[{content:"",action:tt}],center:[{content:"",action:tt}],right:[{content:"",action:tt}]},e.hasOwnContext=!0,e._overrides={left:!1,center:!1,right:!1},e}return __extends(e,t),e.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,P+" "+(t||""))},e.prototype.initialize=function(){this.setClasses()},e.prototype.setTemplate=function(){var t=this.utils.isNull,e=this.innerTemplate;if(!t(e))for(var i,s,n=this._document,o=this._overrides,r=Array.prototype.slice,a=this.dom.appendChildren,l=r.call(e.childNodes),h=this.element,u=r.call(h.children);l.length>0;)if((i=l.shift()).nodeType===Node.ELEMENT_NODE)switch(i.nodeName.toLowerCase()){case"left":o.left=!0,(s=n.createElement("div")).className=P+"-left",s.setAttribute(I,"left"),h.replaceChild(a(r.call(i.childNodes),s),u[0]);break;case"center":o.center=!0,(s=n.createElement("div")).className=P+"-center",s.setAttribute(I,"center"),h.replaceChild(a(r.call(i.childNodes),s),u[1]);break;case"right":o.right=!0,(s=n.createElement("div")).className=P+"-right",s.setAttribute(I,"right"),h.replaceChild(a(r.call(i.childNodes),s),u[2])}},e.prototype.loaded=function(){var t=(this.options||{}).value||{},e=this.utils.isString(t.position)&&"bottom"===t.position.toLowerCase()?"-bottom":"-top";this.dom.addClass(this.element,P+e)},e.prototype.setLeft=function(t){this._setComponent("left",t)},e.prototype.setCenter=function(t){this._setComponent("center",t)},e.prototype.setRight=function(t){this._setComponent("right",t)},e.prototype.leftAction=function(t,e){this._executeAction(e,"left",t)},e.prototype.centerAction=function(t,e){this._executeAction(e,"center",t)},e.prototype.rightAction=function(t,e){this._executeAction(e,"right",t)},e.prototype._setComponent=function(t,e){var i=this.context;if(!this.utils.isArray(e)){if(this._overrides[t])return this._parseComponent(e),void(i[t]=e);e=[e]}for(var s=e.length;s-- >0;)this._parseComponent(e[s],i[t][s]);i[t]=e},e.prototype._parseComponent=function(t,e){var i,s,n,o,r=this.utils,a=r.isObject,l=a(e);if(l&&r.isUndefined(t.content)&&(t.content=e.content),r.isFunction(t.action)||(t.action=l?e.action:tt),a(i=t.customActions))for(o=(s=Object.keys(i)).length;o-- >0;)this[n=s[o]]=i[n]},e.prototype._executeAction=function(t,e,i){var s=this.utils,n=this.context[e];s.isArray(n)&&!s.isNull(i)&&(n=n[i]),s.isFunction(n.action)?n.action(t):this._log.debug("An action function is not defined for the component "+n+".")},e._inject={_document:n},e}(plat.ui.TemplateControl);t.Navbar=vt,plat.register.control(P,vt,null,!0);var gt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.templateString='<div plat-control="'+m+'" class="plat-image-ring"></div>\n',e._isBackground=!1,e._img=e._document.createElement("img"),e}return __extends(e,t),e.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,N+" "+(t||""))},e.prototype.initialize=function(){this.setClasses()},e.prototype.loaded=function(){var t,e=this.element,i=this.utils,s=i.isString,n=i.isObject,o=this.attributes,r=this.options;if(s(t=o[z]))o.observe(this._setSrc,z);else{if(!s(t=o.src))return;o.observe(this._setSrc,"src")}n(r)&&n(r.value)&&(this._isBackground=!0===r.value.isBackground),this._isBackground&&this.dom.addClass(e,h+"background"),this._loader=e.firstElementChild,this._NodeManagerStatic.hasMarkup(t)||this._setSrc(t)},e.prototype._setSrc=function(t,e){var i=this,s=this._img,n=this.element,o=this.dom,r=h+"load-image",a=N+"-error",l=this._loader;o.addClass(s,r),s.src=t,s.onload=function(){i.utils.requestAnimationFrame(function(){if(o.removeClass(n,a),i._isBackground)return n.style.backgroundImage='url("'+t+'")',n.contains(s)&&n.removeChild(s),void(n.contains(l)&&n.removeChild(l));o.removeClass(s,r),n.contains(l)&&n.removeChild(l)})},s.onerror=function(){i.utils.requestAnimationFrame(function(){o.addClass(n,a),n.contains(s)&&n.removeChild(s),n.contains(l)&&n.removeChild(l)})},n.insertBefore(l,null),n.insertBefore(s,null)},e._inject={_compat:i,_document:n,_NodeManagerStatic:"$NodeManagerStatic"},e}(plat.ui.TemplateControl);t.Image=gt,plat.register.control(N,gt)}(platui||(platui={})),module.exports=platui;