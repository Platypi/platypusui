"use strict";var platui,__extends=this&&this.__extends||function(){var s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};return function(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();!function(t){var s="$Promise",n="$Compat",o="$Window",r="$Document",a="$Animator",i="$DomEventInstance",l="$TemplateControlFactory",e="plat",v=e+"-",h=v+"button",u=v+"checkbox",d=v+"drawer",p=d+"-controller",_=v+"modal",c=v+"progress",f=v+"ring",m=v+"radio",g=v+"toggle",y=v+"slider",b=v+"range",C=v+"select",x=v+"input",T=v+"file",w=v+"carousel",E=v+"listview",P=v+"navbar",N=v+"image",S=v+"hide",A=v+"hidden",I=v+"context",L=v+"foreach",k=v+"html",O=e+"Checked",V=e+"Bind",z=e+"Src",F="index",R="even",B="odd",M="first",j="last",K="group",D=v+"transition",q=v+"enter",U=v+"leave",G="$tap",W="$touchstart",H="$touchend",Y="$touchcancel",X="$swipe",Q="$track",$="$trackend",J="__plat-button-",Z="__plat-radio-",tt="__platDrawerControllerFetch",et="__platDrawerFound",it="-reversed",st={right:"left",left:"right",up:"down",down:"up"},nt=function(t){return t.preventDefault(),!1},ot=function(){};"undefined"!=typeof window&&(void 0===window.platui&&(window.platui=t),void 0===window.module&&(window.module={}));var rt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.replaceWith="button",t._isSelected=!1,t}return __extends(t,e),t.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,h+" "+(t||""))},t.prototype.initialize=function(){this.setClasses()},t.prototype.loaded=function(){var t=this.element,e=((this.options||{}).value||{}).group,i=this.utils.isString;i(e)?(this._group=e,this.dom.hasClass(t,v+"selected")&&this._onTap(),this._addEventListeners()):i(e=this.attributes[V])&&(this._group=e,this.dom.hasClass(t,v+"selected")&&this._onTap(),this._addEventListeners())},t.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty)},t.prototype._setBoundProperty=function(t,e,i,s){this.utils.isString(t)&&t===this.element.textContent&&this._onTap()},t.prototype._addEventListeners=function(){var t=this;this.addEventListener(this.element,G,this._onTap,!1),this.on(J+this._group,function(){t._isSelected&&(t.dom.removeClass(t.element,v+"selected"),t._isSelected=!1)})},t.prototype._onTap=function(){if(!this._isSelected){var t=this.element;this.dom.addClass(t,v+"selected"),this.dispatchEvent(J+this._group,plat.events.EventManager.DIRECT),this._isSelected=!0,this.inputChanged(t.hasAttribute("value")?t.getAttribute("value").trim():t.textContent.trim())}},t._inject={_document:r},t}(plat.ui.BindControl);t.Button=rt,plat.register.control(h,rt);var at=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.templateString='<div class="plat-toggle-container">\n    <div class="plat-knob"></div>\n</div>\n',t.isActive=!1,t._targetType="slide",t}return __extends(t,e),t.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,g+" "+(t||""))},t.prototype.initialize=function(){this.setClasses()},t.prototype.setTemplate=function(){var t=this.utils.isNull,e=this.innerTemplate;if(!t(e)){var i=this._document.createElement("span");this.dom.appendChildren(e.childNodes,i),this.element.insertBefore(i,null)}},t.prototype.loaded=function(){var t=this.element;this._targetElement=t.firstElementChild,this.addEventListener(t,G,this._onTap),this._convertChecked()},t.prototype.toggle=function(){this._toggle(!0)},t.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty)},t.prototype._setBoundProperty=function(t,e,i,s){t!==e&&(!0===s&&this.utils.isNull(t)?this.inputChanged(this.isActive):!!t!==this.isActive&&this._toggle(s))},t.prototype._convertChecked=function(){var t=this.element;this.utils.isNull(this.attributes[O])?t.hasAttribute("checked")&&this._convertAttribute(!0):(this._convertAttribute(this.attributes[O]),this.attributes.observe(this._convertAttribute,O))},t.prototype._convertAttribute=function(t,e){var i=this.utils;if(i.isBoolean(t))return this._setBoundProperty(t,e,null,!0);i.isString(t)&&this._setBoundProperty("true"===t,"true"===e,null,!0)},t.prototype._onTap=function(t){this.element.hasAttribute("disabled")||(this._toggle(!0),this._trigger("change"))},t.prototype._trigger=function(t){var e=plat.acquire(i);e.initialize(this.element,t),e.trigger()},t.prototype._toggle=function(t){var e=this.isActive,i=!e,s=this.element;this._activate(this._targetElement||(this._targetElement=s.firstElementChild)),this.isActive=s.checked=i,i?s.setAttribute("checked","checked"):s.removeAttribute("checked"),!0===t&&this.inputChanged(i,e)},t.prototype._activate=function(t){this.dom.toggleClass(t,v+this._targetType)},t._inject={_document:r},t}(plat.ui.BindControl);t.Toggle=at,plat.register.control(g,at);var lt=function(s){function t(){var t=null!==s&&s.apply(this,arguments)||this;return t.templateString='<div class="plat-checkbox-container">\n    <span class="plat-mark"></span>\n</div>\n',t._targetTypeSet=!1,t}return __extends(t,s),t.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,u+" "+(t||""))},t.prototype.loaded=function(){s.prototype.loaded.call(this);var t=(this.options||{}).value||{},e=this._targetType;switch((this._targetType=t.mark||"check").toLowerCase()){case"check":case"x":break;default:this._log.debug("Invalid mark option specified for "+this.type+". Defaulting to checkmark."),this._targetType="check"}if(this._targetTypeSet){var i=this._targetElement;this.dom.removeClass(i,e),this._activate(i)}this._targetTypeSet=!0},t.prototype._activate=function(t){this._targetTypeSet?this.dom.toggleClass(t,v+this._targetType):this._targetTypeSet=!0},t}(at);t.Checkbox=lt,plat.register.control(u,lt);var ht=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.templateString='<div class="plat-radio-container">\n    <div class="plat-mark"></div>\n</div>\n',t.groupName="",t._targetType="bullet",t._targetTypeSet=!0,t}return __extends(t,n),t.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,m+" "+(t||""))},t.prototype.loaded=function(){var t=this.element;this._targetElement=t.firstElementChild,this.addEventListener(t,G,this._onTap),t.hasAttribute("name")?this.groupName=t.getAttribute("name"):this.utils.isNull(this.attributes[V])||(this.groupName=this.attributes[V]),this._convertChecked()},t.prototype.inputChanged=function(t,e){this.isActive&&n.prototype.inputChanged.call(this,this._getValue())},t.prototype._setBoundProperty=function(t,e,i,s){var n=this.utils;if(t!==e)if(!0===s&&n.isNull(t))this.inputChanged();else{var o=this._getValue(),r=t===o,a=this.isActive;if(r){if(a)return}else if(n.isNull(t)){if(!a)return}else{var l=n.isFunction(t.toString)?t.toString():Object.prototype.toString.call(t);if(a){if(l===o)return}else if(l!==o)return}this._toggle(s)}},t.prototype._onTap=function(t){this.isActive||n.prototype._onTap.call(this,t)},t.prototype._toggle=function(t){var e=this;if(n.prototype._toggle.call(this,t),this.utils.isFunction(this._removeListener)&&(this._removeListener(),this._removeListener=null),this.isActive){var i=this.groupName;this.dispatchEvent(Z+i,plat.events.EventManager.DIRECT);var s=this._removeListener=this.on(Z+i,function(){e._toggle(),s()})}},t.prototype._convertAttribute=function(t,e){var i=this.utils;i.isBoolean(t)?t&&this._setBoundProperty(this._getValue(),null,null,!0):i.isString(t)&&"true"===t&&this._setBoundProperty(this._getValue(),null,null,!0)},t.prototype._getValue=function(){var t=this.element;return t.hasAttribute("value")?t.getAttribute("value").trim():t.textContent.trim()},t}(lt);t.Radio=ht,plat.register.control(m,ht);var ut=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.templateString='<div class="plat-animated-ring"></div>',t}return __extends(t,e),t.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,f+" "+(t||""))},t.prototype.initialize=function(){this.setClasses()},t.prototype.loaded=function(){var t=this.options,e=this.utils,i=e.isObject,s=0;i(t)&&i(t.value)&&(s=t.value.style,e.isNumber(s)||(s=0)),this.dom.addClass(this.element,f+"-"+s),0!==s&&this._addAnimatedElements(s)},t.prototype._addAnimatedElements=function(t){for(var e,i=plat.acquire(r),s=i.createDocumentFragment(),n=2===t?12:4,o=0;o<n;++o)(e=i.createElement("div")).className="plat-animated-child plat-animated-child-"+o,s.insertBefore(e,null);this.element.firstElementChild.insertBefore(s,null)},t}(plat.ui.TemplateControl);t.ProgressRing=ut,plat.register.control(f,ut);var pt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.templateString='<div class="plat-progress-container">\n    <div class="plat-animated-bar"></div>\n</div>\n',t._removeVisibilityListener=ot,t}return __extends(t,e),t.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,c+" "+(t||""))},t.prototype.initialize=function(){this.setClasses()},t.prototype.loaded=function(){var t=this;this._barElement=this.element.firstElementChild.firstElementChild,this.addEventListener(this._window,"resize",function(){t.setProgress(t.context)}),this.setProgress(this.context)},t.prototype.dispose=function(){this._removeVisibilityListener()},t.prototype.contextChanged=function(){this.setProgress(this.context)},t.prototype.setProgress=function(o){var r=this;return new this._Promise(function(t,e){if(!r.utils.isNumber(o)||1<o||o<0){var i='The value of a "'+r.type+'" control must be a number between 0 and 1.';return r._log.debug(i),void e(i)}var s=r._barElement,n=s.parentElement.clientWidth;if(!n)return r._removeVisibilityListener(),void(r._removeVisibilityListener=r.dom.whenVisible(function(){r.setProgress(o).then(t)},r.element));r._animator.animate(s,D,{properties:{width:Math.ceil(n*o)+"px"}}).then(function(){t()})})},t._inject={_window:o,_Promise:s,_animator:a},t}(plat.ui.TemplateControl);t.ProgressBar=pt,plat.register.control(c,pt);var _t=function(e){function t(){var t=e.call(this)||this;return t._controllers=[],t._isInitialized=!1,t._preInitializedValue=!1,t.__state=!1,t.__nextState=!1,t.ready=t._Promise.resolve(),t}return __extends(t,e),t.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,d+" "+(t||""))},t.prototype.initialize=function(){this.setClasses()},t.prototype.setTemplate=function(){this.innerTemplate=this.dom.appendChildren(this.element.childNodes)},t.prototype.loaded=function(){var e=this,t=this.element,i=this.utils,s=(this.options||{}).value||{},n=this._currentPosition=s.position||"left",o=s.id||"",r=s.templateUrl,a=!0===s.elastic;t.setAttribute(S,""),this.dom.addClass(t,v+n),i.isString(r)?plat.ui.TemplateControl.determineTemplate(this,r).then(function(t){e.innerTemplate=t,e._initializeEvents(o,n,a)}):this._initializeEvents(o,n,a)},t.prototype.open=function(){var t=this._controllers[0];return this.utils.isNull(t)?(this._log.debug("No controller, such as a "+p+", found for the "+this.type+" attempting to open."),this._Promise.resolve()):t.open()},t.prototype.close=function(){var t=this._controllers[0];return this.utils.isNull(t)?(this._log.debug("No controller, such as a "+p+", found for the "+this.type+" attempting to close."),this._Promise.resolve()):t.close()},t.prototype.toggle=function(){var t=this._controllers[0];return this.utils.isNull(t)?(this._log.debug("No controller, such as a "+p+", found for the "+this.type+" attempting to toggle."),this._Promise.resolve()):t.toggle()},t.prototype.isOpen=function(){var t=this._controllers[0];return this.utils.isNull(t)?(this._log.debug("No controller, such as a "+p+", found for the "+this.type+" attempting to check if open."),!1):t.isOpen()},t.prototype.bindTemplate=function(t,e){var i=this,s=this.bindableTemplates;return s.add(t,e),s.bind(t).then(function(t){var e=i.element;i.dom.clearNode(e),e.appendChild(t)}).catch(function(t){i._log.debug("Error binding template for "+i.type+": "+t)})},t.prototype.controllerCount=function(){return this._controllers.length},t.prototype.spliceController=function(t){var e=this._controllers,i=e.indexOf(t);-1!==i&&(this.__state=this.__nextState=e[i].isOpen(),e.splice(i,1))},t.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty)},t.prototype._setBoundProperty=function(t,e,i,s){var n=this.utils,o=this._controllers[0];if(!0===s&&n.isNull(t))this.inputChanged(!n.isNull(o)&&o.isOpen());else{var r=!!t;if(r!==t&&this.inputChanged(r),this._isInitialized)if(n.isNull(o))this.__nextState=r;else if(r){if(o.isOpen())return;o.open()}else o.isOpen()&&o.close();else this._preInitializedValue=r}},t.prototype._changeDirection=function(t){if(!this.utils.isNull(t)&&t!==this._currentPosition){var e=this.dom,i=this.element;e.removeClass(i,v+this._currentPosition),e.addClass(i,v+t),this._currentPosition=t}},t.prototype._initializeEvents=function(s,n,o){var r=this,a=this.utils,l=this.innerTemplate;this.on(tt+"_"+s,function(t,e){var i=e.control;a.isNull(i)||(a.isString(e.position)&&(n=e.position,r._changeDirection(n)),r._controllers.unshift(i),e.received||r.ready.then(function(){r.dispatchEvent(et+"_"+s,plat.events.EventManager.DIRECT,{control:r,received:!0,position:n,template:a.isNode(l)?l.cloneNode(!0):null,elastic:o,state:r.__state,nextState:r.__nextState})}),r._isInitialized=!0,e.useContext?r._checkPreInit():r.bindTemplate("drawer",l.cloneNode(!0)).then(function(){r._checkPreInit()}))}),this.dispatchEvent(et+"_"+s,plat.events.EventManager.DIRECT,{control:this,received:!1,position:n,template:a.isNode(l)?l.cloneNode(!0):null,elastic:o,state:this.__state,nextState:this.__nextState})},t.prototype._checkPreInit=function(){var e=this;if(this._preInitializedValue){var i=this.utils;i.postpone(function(){var t=e._controllers[0];i.isNull(t)||t.open()})}},t._inject={_Promise:s},t}(plat.ui.BindControl);t.Drawer=_t,plat.register.control(d,_t);var dt=function(i){function t(){var t=null!==i&&i.apply(this,arguments)||this;return t._hasSwiped=!1,t._hasTapped=!1,t._isOpen=!1,t._touchState=0,t._isVertical=!1,t._removeClickEaterListener=ot,t._toggleDelay=ot,t._isInitialized=!1,t}return __extends(t,i),t.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,p+" "+(t||""))},t.prototype.initialize=function(){this.dom.addClass(this.element,p)},t.prototype.loaded=function(){var t=(this.options||{}).value||{},e=t.position,i=t.id||"";this._type=t.type||"tap track",this._isElastic=t.elastic,this._useContext=!0===t.useContext,this._templateUrl=t.templateUrl,this._initializeEvents(i,e)},t.prototype.dispose=function(){var t=this;i.prototype.dispose.call(this);var e=this._drawer;this.utils.isNull(e)||(1<e.controllerCount()?e.spliceController(this):this._isOpen?e.ready=this.close().then(function(){e.spliceController(t),0<e.controllerCount()||t._cleanRootElement()}):e.ready.then(function(){e.spliceController(t),0<e.controllerCount()||t._cleanRootElement()}))},t.prototype.open=function(){var e=this,t=!this._isOpen,i=this.utils;this._toggleDelay();var s=new this._Promise(function(t){e._toggleDelay=i.requestAnimationFrame(function(){e._open().then(t)})});if(t){var n=this._drawer;this.inputChanged(!0),i.isNull(n)||n.inputChanged(!0)}return s},t.prototype.close=function(){var e=this,t=this._isOpen,i=this.utils;this._toggleDelay();var s=new this._Promise(function(t){e._toggleDelay=i.requestAnimationFrame(function(){e._close().then(t)})});if(t){var n=this._drawer;this.inputChanged(!1),i.isNull(n)||(n.ready=s,n.inputChanged(!1))}return s},t.prototype.toggle=function(){return this._isOpen?this.close():this.open()},t.prototype.isOpen=function(){return this._isOpen},t.prototype.bindTemplate=function(t,e){var i=this,s=this.bindableTemplates;return s.add(t,e),s.bind(t).then(function(t){var e=i._drawerElement;i.dom.clearNode(e),e.appendChild(t)}).catch(function(t){i._log.debug("Error binding template for "+i.type+": "+t)})},t.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty)},t.prototype._setBoundProperty=function(t,e,i,s){var n=this,o=this.utils;if(!0===s&&o.isNull(t))this.inputChanged(this._isOpen);else{var r=!!t;if(r!==t&&this.inputChanged(r),this._isInitialized){if(r){if(this._isOpen)return;this._toggleDelay(),this._toggleDelay=o.requestAnimationFrame(function(){n._open()})}else if(this._isOpen){this._toggleDelay();var a=new this._Promise(function(t){n._toggleDelay=o.requestAnimationFrame(function(){t(n._close())})}),l=this._drawer;o.isNull(l)||(l.ready=a)}}else this._preInitializedValue=r}},t.prototype._open=function(t){var e,i=this,s=this._rootElement,n=this.utils.isNode,o=this._isOpen,r=this._getOffset();if(o&&!t||!(r&&n(s)&&n(this._drawerElement)))return this._Promise.resolve();switch(this._position){case"left":e="translate3d("+r+"px,0,0)";break;case"right":e="translate3d("+-r+"px,0,0)";break;case"top":e="translate3d(0,"+r+"px,0)";break;case"bottom":e="translate3d(0,"+-r+"px,0)";break;default:return this._Promise.resolve()}this._isOpen=!0,this.dom.addClass(s,this._directionalTransitionPrep),o||this._addClickEater();var a={};return a[this._transform]=e,this._animationThenable=this._animator.animate(s,D,{properties:a}).then(function(){i._animationThenable=null,i._drawerElement.removeEventListener("selectstart",nt,!1)})},t.prototype._close=function(t){var e=this,i=this._rootElement,s=this.utils.isNode;if(!this._isOpen&&!t||!s(i)||!s(this._drawerElement))return this._Promise.resolve();this._isOpen=!1;var n={};return n[this._transform]=this._preTransform,this._animationThenable=this._animator.animate(i,D,{properties:n}).then(function(){e._animationThenable=null,e._drawerElement.removeEventListener("selectstart",nt,!1),e._isOpen||e._touchState<2&&e._removeClickEater()})},t.prototype._reset=function(){if(this._isOpen)return this._open(!0);var t=this._close(!0),e=this._drawer;return this.utils.isNull(e)||(e.ready=t),t},t.prototype._addClickEater=function(){var t=this,e=this._clickEater,i=e.style,s=this._rootElement;if(!s.contains(e)){i.top=s.scrollTop+"px",i.left=s.scrollLeft+"px",s.insertBefore(e,null),this.dom.addClass(this._rootElement,this._directionalTransitionPrep);var n,o=ot,r=!0;n=this.addEventListener(s,"scroll",function(){r&&(r=!1,o=t.utils.requestAnimationFrame(function(){var t=e.style;r=!0,t.top=s.scrollTop+"px",t.left=s.scrollLeft+"px"}))}),this._removeClickEaterListener=function(){o(),n()}}},t.prototype._removeClickEater=function(){var t=this._rootElement,e=this._clickEater;this._removeClickEaterListener(),t.contains(e)&&t.removeChild(e),this.dom.removeClass(t,this._directionalTransitionPrep)},t.prototype._addSwipeToggle=function(){var t=this,e=this.element,i=this.addEventListener(e,X+st[this._position],function(){t._hasSwiped=!0,t.open()},!1),s=this.addEventListener(e,X+this._position,function(){t._hasSwiped=!0,t.close()},!1);this._removeSwipeToggle=function(){i(),s()}},t.prototype._addSwipeClose=function(){var t=this;this._openSwipeRemover=this.addEventListener(this._clickEater,X+this._position,function(){t._hasSwiped=!0,t.close()},!1)},t.prototype._addTapToggle=function(){var t=this;this._removeTap=this.addEventListener(this.element,G,function(){t._hasTapped=!0,t.toggle()},!1)},t.prototype._addTapClose=function(){var t=this;this._openTapRemover=this.addEventListener(this._clickEater,G,function(){t._hasTapped=!0,t.close()},!1)},t.prototype._addEventListeners=function(){var t=this.element,e=this.utils.isNull,i=this._type.split(" "),s=this._position;if((this._isTap=-1!==i.indexOf("tap"))&&(this._addTapToggle(),this._addTapClose()),(this._isSwipe=-1!==i.indexOf("swipe"))&&(this._addSwipeToggle(),this._addSwipeClose()),this._isTrack=-1!==i.indexOf("track")){var n=this._track,o=void 0,r=this._clickEater;switch(s){case"left":case"right":o=s;break;case"top":o="up";break;case"bottom":o="down";break;default:return}var a=Q+st[o],l=Q+o,h=this.addEventListener(t,a,n,!1),u=this.addEventListener(t,l,n,!1),p=this.addEventListener(r,a,n,!1),_=this.addEventListener(r,l,n,!1);if(this._removeTrack=function(){h(),u()},this._openTrackRemover=function(){p(),_()},e(this._lastTouch)){var d=this._touchStart,c=this._touchEnd;this._lastTouch={x:0,y:0},this.addEventListener(t,W,d,!1),this.addEventListener(t,H,c,!1),this.addEventListener(t,$,c,!1),this.addEventListener(r,W,d,!1),this.addEventListener(r,$,c,!1),this.addEventListener(r,H,c,!1)}}this.addEventListener(this._window,"resize",this._handleResize,!1)},t.prototype._handleResize=function(){if(this._isOpen){var t=this.utils.isNull,e=this._rootElement,i=this._drawer;this._isOpen=!1,this.inputChanged(!1),t(e)||(e.style[this._transform]=this._preTransform),t(i)||(i.inputChanged(!1),this._drawerElement.removeEventListener("selectstart",nt,!1)),this._touchState<2&&this._removeClickEater()}},t.prototype._removeEventListeners=function(){var t=this.utils.isFunction;this._isTap&&(t(this._removeTap)&&(this._removeTap(),this._removeTap=null),t(this._openTapRemover)&&(this._openTapRemover(),this._openTapRemover=null)),this._isTrack&&(t(this._removeTrack)&&(this._removeTrack(),this._removeTrack=null),t(this._openTrackRemover)&&(this._openTrackRemover(),this._openTrackRemover=null)),this._isSwipe&&(t(this._removeSwipeToggle)&&(this._removeSwipeToggle(),this._removeSwipeToggle=null),t(this._openSwipeRemover)&&(this._openSwipeRemover(),this._openSwipeRemover=null))},t.prototype._touchStart=function(t){1!==this._touchState&&(this._touchState=1,this._lastTouch={x:t.clientX,y:t.clientY})},t.prototype._touchEnd=function(t){var e=0===this._touchState,i=this._hasSwiped,s=this._hasTapped;if(this._hasSwiped=this._hasTapped=!1,this._touchState=0,!(s||e||i)){var n=this._isVertical?t.clientY-this._lastTouch.y:t.clientX-this._lastTouch.x;if(this._isRightDirection(n)){var o=this._getOffset();if(!o)return;if(Math.abs(n)>Math.ceil(o/2))return void this.toggle();this._reset()}else this._isElastic?0<Math.abs(n)&&this._reset():this._isOpen||this._removeClickEater()}},t.prototype._track=function(t){var e=this,i=this._touchState;0!==i&&(1===i&&(this.utils.isNull(this._animationThenable)?(this._addClickEater(),this.utils.isNode(this._drawerElement)&&this._drawerElement.addEventListener("selectstart",nt,!1)):this._animationThenable.cancel().then(function(){e._addClickEater(),e.utils.isNode(e._drawerElement)&&e._drawerElement.addEventListener("selectstart",nt,!1)}),this._touchState=2),this.utils.requestAnimationFrame(function(){e._rootElement.style[e._transform]=e._calculateTranslation(t)}))},t.prototype._isRightDirection=function(t){switch(this._position){case"left":case"top":return this._isOpen?t<0:0<t;case"right":case"bottom":return this._isOpen?0<t:t<0;default:return!1}},t.prototype._calculateTranslation=function(t){var e,i=this._getOffset();if(!i)return this._preTransform;switch(this._position){case"left":return 0===(e=this._checkElasticity(i,t.clientX-this._lastTouch.x))?this._preTransform:"translate3d("+e+"px,0,0)";case"right":return 0===(e=this._checkElasticity(i,this._lastTouch.x-t.clientX))?this._preTransform:"translate3d("+-e+"px,0,0)";case"top":return 0===(e=this._checkElasticity(i,t.clientY-this._lastTouch.y))?this._preTransform:"translate3d(0,"+e+"px,0)";case"bottom":return 0===(e=this._checkElasticity(i,this._lastTouch.y-t.clientY))?this._preTransform:"translate3d(0,"+-e+"px,0)";default:return this._preTransform}},t.prototype._checkElasticity=function(t,e){var i=this._isOpen?t+e:e;return this._isElastic||(i<0?i=0:t<i&&(i=t)),i},t.prototype._initializeEvents=function(l,h){var u=this,p=this._useContext,_=this.on(et+"_"+l,function(t,e){_();var i=u.utils,s=i.isString,n=i.isUndefined,o=(u._drawer=e.control)||{},r=u._drawerElement=o.element;if(!s(h)){if(!s(e.position))return void u._log.debug('"position" is incorrectly defined for a control such as "'+d+'" or "'+u.type+'." Please ensure it is a string.');h=e.position}if(r.removeAttribute(S),u._controllerIsValid(h.toLowerCase())){u._setTransform(),u._addEventListeners(),n(u._isElastic)&&(u._isElastic=!0===e.elastic),e.received||u.dispatchEvent(tt+"_"+l,plat.events.EventManager.DIRECT,{control:u,received:!0,position:h,useContext:p}),e.state?(u._isOpen=!0,u.inputChanged(!0),!e.nextState&&i.isNull(u._preInitializedValue)&&(u._preInitializedValue=!1)):e.nextState&&i.isNull(u._preInitializedValue)&&(u._preInitializedValue=!0);var a=function(){u._isInitialized=!0,u._checkPreInit()};p?u._determineTemplate(e.template).then(a):a()}});this.dispatchEvent(tt+"_"+l,plat.events.EventManager.DIRECT,{control:this,received:!1,position:h,useContext:p})},t.prototype._checkPreInit=function(){var e=this,t=this._preInitializedValue,i=this.utils,s=i.isNull;if(!s(t)){var n=this._isOpen;if(!(n&&t||!n&&!t))if(this._toggleDelay(),t)this._toggleDelay=i.requestAnimationFrame(this._open.bind(this));else{var o=new this._Promise(function(t){e._toggleDelay=i.requestAnimationFrame(function(){t(e._close())})}),r=this._drawer;s(r)||(r.ready=o)}}},t.prototype._determineTemplate=function(t){var e=this,i=this.utils;return i.isString(this._templateUrl)?plat.ui.TemplateControl.determineTemplate(this,this._templateUrl).then(function(t){return e.bindTemplate("drawer",t)}):i.isNode(t)?this.bindTemplate("drawer",t):this._Promise.resolve()},t.prototype._setTransform=function(){var t=this._rootElement.style,e=this.utils.isUndefined,i=this._compat.vendorPrefix;e(this._preTransform=t[i.lowerCase+"Transform"])?e(this._preTransform=t[i.upperCase+"Transform"])?this._transform="transform":this._transform=i.upperCase+"Transform":this._transform=i.lowerCase+"Transform"},t.prototype._controllerIsValid=function(t){var e=this.utils.isNull;if(e(this._drawerElement))return this._log.debug('Could not find a corresponding control such as "'+d+'" for this "'+this.type+'."'),!1;switch(t){case"top":case"bottom":this._isVertical=!0;case"left":case"right":this._position=t;break;default:return this._log.debug('Incorrect position: "'+t+'" defined for the a control such as a "'+d+'", or "'+this.type+'."'),!1}var i=this._rootElement=this._getRootElement();if(e(i))return this._log.debug('Cannot have a "'+this.type+'" in a hierarchy above the corresponding control such as "'+d+'."'),!1;var s=this.dom;return s.addClass(i,d+"-root"),s.addClass(this.element,this._isVertical?v+"vertical":v+"horizontal"),this._directionalTransitionPrep=d+"-transition-"+t,this._clickEater=this._document.createElement("div"),this._clickEater.className=v+"clickeater",this._styleRootElement(),!0},t.prototype._getRootElement=function(){var t=this._drawer,e=this.utils;if(!e.isNull(t.storedProperties))return t.storedProperties.rootElement;for(var i,s=e.isNode,n=this.root,o=e.isObject(n)&&s(n.element)?n.element:this.element,r=this._drawerElement;s(i=o.parentElement)&&!i.contains(r);)o=i;return o},t.prototype._styleRootElement=function(){var t=this._window,e=this.utils,i=this._drawer,s=this._rootElement,n=s.parentElement,o=t.getComputedStyle(s),r=s.style,a=o.position,l=Number(o.zIndex),h={rootElement:s};if("static"===a&&(h.position=r.position,r.position="relative"),(!e.isNumber(l)||l<1)&&(h.zIndex=r.zIndex,r.zIndex="1"),e.isNode(n)){var u=t.getComputedStyle(n);if("hidden"!==u.overflow){var p=void 0;if("hidden"!==(this._isVertical?(p="overflowY",u.overflowY):(p="overflowX",u.overflowX))){var _=n.style;h.parentOverflow={key:p,value:_[p]},_[p]="hidden"}}}i.storedProperties=h},t.prototype._cleanRootElement=function(){var t=this.utils,e=t.isObject,i=t.isNode,s=this._rootElement,n=this._drawer;if(i(s)&&(this.dom.removeClass(s,d+"-root "+this._directionalTransitionPrep),!t.isNull(n))){var o=n.storedProperties;if(e(o)){var r=s.style,a=s.parentElement,l=o.parentOverflow;r.position=o.position,r.zIndex=o.zIndex,e(l)&&i(a)&&(a.style[l.key]=l.value),delete n.storedProperties,this._drawerElement.setAttribute(S,"")}}},t.prototype._getOffset=function(){return this._isVertical?this._drawerElement.offsetHeight:this._drawerElement.offsetWidth},t._inject={_document:r,_window:o,_compat:n,_animator:a,_Promise:s},t}(plat.ui.BindControl);t.DrawerController=dt,plat.register.control(p,dt);var ct=function(e){function t(){var i=e.call(this)||this;i._isVisible=!1,i._scrollRemover=ot,i._presenceRemover=ot,i._scrollTop=0,i._transitionHash={up:!0,down:!0,left:!0,right:!0,fade:!0},i.__templateString='<div class="plat-modal-container"></div>\n',i.templateString=i.__templateString;var t=i._Promise;return i._showingPromise=t.resolve(),i._hidingPromise=t.resolve(),i.modalLoaded=new t(function(t,e){i.__resolveFn=t,i.__rejectFn=e}).catch(ot),i}return __extends(t,e),t.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,_+" "+S+" "+(t||""))},t.prototype.initialize=function(){var t=this.options||(this.options={}),e=t.value||(t.value={});this.templateUrl=e.templateUrl||this.templateUrl,this.setClasses()},t.prototype.setTemplate=function(){if(this.templateString!==this.__templateString||this.utils.isString(this.templateUrl)){var t=this.dom,e=t.serializeHtml(this.__templateString),i=this.element;this._container=e.firstChild;this.innerTemplate=t.appendChildren(i.childNodes),i.appendChild(e)}},t.prototype.loaded=function(){var t=this.options.value.transition,e=this.element;if(this._container=this._container||e.firstElementChild,this._presenceRemover=this.dom.whenPresent(this._injectElement.bind(this),e),this.utils.isString(t)&&"none"!==t){this._transitionHash[t]||this._log.debug('Custom transition: "'+t+'" defined for "'+this.type+'." Please ensure the transition is defined to avoid errors.');var i=this._compat.animationEvents;if(this.utils.isNull(i))return this._log.debug("This browser does not support CSS3 animations."),void this.dom.addClass(this._container,v+"no-transition");this._transitionEnd=i.$transitionEnd,this.dom.addClass(this._container,v+t+" "+v+"modal-transition")}else this.dom.addClass(this._container,v+"no-transition")},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._scrollRemover(),this._presenceRemover(),this.utils.isFunction(this.__rejectFn)&&(this.__rejectFn(),this.__rejectFn=this.__resolveFn=null),this._hidingPromise=this._showingPromise=null},t.prototype.show=function(){var t=!this._isVisible,e=this._show();return t&&this.inputChanged(!0),e},t.prototype.hide=function(){var t=this.isVisible,e=this._hide();return t&&this.inputChanged(!1),e},t.prototype.toggle=function(){return this._isVisible?this.hide():this.show()},t.prototype.isVisible=function(){return this._isVisible},t.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty)},t.prototype._setBoundProperty=function(t,e,i,s){var n=this.utils;if(!0===s&&n.isNull(t))this.inputChanged(this._isVisible);else if(n.isBoolean(t)){if(t){if(this._isVisible)return;return void this._show()}this._isVisible&&this._hide()}else this._log.debug("Attempting to show or hide a "+this.type+" with a bound value that is something other than a boolean.")},t.prototype._show=function(){var e=this,i=this.dom,s=this.utils;return s.isNull(this.innerTemplate)?this._isVisible?this._showingPromise:(this._isVisible=!0,this._showingPromise=new this._Promise(function(t){s.requestAnimationFrame(function(){e._alignModal(),i.removeClass(e.element,S),s.defer(function(){s.requestAnimationFrame(function(){i.addClass(e._container,v+"activate"),t()})},20)})})):this._bindInnerTemplate()},t.prototype._alignModal=function(t){var e=this,i=this.utils,s=i.isNull,n=this._document,o=n.documentElement,r=(s(o)||!o.scrollTop?n.body:o).scrollTop;this._scrollTop!==r&&(s(t)?(this.element.style.top=r+"px",this._scrollRemover=this.addEventListener(this._window,"scroll",this._alignModal,!1)):i.requestAnimationFrame(function(){e.element.style.top=r+"px"}),this._scrollTop=r)},t.prototype._hide=function(){var t,e=this,i=this.dom,s=this.utils;return this._isVisible?(this._scrollRemover(),this._scrollRemover=ot,this._isVisible=!1,s.isString(this._transitionEnd)?(t=this._addHideOnTransitionEnd(),s.requestAnimationFrame(function(){i.removeClass(e._container,v+"activate")})):t=new this._Promise(function(t){s.requestAnimationFrame(function(){i.addClass(e.element,S),i.removeClass(e._container,v+"activate"),t()})}),this._hidingPromise=t):this._hidingPromise},t.prototype._bindInnerTemplate=function(){var e=this,t=this.innerTemplate;return this.innerTemplate=null,this.bindableTemplates.once(t).then(function(t){return e._container.insertBefore(t,null),e.utils.isFunction(e.__resolveFn)&&(e.__resolveFn(),e.__resolveFn=e.__rejectFn=null),e._show()})},t.prototype._injectElement=function(){var t=this.element,e=t.parentElement,i=this._document.body;this.utils.isNode(e)&&e!==i&&i.insertBefore(t,null)},t.prototype._addHideOnTransitionEnd=function(){var s=this;return new this._Promise(function(t){var e=s.element,i=s.addEventListener(e,s._transitionEnd,function(){i(),s.dom.addClass(e,S),t()},!1)})},t._inject={_window:o,_document:r,_compat:n,_Promise:s},t}(plat.ui.BindControl);t.Modal=ct,plat.register.control(_,ct);var ft=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.templateString='<div class="plat-slider-container">\n    <div class="plat-slider-track">\n        <div class="plat-knob"></div>\n    </div>\n</div>\n',t._isVertical=!1,t._knobOffset=0,t._touchState=0,t._removeVisibilityListener=ot,t}return __extends(t,e),t.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,y+" "+(t||""))},t.prototype.initialize=function(){this.setClasses()},t.prototype.loaded=function(){var t=this.element,e=this._slider=t.firstElementChild.firstElementChild,i=this.utils.isNumber,s=(this.options||{}).value||{},n=Number(s.value),o=s.min,r=s.max,a=s.step,l=this._reversed=!0===s.reverse,h=this.min=i(o)?Math.floor(o):0,u=this.max=i(r)?Math.ceil(r):100,p=i(n)?Math.round(n):h,_=v+this._validateOrientation(s.orientation);this._knob=e.firstElementChild,l&&(_+=it),this.dom.addClass(t,_),this.value=h,this._step=i(a)&&0<a?Math.round(a):1,u<=h&&(this._log.debug('"'+this.type+"'s\" min is greater than or equal to its max. Setting max to min + 1."),this.max=h+1),this._setLength(),this._initializeEvents(),this.setValue(p)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._removeVisibilityListener(),this._sliderVisible=null},t.prototype.setValue=function(t){this._setValue(t,!0)},t.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty)},t.prototype._setBoundProperty=function(t,e,i,s){this._setValue(t,!1)},t.prototype._setValue=function(t,e){var i=this.utils;if(1!==this._touchState){if(i.isNull(t)&&(t=this.min,e=!0),!i.isNumber(t)){var s=Number(t);if(!i.isNumber(s))return void this._log.warn(this.type+" has its value bound to a property that cannot be interpreted as a Number.");t=s,e=!0}this._setValueProperty(t,!0,e)}else this._log.debug("Cannot set the value of "+this.type+" while the user is manipulating it.")},t.prototype._initializeEvents=function(){var t,e,i=this,s=this.element,n=this._track,o=this._touchEnd;e=this._isVertical?(t=Q+"down",Q+"up"):(t=Q+"right",Q+"left"),this.addEventListener(s,W,this._touchStart,!1),this.addEventListener(s,t,n,!1),this.addEventListener(s,e,n,!1),this.addEventListener(s,H,o,!1),this.addEventListener(s,$,o,!1),this.addEventListener(this._window,"resize",function(){i.utils.isNull(i._sliderVisible)&&(i._setLength(),i._setKnob())},!1)},t.prototype._touchStart=function(t){var e=this;if(1!==this._touchState){this._touchState=1,this._lastTouch={x:t.clientX,y:t.clientY,value:this.value};var i,s=t.target;if(s!==this._knob)i=this._isVertical?s===this.element?this._reversed?t.offsetY-this._sliderOffset:this._maxOffset-(t.offsetY-this._sliderOffset):s===this._slider?this._reversed?t.offsetY:this._knobOffset-t.offsetY:this._reversed?t.offsetY:this._maxOffset-t.offsetY:s===this.element?this._reversed?this._maxOffset-(t.offsetX-this._sliderOffset):t.offsetX-this._sliderOffset:s===this._slider?this._reversed?this._knobOffset-t.offsetX:t.offsetX:this._reversed?this._maxOffset-t.offsetX:t.offsetX,this.utils.requestAnimationFrame(function(){e._knobOffset=e._setSliderProperties(i)})}},t.prototype._touchEnd=function(t){var e=this;if(1===this._touchState){this._touchState=2;var i=this._calculateOffset(t),s=this._maxOffset;this.utils.requestAnimationFrame(function(){e._touchState=0,e._lastTouch.value!==e.value&&e._trigger("change"),e._knobOffset=i<0?0:s<i?s:i})}else this._touchState=0},t.prototype._track=function(t){var e=this;0!==this._touchState&&this.utils.requestAnimationFrame(function(){e._setSliderProperties(e._calculateOffset(t))})},t.prototype._setSliderProperties=function(t){var e,i=this._maxOffset;if(t<=0){if((t=0)<=(e=this.min)-this.value)return t}else if(i<=t){if(t=i,(e=this.max)-this.value<=0)return t}else e=this._calculateValue(t);return this._setValueProperty(e,!1,!0),this._slider.style[this._lengthProperty]=t+"px",t},t.prototype._calculateValue=function(t){var e=this._step;return this.min+Math.round(t/this._increment/e)*e},t.prototype._calculateKnobPosition=function(t){return(t-this.min)*this._increment},t.prototype._calculateOffset=function(t){return this._isVertical?this._reversed?this._knobOffset+t.clientY-this._lastTouch.y:this._knobOffset+this._lastTouch.y-t.clientY:this._reversed?this._knobOffset+this._lastTouch.x-t.clientX:this._knobOffset+t.clientX-this._lastTouch.x},t.prototype._setLength=function(){var e=this,i=this._slider.parentElement;this._isVertical?(this._lengthProperty="height",this._maxOffset=i.clientHeight,this._sliderOffset=i.offsetTop):(this._lengthProperty="width",this._maxOffset=i.clientWidth,this._sliderOffset=i.offsetLeft),this._maxOffset?this._setIncrement():this._sliderVisible=new this._Promise(function(t){e._removeVisibilityListener=e.dom.whenVisible(function(){e._sliderVisible=null,e._setLength(),t()},i)})},t.prototype._setIncrement=function(){return this._increment=this._maxOffset/(this.max-this.min)},t.prototype._setValueProperty=function(t,e,i){var s=this.value;if(t!==s){if(t>=this.max)t=this.max;else if(t<=this.min)t=this.min;else if(Math.abs(t-s)<this._step)return;this.value=this.element.value=t,e&&this._setKnob(),i&&this.inputChanged(t,s),this._trigger("input")}},t.prototype._setKnob=function(i){var s=this;this._Promise.resolve(this._sliderVisible).then(function(){var t={},e=s._calculateKnobPosition(i||s.value);e!==s._knobOffset&&(t[s._lengthProperty]=e+"px",s._animator.animate(s._slider,D,{properties:t}),s._knobOffset=e)})},t.prototype._trigger=function(t){var e=plat.acquire(i);e.initialize(this.element,t),e.trigger()},t.prototype._validateOrientation=function(t){return this.utils.isUndefined(t)?"horizontal":("horizontal"===t?e=t:"vertical"===t?(e=t,this._isVertical=!0):(this._log.debug('Invalid orientation "'+t+'" for '+this.type+'. Defaulting to "horizontal."'),e="horizontal"),e);var e},t._inject={_document:r,_window:o,_Promise:s,_animator:a},t}(plat.ui.BindControl);t.Slider=ft,plat.register.control(y,ft);var mt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.templateString='<div class="plat-range-container">\n    <div class="plat-range-track">\n        <div class="plat-lower-knob"></div>\n        <div class="plat-upper-knob"></div>\n    </div>\n</div>\n',t._isVertical=!1,t._touchState=0,t._removeVisibilityListener=ot,t._forceFirstTime=!1,t}return __extends(t,e),t.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,b+" "+(t||""))},t.prototype.initialize=function(){this.setClasses()},t.prototype.loaded=function(){var t=this.element,e=this._slider=t.firstElementChild.firstElementChild,i=this.utils.isNumber,s=(this.options||{}).value||{},n=Number(s.lower),o=Number(s.upper),r=s.identifiers||{},a=s.min,l=s.max,h=s.step,u=this._reversed=!0===s.reverse,p=this.min=i(a)?Math.floor(a):0,_=this.max=i(l)?Math.ceil(l):100,d=i(n)?Math.round(n):p,c=i(o)?Math.round(o):_,f=v+this._validateOrientation(s.orientation);if(this._lowerKnob=e.firstElementChild,this._upperKnob=e.lastElementChild,this._lowerIdentifier=r.lower||"lower",this._upperIdentifier=r.upper||"upper",u){var m=this._lowerKnob;this._lowerKnob=this._upperKnob,this._upperKnob=m,f+=it}this.dom.addClass(t,f),this.lower=p,this.upper=_,this._step=i(h)&&0<h?Math.round(h):1,_<=p&&(this._log.debug('"'+this.type+"'s\" min is greater than or equal to its max. Setting max to min + 1."),this.max=p+1),this._setPositionAndLength(),this._setLowerKnobPosition(p),this._initializeEvents(),this.setLower(d),this.setUpper(c)},t.prototype.setLower=function(t){this._setLower(t,!0)},t.prototype.setUpper=function(t){this._setUpper(t,!0)},t.prototype.observeProperties=function(t){t.observeProperty(this._setLowerBoundProperty,this._lowerIdentifier),t.observeProperty(this._setUpperBoundProperty,this._upperIdentifier)},t.prototype._setLowerBoundProperty=function(t,e,i,s){this._setLower(t,!1,s)},t.prototype._setUpperBoundProperty=function(t,e,i,s){this._setUpper(t,!1,s)},t.prototype._setLower=function(t,e,i){var s=this.utils;if(2!==this._touchState){if(s.isNull(t)&&(t=this.min,!0===i?this._forceFirstTime=!0:e=!0),!s.isNumber(t)){var n=Number(t);if(!s.isNumber(n))return void this._log.warn(this.type+" has its lower value bound to a property that cannot be interpreted as a Number.");t=n,!0===i?this._forceFirstTime=!0:e=!0}this._setLowerValue(t,!0,e,!0)}else this._log.debug("Cannot set the value of the "+this.type+"'s lower knob while the user is manipulating it.")},t.prototype._setUpper=function(t,e,i){var s=this.utils;if(3!==this._touchState){if(s.isNull(t)&&(t=this.max,e=!0),!s.isNumber(t)){var n=Number(t);if(!s.isNumber(n))return void this._log.warn(this.type+" has its upper value bound to a property that cannot be interpreted as a Number.");t=n,e=!0}this._setUpperValue(t,!0,e||!0===i&&this._forceFirstTime,!0)}else this._log.debug("Cannot set the value of the "+this.type+"'s upper knob while the user is manipulating it.")},t.prototype._initializeEvents=function(){var t,e,i=this,s=this._lowerKnob,n=this._upperKnob,o=this._touchStart,r=this._touchEnd,a=this._trackLower,l=this._trackUpper;e=this._isVertical?(t=Q+"down",Q+"up"):(t=Q+"right",Q+"left"),this.addEventListener(s,W,o,!1),this.addEventListener(n,W,o,!1),this.addEventListener(s,t,a,!1),this.addEventListener(s,e,a,!1),this.addEventListener(n,t,l,!1),this.addEventListener(n,e,l,!1),this.addEventListener(s,H,r,!1),this.addEventListener(n,H,r,!1),this.addEventListener(s,$,r,!1),this.addEventListener(n,$,r,!1),this.addEventListener(this._window,"resize",function(){i.utils.isNull(i._rangeVisible)&&(i._setPositionAndLength(),i._setLowerKnobPosition(),i._setUpperKnobPosition())},!1)},t.prototype._touchStart=function(t){var e=this._touchState;if(1!==e&&2!==e&&3!==e){this._touchState=1;var i=t.currentTarget,s=this._lastTouch;if(this.utils.isNull(s))this.dom.addClass(i,v+"top");else if(s.target!==i){var n=this.dom;n.addClass(i,v+"top"),n.removeClass(s.target,v+"top")}this._lastTouch={x:t.clientX,y:t.clientY,value:i===this._lowerKnob?this.lower:this.upper,target:i}}},t.prototype._touchEnd=function(i){var s=this,t=this._touchState;if(0!==t&&4!==t){this._touchState=4;var n=this._lastTouch,o=i.currentTarget;this.utils.isNull(n)||n.target!==o||this.utils.requestAnimationFrame(function(){s._touchState=0;var t=o===s._lowerKnob,e=s._calculateOffset(i,t);t?n.value!==s.lower&&s._trigger("change"):n.value!==s.upper&&s._trigger("change"),s._setOffset(e,t)})}else this._touchState=0},t.prototype._setOffset=function(t,e){var i=this._maxOffset;return t<0?e?this._lowerKnobOffset=0:this._upperKnobOffset=0:i<t?e?this._lowerKnobOffset=i:this._upperKnobOffset=i:e?this._lowerKnobOffset=t:this._upperKnobOffset=t},t.prototype._trackLower=function(t){var e=this._touchState;if(2!==e)if(1===e)this._touchState=2;else if(0===e||3===e)return;var i,s=this._maxOffset,n=this._calculateOffset(t,!0);if(n<=0?(0<=(i=this.min)-this.lower&&(i=null),n=0):s<=n?((i=this.max)-this.lower<=0&&(i=null),n=s):(i=this._calculateValue(n))-this.lower==0&&(i=null),n>this._upperKnobOffset)return this._positionTogether(n,i),void this._setOffset(n,!1);this._positionLower(n,i)},t.prototype._trackUpper=function(t){var e=this._touchState;if(3!==e)if(1===e)this._touchState=3;else if(0===e||2===e)return;var i,s=this._maxOffset,n=this._calculateOffset(t,!1);if(n<=0?(0<=(i=this.min)-this.upper&&(i=null),n=0):s<=n?((i=this.max)-this.upper<=0&&(i=null),n=s):(i=this._calculateValue(n))-this.upper==0&&(i=null),n<this._lowerKnobOffset)return this._positionTogether(n,i),void this._setOffset(n,!0);this._positionUpper(n,i)},t.prototype._positionLower=function(e,i){var s=this;this.utils.requestAnimationFrame(function(){var t=s._slider.style;t[s._positionProperty]=e+"px",t[s._lengthProperty]=s._upperKnobOffset-e+"px",null!==i&&s._setLowerValue(i,!1,!0,!0)})},t.prototype._positionUpper=function(t,e){var i=this;this.utils.requestAnimationFrame(function(){i._slider.style[i._lengthProperty]=t-i._lowerKnobOffset+"px",null!==e&&i._setUpperValue(e,!1,!0,!0)})},t.prototype._positionTogether=function(e,i){var s=this;this.utils.requestAnimationFrame(function(){var t=s._slider.style;t[s._positionProperty]=e+"px",t[s._lengthProperty]="0px",null!==i&&(s._setLowerValue(i,!1,!1,!1),s._setUpperValue(i,!1,!0,!0))})},t.prototype._calculateValue=function(t){var e=this._step;return this.min+Math.round(t/this._increment/e)*e},t.prototype._calculateOffset=function(t,e){return(e?this._lowerKnobOffset:this._upperKnobOffset)+(this._isVertical?this._reversed?t.clientY-this._lastTouch.y:this._lastTouch.y-t.clientY:this._reversed?this._lastTouch.x-t.clientX:t.clientX-this._lastTouch.x)},t.prototype._calculateKnobPosition=function(t){return(t-this.min)*this._increment},t.prototype._setLowerValue=function(t,e,i,s){var n=this.lower;if(t!==n){if(t>=this.max)t=this.max;else if(t<=this.min)t=this.min;else if(Math.abs(t-n)<this._step)return;this.lower=t,e&&this._setLowerKnobPosition(),i&&this._fireChange(),s&&this._trigger("input")}},t.prototype._setUpperValue=function(t,e,i,s){var n=this.upper;if(t!==n){if(t>=this.max)t=this.max;else if(t<=this.min)t=this.min;else if(Math.abs(t-n)<this._step)return;this.upper=t,e&&this._setUpperKnobPosition(),i&&this._fireChange(),s&&this._trigger("input")}},t.prototype._setIncrement=function(){return this._increment=this._maxOffset/(this.max-this.min)},t.prototype._setPositionAndLength=function(){var e=this,i=this._slider.parentElement;this._isVertical?(this._lengthProperty="height",this._positionProperty=this._reversed?"top":"bottom",this._maxOffset=i.clientHeight):(this._lengthProperty="width",this._positionProperty=this._reversed?"right":"left",this._maxOffset=i.clientWidth),this._maxOffset?this._setIncrement():this._rangeVisible=new this._Promise(function(t){e._removeVisibilityListener=e.dom.whenVisible(function(){e._rangeVisible=null,e._setPositionAndLength(),t()},i)})},t.prototype._setLowerKnobPosition=function(n){var o=this;this._Promise.resolve(this._rangeVisible).then(function(){var t={},e=o._upperKnobOffset,i=o.utils.isNumber(e)?e:o._setOffset(o._calculateKnobPosition(o.upper),!1),s=o._calculateKnobPosition(n||o.lower);s!==o._lowerKnobOffset&&(t[o._positionProperty]=s+"px",t[o._lengthProperty]=i-s+"px",o._animator.animate(o._slider,D,{properties:t}),o._lowerKnobOffset=s)})},t.prototype._setUpperKnobPosition=function(i){var s=this;this._Promise.resolve(this._rangeVisible).then(function(){var t={},e=s._calculateKnobPosition(i||s.upper);e!==s._upperKnobOffset&&(t[s._lengthProperty]=e-s._lowerKnobOffset+"px",s._animator.animate(s._slider,D,{properties:t}),s._upperKnobOffset=e)})},t.prototype._fireChange=function(){var t={};t[this._lowerIdentifier]=this.lower,t[this._upperIdentifier]=this.upper,this.inputChanged(t)},t.prototype._trigger=function(t){var e=plat.acquire(i);e.initialize(this.element,t),e.trigger()},t.prototype._validateOrientation=function(t){return this.utils.isUndefined(t)?"horizontal":("horizontal"===t?e=t:"vertical"===t?(e=t,this._isVertical=!0):(this._log.debug('Invalid orientation "'+t+'" for '+this.type+'. Defaulting to "horizontal."'),e="horizontal"),e);var e},t._inject={_document:r,_window:o,_Promise:s,_animator:a},t}(plat.ui.BindControl);t.Range=mt,plat.register.control(b,mt);var vt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,C+" "+(t||""))},e.prototype.initialize=function(){t.prototype.initialize.call(this),this.setClasses()},e}(plat.ui.controls.Select);t.Select=vt,plat.register.control(C,vt);var gt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.replaceWith="input",t.value="",t}return __extends(t,e),t.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,x+" "+(t||""))},t.prototype.initialize=function(){this.setClasses()},t.prototype.setTemplate=function(){this.dom.clearNode(this.element)},t.prototype.loaded=function(){var t=(this.options||{}).value||{},e=t.pattern,i=t.validation,s=this.utils.isString;this._type=this.attributes.type||t.type||"text",s(e)&&""!==e&&("/"===e[0]&&"/"===e[e.length-1]&&(e=e.slice(1,-1)),this._pattern=new RegExp(e)),s(i)&&""!==i&&("/"===i[0]&&"/"===i[i.length-1]&&(i=i.slice(1,-1)),this._validation=new RegExp(i)),this._initializeType()},t.prototype.validate=function(){return this._validation.test(this.element.value)},t.prototype.clear=function(){var t=this.element,e=t.value;""!==e&&(t.value=this.value="",this.inputChanged(this.value,e))},t.prototype.focus=function(){this.element.focus()},t.prototype.blur=function(){this.element.blur()},t.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty,null,!0)},t.prototype._setBoundProperty=function(t,e,i,s){var n=this.element.value;if(this.utils.isNull(t)){if(!(t="")===s)return void(this.utils.isNull(n)&&this._onInputChanged(t))}else if(t===n)return;this._onInputChanged(t)},t.prototype._initializeType=function(){var t=this._type;switch(t){case"text":this._pattern=this._pattern||/[\S\s]*/,this._validation=this._validation||this._pattern;break;case"email":this._pattern=this._pattern||/[\S\s]*/,this._validation=this._validation||this._regex.validateEmail;break;case"password":this._pattern=this._pattern||/[\S\s]*/,this._validation=this._validation||this._pattern;break;case"telephone":t="tel";case"tel":this._pattern=this._pattern||this._regex.validateTelephone,this._validation=this._validation||this._pattern;break;case"number":this._pattern=this._pattern||/^[0-9\.,]*$/,this._validation=this._validation||this._pattern,t="tel";break;case"hidden":return void this.element.setAttribute(S,"");case"radio":return void this._log.debug(t+" is not supported by "+this.type+". Please use a "+m+" instead.");case"checkbox":return void this._log.debug(t+" is not supported by "+this.type+". Please use a "+u+" instead.");case"range":return void this._log.debug(t+" is not supported by "+this.type+". Please use a "+y+" instead.");case"file":return void this._log.debug(t+" is not supported by "+this.type+". Please use a "+T+" instead.");default:this._log.debug(t+" is not yet fully supported by "+this.type+'. Defaulting to type="text".'),t="text",this._pattern=this._pattern||/[\S\s]*/,this._validation=this._validation||this._pattern}this._addTextEventListener()},t.prototype._addTextEventListener=function(){var t,n=this,o=this.element,e=this._compat,i=this.utils,s=!1,r=function(){s||n._onInput()},a=function(){i.isFunction(t)||(t=i.postpone(function(){r(),t=null}))};i.isUndefined(e.ANDROID)&&(this.addEventListener(o,"compositionstart",function(){return s=!0},!1),this.addEventListener(o,"compositionend",function(){s=!1,r()},!1)),e.hasEvent("input")?this.addEventListener(o,"input",r,!1):(this.addEventListener(o,"keydown",function(t){var e=t.keyCode;if(!(91===e||92===e||15<e&&e<28||32<e&&e<41)){var i=n._pattern,s=t.char;i.test(s)&&i.test(o.value+s)?a():t.preventDefault()}},!1),this.addEventListener(o,"cut",a,!1),this.addEventListener(o,"paste",a,!1)),this.addEventListener(o,"change",r,!1)},t.prototype._onInput=function(){var t=this.element,e=t.value,i=this._stripInput(t.value);e!==i&&(e=t.value=i),e!==this.value&&(this.value=t.value,this.inputChanged(this.value))},t.prototype._onInputChanged=function(t){var e=this.element;t=this._stripInput(t),e.value=t,this.value=e.value},t.prototype._stripInput=function(t){for(var e,i="",s=i,n=this._pattern,o=t.length,r=0;r<o;++r)e=t[r],n.test(e)&&(i+=e,n.test(i)?s=i:i=s);return i},t._inject={_compat:n,_regex:"$Regex"},t}(plat.ui.BindControl);t.Input=gt,plat.register.control(x,gt);var yt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.templateString='<div class="plat-file-container">\n    <input type="file" class="plat-file-hidden" />\n    <input type="text" class="plat-file-input" plat-keydown="_onKeyDown" />\n    <button class="plat-file-button" plat-tap="_selectFiles"></button>\n</div>\n',t._removeListener=ot,t}return __extends(t,e),t.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,T+" "+(t||""))},t.prototype.initialize=function(){this.setClasses()},t.prototype.setTemplate=function(){for(var t,e,i,s=this.element,n=this._hiddenInput=s.firstElementChild.firstElementChild,o=this._visibleInput=n.nextElementSibling,r=o.nextElementSibling,a=this.attributes,l=Object.keys(a),h=l.length,u=plat.dependency.injectors.control,p=/plat-(?:control|hide|context)|class|style/,_=!1,d=this.utils,c=d.isNull,f=d.delimit,m=d.isString,v=0;v<h;++v)e=f(t=l[v],"-"),m(i=a[t])&&!p.test(e)&&c(u[e])?"id"===e?(s.removeAttribute(e),n.setAttribute(e,i)):"multiple"===e?(_=!0,n.setAttribute(e,i)):"disabled"===e?(n.setAttribute(e,i),o.setAttribute(e,i),r.setAttribute(e,i)):n.setAttribute(e,i):"plat-disabled"===e&&(n.setAttribute(e,i),o.setAttribute(e,i),r.setAttribute(e,i));if(c(this.innerTemplate))r.textContent=_?"Select files":"Select a file";else{var g=this.innerTemplate.textContent.replace(/\r|\n/g,"");d.isEmpty(g)?r.textContent=_?"Select files":"Select a file":r.textContent=g}},t.prototype.loaded=function(){var t=this._hiddenInput=this._hiddenInput||this.element.firstElementChild.firstElementChild;this._visibleInput=this._visibleInput||t.nextElementSibling,this._addChangeListener()},t.prototype.validate=function(){return!this.utils.isEmpty(this._hiddenInput.value)},t.prototype.clear=function(){var t=this._hiddenInput;if(!this.utils.isEmpty(t.value)){t.value=null;var e=this._hiddenInput=t.cloneNode(!0);this.element.firstElementChild.replaceChild(e,t),this._addChangeListener(),this._visibleInput.value="",this.inputChanged(null),this._trigger("change")}},t.prototype.click=function(){this._selectFiles()},t.prototype.value=function(){var t=this._hiddenInput,e=t.files;if(!this.utils.isNull(e))return t.multiple?Array.prototype.slice.call(e):e[0]},t.prototype.disable=function(){var t="disabled",e=this._visibleInput;this._hiddenInput.setAttribute(t,t),e.setAttribute(t,t),e.nextElementSibling.setAttribute(t,t),this.element.setAttribute(t,t)},t.prototype.enable=function(){var t="disabled",e=this._visibleInput;this._hiddenInput.removeAttribute(t),e.removeAttribute(t),e.nextElementSibling.removeAttribute(t),this.element.removeAttribute(t)},t.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty)},t.prototype._setBoundProperty=function(t,e,i,s){var n=this.utils;if(n.isFile(t)){var o=this._hiddenInput,r=o.files;n.isNull(r)||(o.multiple?(this.inputChanged(Array.prototype.slice.call(r)),this._trigger("change")):t!==r[0]&&(this.inputChanged(r[0]),this._trigger("change")))}else this.clear()},t.prototype._addChangeListener=function(){this._removeListener(),this._removeListener=this.addEventListener(this._hiddenInput,"change",this._filesSelected,!1)},t.prototype._onKeyDown=function(t){var e=t.keyCode,i=plat.controls.KeyCodes;return e===i.tab||(e!==i.backspace&&e!==i.delete||this.clear(),t.preventDefault(),!1)},t.prototype._selectFiles=function(){this._hiddenInput.click()},t.prototype._filesSelected=function(){var t=this._hiddenInput,e=this._visibleInput,i=t.files;if(this.utils.isEmpty(i))this.clear();else{if(t.multiple){for(var s=[],n=i.length,o=0;o<n;++o)s.push(i[o].name);e.value=s.join(", "),this.inputChanged(Array.prototype.slice.call(i))}else{var r=i[0];e.value=r.name,this.inputChanged(r)}this._trigger("change")}},t.prototype._trigger=function(t){var e=plat.acquire(i);e.initialize(this.element,t),e.trigger()},t._inject={_compat:n},t}(plat.ui.BindControl);t.File=yt,plat.register.control(T,yt);var bt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.templateString='<div class="plat-carousel-viewport">\n    <div class="plat-carousel-container"></div>\n</div>\n',t._listeners=[],t._isVertical=!1,t._hasSwiped=!1,t._inTouch=!1,t._hasMoved=!1,t._lastTouch={x:0,y:0},t._loaded=!1,t._index=-1,t._previousIndex=-1,t._nextIndex=-1,t._currentOffset=0,t._removeInterval=ot,t._removeSuspend=ot,t._isAuto=!1,t._isPaused=!1,t._selfPause=!1,t._itemNodes=[],t._removeListeners=[],t._outerStart=!1,t._outerEnd=!1,t._goToIntervalConstant=125,t}return __extends(t,e),Object.defineProperty(t.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),t.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,w+" "+(t||""))},t.prototype.contextChanged=function(t,e){var i=this.utils;if(i.isFunction(this._onLoad))return i.isArray(t)?this._setListener():(this._log.debug(this.type+" context set to something other than an Array."),t=[]),this._executeEvent([{object:t,type:"splice"}]),void this._initializeIndex(0);this.loaded()},t.prototype.initialize=function(){this.setClasses()},t.prototype.setTemplate=function(){var t=this._document.createElement("div");t.className=w+"-item",t.appendChild(this.innerTemplate),this.bindableTemplates.add("item",t)},t.prototype.loaded=function(){var e=this,t=this.utils,i=this.context;if(t.isArray(i)){this._animate=!1;var s,n=(this.options||{}).value||{},o=n.index,r=t.isNumber,a=this._validateOrientation(n.orientation),l=n.interval,h=this._interval=r(l)?Math.abs(l):3e3,u=n.suspend,p=this.dom,_=this.element,d=this._viewport=_.firstElementChild;switch(n.transition){case"fade":s="fade",this._fade=1;break;case"fade-in":s="fade",this._fade=2;break;case"fade-out":s="fade",this._fade=3;break;default:s="translate",this._fade=0}this._container=d.firstElementChild,this._type=n.type||"track swipe",this._isInfinite=!0===n.infinite,this._suspend=Math.abs(r(u)?h-u:h-3e3),p.addClass(_,v+a+" "+(v+s)),this._onLoad=function(){var t=e._index;o=r(o)&&0<=o?o<i.length?o:i.length-1:null,e._index=0,p.whenVisible(function(){e._initializeIndex(null===o?t:o),e._addEventListeners(),e._loaded=!0},_)},this._init()}else this._log.warn("The context of a "+this.type+" must be an Array.")},t.prototype.goToNext=function(){return this._goToNext(!1)},t.prototype.goToPrevious=function(){return this._goToPrevious(!1)},t.prototype.goToIndex=function(t,e){return this._goToIndex(t,!1,e)},t.prototype.pause=function(){this._selfPause=!1,this._isAuto&&!this._isPaused&&(this._isPaused=!0,this._removeSuspend(),this._removeSuspend=ot,this._removeInterval(),this._removeInterval=ot)},t.prototype.resume=function(){this._isAuto&&this._isPaused&&(this._isPaused=this._selfPause=!1,this._initiateInterval())},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._listeners=[],this._removeEventListeners()},t.prototype.onInput=function(e){var i=this._listeners;return i.push(e),function(){var t=i.indexOf(e);-1!==t&&i.splice(t,1)}},t.prototype.inputChanged=function(t,e){if(t!==e)for(var i=this._listeners,s=i.length,n=0;n<s;++n)i[n](t,e)},t.prototype.observeProperties=function(t){t.observeProperty(this._setBoundProperty)},t.prototype._setBoundProperty=function(t,e,i,s){var n=this.utils;if(n.isNull(t)){if(!0===s)return this._index=0,void this.inputChanged(0,t)}else if(n.isNumber(t)){if(t<0)return this._index=0,this.inputChanged(0,t),void this._initializeIndex(0)}else if(t=Number(t),!n.isNumber(t))return void this._log.warn(this.type+" has its index bound to a property that cannot be interpreted as a Number.");this._loaded?this._goToIndex(t,!0,!0===s):this._index=t},t.prototype._reset=function(){if(!this._fade){var t={};t[this._transform]=this._calculateStaticTranslation(0),this._initiateAnimation({properties:t})}},t.prototype._verifyLength=function(){var t=this.context,e=this._index;if(!this.utils.isArray(t)||0===t.length)return this.utils.isUndefined(e)||this.inputChanged(this._index=void 0,e),this._fade||(this._container.style[this._transform]=this._calculateStaticTranslation(-this._currentOffset)),this._removeEventListeners(),void this._checkArrows();var i=t.length-1;i<e?this.goToIndex(i):this._checkArrows()},t.prototype._setIndexWindow=function(){var t=this._index,e=this._itemNodes.length-1;e<0?this._previousIndex=this._nextIndex=e:this._nextIndex=e<=t?(e<t&&(t=this._index=e),this._previousIndex=t-1,this._isInfinite?0:-1):(this._previousIndex=t<=0?(t<0&&(t=this._index=0),this._isInfinite?e:-1):t-1,t+1)},t.prototype._goToNext=function(i){var s=this;return this._Promise.all(this._addQueue).then(function(){var t=!1;if(s._index>=s._itemNodes.length-1&&!(t=s._isInfinite))return s._isAuto&&!s._isPaused&&(s.pause(),s._selfPause=!0),s._Promise.resolve(!1);var e=s._getLength();return e?s._fade?s._fadeNext(i,t):s._translateNext(e,i,t):s.goToIndex(s._nextIndex,!0)})},t.prototype._goToPrevious=function(i){var s=this;return this._Promise.all(this._addQueue).then(function(){var t=!1;if(s._index<=0&&!(t=s._isInfinite))return s._Promise.resolve(!1);s._selfPause&&s.resume();var e=s._getLength();return e?s._fade?s._fadePrevious(i,t):s._translatePrevious(e,i,t):s.goToIndex(s._previousIndex,!0)})},t.prototype._goToIndex=function(e,i,s){var n=this;return this._Promise.all(this._addQueue).then(function(){var t=n._index;return n.utils.isUndefined(t)?(n._initializeIndex(0),n.inputChanged(n._index,e),n._isInfinite||(e<n.context.length-1?n._selfPause&&n.resume():n._isAuto&&!n._isPaused&&(n.pause(),n._selfPause=!0)),n._Promise.resolve(!0)):e===t?n._Promise.resolve(!1):!0===s?(n._initializeIndex(e),n.inputChanged(n._index,e),n._isInfinite||(e<n.context.length-1?n._selfPause&&n.resume():n._isAuto&&!n._isPaused&&(n.pause(),n._selfPause=!0)),n._Promise.resolve(!0)):0<e-t&&e===n._nextIndex?n._goToNext(i):e===n._previousIndex?n._goToPrevious(i):n._handleGoToIndex(e,i)})},t.prototype._handleGoToIndex=function(t,s){var e=this._index;if(t===e||t<0||t>=this.context.length)return this._Promise.resolve(!1);if(this._selfPause&&this.resume(),!this._getLength())return this._initializeIndex(t),this._Promise.resolve(!0);var n,o,i,r=this._Promise,a=this.utils.defer;e<t?(n=this._goToNext,o=t-e,this._isInfinite&&(i=this._itemNodes.length-t+e)<o&&(n=this._goToPrevious,o=i)):(n=this._goToPrevious,o=e-t,this._isInfinite&&(i=this._itemNodes.length-e+t)<o&&(n=this._goToNext,o=i)),n=n.bind(this);for(var l=[],h=this._removeListeners,u=this._goToIntervalConstant,p=0,_=function(e){var i=a(function(){var t=h.indexOf(i);-1!==t&&h.splice(t,1),e(n(s))},p+=Math.round(u/o));h.push(i)};0<--o;)l.push(new r(_));return l.push(n(s)),r.all(l).then(function(t){for(var e=!1;0<t.length&&!(e=e||t.pop()););return e})},t.prototype._translateNext=function(n,o,r){var a=this;return this._cancelCurrentAnimations().then(function(){a._outerEnd||a._initializeOuterNodes();var t={};t[a._transform]=a._calculateStaticTranslation(-n);var e,i=a._initiateAnimation({properties:t}),s=a._index;return r?a._index=e=0:e=++a._index,o||a.inputChanged(a._index,s),i.then(function(){return a._handleNext(e,n),a._checkArrows(),!0})})},t.prototype._fadeNext=function(d,c){var f=this;return this._cancelCurrentAnimations().then(function(){f._outerEnd||f._initializeOuterNodes();var t,e,i,s,n=f._index,o=f._animator,r=f.dom,a=f._container,l=Array.prototype.slice.call(a.childNodes),h=l.length,u=l[h-5],p=l[h-2],_=f._fade;return s=2===_?(i=o.animate(p,D),r.addClass(u,v+"middle"),r.addClass(p,v+"top"),function(){r.removeClass(u,v+"top"),r.removeClass(u,v+"middle")}):(3===_?(e=o.animate(u,D),r.addClass(p,v+"top"),r.toggleClass(u,v+"top "+v+"middle")):(e=o.animate(u,D),i=o.animate(p,D),r.toggleClass(u,v+"top "+v+"middle"),r.addClass(p,v+"top")),function(){r.removeClass(u,v+"middle")}),c?f._index=t=0:t=++f._index,d||f.inputChanged(f._index,n),f._nextAnimationThenable=i,f._animationThenable=e,f._Promise.all([i,e]).then(function(){return s(),f._handleNext(t,length),f._checkArrows(),!0})})},t.prototype._handleNext=function(t,e){var i=this._isInfinite,s=this._itemNodes,n=s.length,o=this.utils.isArray;if(i&&(n<3||o(this._preClonedNodes)||o(this._postClonedNodes)))this._initializeIndex(t);else{var r=this._container;this._outerStart?(i||1<t)&&(this.dom.insertBefore(s[this._previousIndex],Array.prototype.slice.call(r.childNodes,0,3)),this._fade||(r.style[this._transform]=this._calculateStaticTranslation(e),this._forceRepaint(r))):this._outerStart=!0,this._setIndexWindow(),(i||t<n-1)&&r.insertBefore(s[this._nextIndex],null)}},t.prototype._translatePrevious=function(n,o,r){var a=this;return this._cancelCurrentAnimations().then(function(){a._outerStart||a._initializeOuterNodes();var t={};t[a._transform]=a._calculateStaticTranslation(n);var e,i=a._initiateAnimation({properties:t}),s=a._index;return r?a._index=e=a._itemNodes.length-1:e=--a._index,o||a.inputChanged(a._index,s),i.then(function(){return a._handlePrevious(e,-n),a._checkArrows(),!0})})},t.prototype._fadePrevious=function(_,d){var c=this;return this._cancelCurrentAnimations().then(function(){c._outerStart||c._initializeOuterNodes();var t,e,i,s,n=c._index,o=c._animator,r=c.dom,a=c._container,l=Array.prototype.slice.call(a.childNodes),h=l[4],u=l[1],p=c._fade;return s=2===p?(i=o.animate(u,D),r.addClass(h,v+"middle"),r.addClass(u,v+"top"),function(){r.removeClass(h,v+"top"),r.removeClass(h,v+"middle")}):(3===p?(e=o.animate(h,D),r.addClass(u,v+"top"),r.toggleClass(h,v+"top "+v+"middle")):(e=o.animate(h,D),i=o.animate(u,D),r.toggleClass(h,v+"top "+v+"middle"),r.addClass(u,v+"top")),function(){r.removeClass(h,v+"middle")}),d?c._index=t=c._itemNodes.length-1:t=--c._index,_||c.inputChanged(c._index,n),c._nextAnimationThenable=i,c._animationThenable=e,c._Promise.all([i,e]).then(function(){return s(),c._handlePrevious(t,-length),c._checkArrows(),!0})})},t.prototype._handlePrevious=function(t,e){var i=this._isInfinite,s=this._itemNodes,n=s.length,o=this.utils.isArray;if(i&&(n<3||o(this._preClonedNodes)||o(this._postClonedNodes)))this._initializeIndex(t);else{var r=this._container;this._outerEnd?(i||t<n-2)&&this.dom.insertBefore(s[this._nextIndex],Array.prototype.slice.call(r.childNodes,-3)):this._outerEnd=!0,this._setIndexWindow(),(i||0<t)&&(r.insertBefore(s[this._previousIndex],r.firstChild),this._fade||(r.style[this._transform]=this._calculateStaticTranslation(e),this._forceRepaint(r)))}},t.prototype._clearInnerNodes=function(){this._removeClones(),this._outerStart=this._outerEnd=!1;var t=this._itemNodes;if(0===t.length)return!1;var e=Array.prototype.slice.call(this._container.childNodes),i=this.dom.insertBefore;switch(e.length){case 9:i(t[this._previousIndex],e.splice(0,3)),i(t[this._nextIndex],e.splice(-3,3)),i(t[this._index],e);break;case 6:var s=this._nextIndex,n=this._index;if(s<0||s===n){i(t[n],e.splice(-3,3)),i(t[0===n?this._previousIndex+1:n-1],e);break}i(t[s],e.splice(-3,3)),i(t[n],e);break;case 3:i(t[this._index],e)}return!0},t.prototype._initializeIndex=function(t){var e=this._clearInnerNodes();if(0===this._itemNodes.length?t=-1:t<0&&(t=0),this._index=t,this._setIndexWindow(),!e)return!1;var i=this._fade,s=this._itemNodes[t];if(i){var n=s.childNodes[1];this.dom.addClass(n,v+"top")}var o=this._container;return o.insertBefore(s,null),i||(o.style[this._transform]=this._calculateStaticTranslation(-this._currentOffset),this._forceRepaint(o)),this._initializeOuterNodes(),this._checkArrows(),!0},t.prototype._initializeOuterNodes=function(){var t=this._getLength();if(t){var e,i=this._itemNodes,s=this._container,n=i.length;if(n<=1){if(this._isInfinite)return void this._cloneForInfinite(-t)}else{var o=this.utils.isNode;this._outerEnd||o(e=i[this._nextIndex])&&(s.insertBefore(e,null),this._outerEnd=!0),2<n?!this._outerStart&&(this._isInfinite||0<this._index)&&o(e=i[this._previousIndex])&&(s.insertBefore(e,s.firstChild),this._fade||(s.style[this._transform]=this._calculateStaticTranslation(-t),this._forceRepaint(s)),this._outerStart=!0):this._isInfinite&&this._cloneForInfinite(-t)}}else this._outerStart=this._outerEnd=!1},t.prototype._initiateAnimation=function(t){return this._animationThenable=this._animator.animate(this._container,D,t)},t.prototype._init=function(){var e=this,i=this._addQueue,t=this.context.length;this._setAliases();var s=this._addItems(0,t,0).then(function(){var t=i.indexOf(s);-1!==t&&i.splice(t,1),e._onLoad()}).catch(function(){e._log.debug("An error occurred while processing the "+e.type+". Please ensure you're context is correct."),e._loaded=!1});i.push(s),this._setListener(),this._setTransform()},t.prototype._addEventListeners=function(){var i=this,t=this._type.split(" ");if(-1!==t.indexOf("tap")&&this._initializeTap(),-1!==t.indexOf("swipe")&&this._initializeSwipe(),-1!==t.indexOf("track")&&this._initializeTrack(),-1!==t.indexOf("auto")&&this._initializeAuto(),!this._fade){var s=!1;this.addEventListener(this._window,"resize",function(){s||(s=!0,i.utils.requestAnimationFrame(function(){s=!1;var t=i._length,e=i._getLength();e&&t!==e&&(i._isInfinite||0!==i._index)&&(i._container.style[i._transform]=i._calculateStaticTranslation(t-e))}))},!1)}},t.prototype._removeEventListeners=function(){for(var t=this._removeListeners;0<t.length;)t.pop()();this._removeInterval(),this._removeSuspend(),this._isInfinite&&this._removeClones(),this._onLoad=ot},t.prototype._cloneForInfinite=function(t){this._removeClones();var e=this.context;if(this.utils.isArray(e)&&0!==e.length){var i=this._outerStart,s=this._outerEnd;if(!i||!s){var n,o,r,a=this._container,l=this._document;s||(n=l.createComment(w+" clone: start node"),o=l.createComment(w+" clone: end node"),r=a.firstElementChild.cloneNode(!0),this._postClonedNodes=[n,r,o],a.insertBefore(n,null),a.insertBefore(r,null),a.insertBefore(o,null),this._outerEnd=!0),i||(n=l.createComment(w+" clone: start node"),o=l.createComment(w+" clone: end node"),r=a.lastElementChild.cloneNode(!0),this._preClonedNodes=[n,r,o],a.insertBefore(o,a.firstChild),a.insertBefore(r,a.firstChild),a.insertBefore(n,a.firstChild),this._outerStart=!0,this._fade||(a.style[this._transform]=this._calculateStaticTranslation(t),this._forceRepaint(a)))}}},t.prototype._removeClones=function(){var t=this._container,e=this._preClonedNodes,i=this._postClonedNodes,s=this.utils.isArray;s(e)&&(t.removeChild(e[0]),t.removeChild(e[1]),t.removeChild(e[2])),s(i)&&(t.removeChild(i[0]),t.removeChild(i[1]),t.removeChild(i[2])),this._preClonedNodes=this._postClonedNodes=null},t.prototype._initializeAuto=function(){this._isAuto=!0,this._initiateInterval()},t.prototype._initiateInterval=function(){this._removeInterval=this.utils.setInterval(this.goToNext,this._interval,null,this)},t.prototype._suspendInterval=function(){var t=this;this._isAuto&&!this._isPaused&&(this._removeSuspend(),this._removeInterval(),this._removeSuspend=this.utils.defer(function(){t._initiateInterval(),t._removeSuspend=ot},this._suspend))},t.prototype._initializeTap=function(){var t=this;this.utils.isNode(this._forwardArrow)||this._createArrowElements();var e=this._removeListeners;e.push(this.addEventListener(this._backArrow,G,function(){t._suspendInterval(),t.goToPrevious()},!1)),e.push(this.addEventListener(this._forwardArrow,G,function(){t._suspendInterval(),t.goToNext()},!1)),this._checkArrows()},t.prototype._createArrowElements=function(){var t=this._document,e=this._viewport,i=this._backArrow=t.createElement("div"),s=this._forwardArrow=t.createElement("div"),n=t.createElement("span"),o=t.createElement("span");this._isVertical?(n.className=v+"icon-arrow-up",o.className=v+"icon-arrow-down"):(n.className=v+"icon-arrow-left",o.className=v+"icon-arrow-right"),i.className=v+"back-arrow",s.className=v+"forward-arrow",i.appendChild(n),s.appendChild(o),e.appendChild(i),e.appendChild(s)},t.prototype._checkArrows=function(){var t=this.utils,e=t.isNode;if(!this._isInfinite&&e(this._forwardArrow)&&e(this._backArrow)){var i=this.context.length,s=this._index;if(t.isNull(s))return this._backArrow.setAttribute(S,""),void this._forwardArrow.setAttribute(S,"");s<=0?this._backArrow.setAttribute(S,""):this._backArrow.removeAttribute(S),i-1<=s?this._forwardArrow.setAttribute(S,""):this._forwardArrow.removeAttribute(S)}},t.prototype._initializeSwipe=function(){var t,e,i=this._viewport,s=this._handleSwipe;e=this._isVertical?(t=X+"up",X+"down"):(t=X+"left",X+"right");var n=this._removeListeners;n.push(this.addEventListener(i,t,s,!1)),n.push(this.addEventListener(i,e,s,!1))},t.prototype._initializeTrack=function(){var t,e,i=this._viewport,s=this._track,n=this._touchEnd;e=this._isVertical?(t=Q+"up",Q+"down"):(t=Q+"left",Q+"right");var o=this._removeListeners;o.push(this.addEventListener(i,t,s,!1)),o.push(this.addEventListener(i,e,s,!1)),o.push(this.addEventListener(i,W,this._touchStart,!1)),o.push(this.addEventListener(i,$,n,!1)),o.push(this.addEventListener(i,H,n,!1))},t.prototype._handleSwipe=function(t){var e=!1;switch(t.direction.primary){case"left":!this._isVertical&&(this._isInfinite||this._index<this.context.length-1)&&(this._suspendInterval(),e=!0,this.goToNext());break;case"right":!this._isVertical&&(this._isInfinite||0<this._index)&&(this._suspendInterval(),e=!0,this.goToPrevious());break;case"up":this._isVertical&&(this._isInfinite||this._index<this.context.length-1)&&(this._suspendInterval(),e=!0,this.goToNext());break;case"down":this._isVertical&&(this._isInfinite||0<this._index)&&(this._suspendInterval(),e=!0,this.goToPrevious());break;default:return}this._hasSwiped=e},t.prototype._touchStart=function(t){this._inTouch||(this._isAuto&&(this._removeInterval(),this._removeInterval=ot),this._inTouch=!0,this._hasMoved=!1,this._lastTouch={x:t.clientX,y:t.clientY})},t.prototype._touchEnd=function(t){var e=this,i=this._inTouch,s=this._hasMoved,n=this._hasSwiped;if(this._inTouch=this._hasSwiped=this._hasMoved=!1,i&&!n&&(this._isAuto&&!this._isPaused&&this._initiateInterval(),s)){var o=this._isVertical?t.clientY-this._lastTouch.y:t.clientX-this._lastTouch.x,r=this._getLength();if(r)return Math.abs(o)>Math.ceil(r/2)?o<0?void this.goToNext().then(function(t){t||e._reset()}):void this.goToPrevious().then(function(t){t||e._reset()}):void this._reset();this._reset()}},t.prototype._track=function(e){var i=this;this._inTouch&&(this._fade?this._hasMoved=!0:(this._hasMoved||this._cancelCurrentAnimations().then(function(){i._outerStart&&i._outerEnd||i._initializeOuterNodes()}),this._hasMoved=!0,this.utils.requestAnimationFrame(function(){var t=i._calculateDynamicTranslation(e);null!==t&&(i._container.style[i._transform]=t)})))},t.prototype._calculateStaticTranslation=function(t){return this._isVertical?"translate3d(0,"+(this._currentOffset+=t)+"px,0)":"translate3d("+(this._currentOffset+=t)+"px,0,0)"},t.prototype._calculateDynamicTranslation=function(t){var e;return this._isVertical?(e=t.clientY-this._lastTouch.y,Math.abs(e)>this._getLength()?(this._touchEnd(t),null):"translate3d(0,"+(this._currentOffset+e)+"px,0)"):(e=t.clientX-this._lastTouch.x,Math.abs(e)>this._getLength()?(this._touchEnd(t),null):"translate3d("+(this._currentOffset+e)+"px,0,0)")},t.prototype._setTransform=function(){var t=this._container.style,e=this.utils.isUndefined,i=this._compat.vendorPrefix;e(t[i.lowerCase+"Transform"])?e(t[i.upperCase+"Transform"])?this._transform="transform":this._transform=i.upperCase+"Transform":this._transform=i.lowerCase+"Transform"},t.prototype._getLength=function(){return this._length=this._isVertical?this._viewport.offsetHeight:this._viewport.offsetWidth},t.prototype._validateOrientation=function(t){return this.utils.isUndefined(t)?"horizontal":("horizontal"===t?e=t:"vertical"===t?(e=t,this._isVertical=!0):(this._log.debug('Invalid orientation "'+t+'" for '+this.type+'. Defaulting to "horizontal."'),e="horizontal"),e);var e},t.prototype._appendItems=function(t){if(this._itemNodes=this._itemNodes.concat(t),this._loaded){var e=this._index;if(0===this._removeListeners.length)return this._addEventListeners(),this._initializeIndex(0),void this.inputChanged(0,e);e>=this._itemNodes.length-2&&this._initializeIndex(e)}},t.prototype._removeItems=function(t,e){for(var i=this._TemplateControlFactory.dispose,s=this.controls,n=this._itemNodes,o=t+e;o-- >t;)i(s[o]),n.pop();this._updateResource(s.length-1),this._verifyLength()},t.prototype._cancelCurrentAnimations=function(){if(this._fade){var t=this.utils.isNull,e=void 0,i=void 0;return t(this._nextAnimationThenable)||(i=this._nextAnimationThenable.cancel()),t(this._animationThenable)||(e=this._animationThenable.cancel()),this._Promise.all([e,i])}return this.utils.isNull(this._animationThenable)?this._Promise.resolve():this._animationThenable.cancel()},t.prototype._forceRepaint=function(t){var e=t.style,i=e.display;"none"!==e.display?(e.display="none",t.offsetWidth,e.display=i):t.offsetWidth},t._inject={_document:r,_window:o,_compat:n,_TemplateControlFactory:l},t}(plat.ui.controls.ForEach);t.Carousel=bt,plat.register.control(w,bt);var Ct=function(g){function t(){var i=g.call(this)||this;return i._aliases={index:F,even:R,odd:B,first:M,last:j,group:K},i._templates={},i._isVertical=!0,i._scrollReady=!0,i._isLoading=!1,i._scrollPosition=0,i._removeScroll=ot,i._isRefreshing=!1,i._touchState=0,i._hasMoved=!1,i._lastTouch={x:0,y:0},i._nodeNormalizeRegex=/-|\.|_/g,i._isGrouped=!1,i._visibilityRemoveListeners=[],i.__templateString='<div class="plat-listview-viewport">\n    <div class="plat-scroll-container">\n        <div class="plat-listview-container"></div>\n    </div>\n</div>\n',i.__listenerSet=!1,i.templateString=i.__templateString,i.itemsLoaded=new i._Promise(function(t,e){i.__resolveFn=t,i.__rejectFn=e}).catch(ot),i}return __extends(t,g),t.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,E+" "+(t||""))},t.prototype.initialize=function(){var t=this.options||(this.options={}),e=t.value||(t.value={});this.templateUrl=e.templateUrl||this.templateUrl,this.setClasses()},t.prototype.setTemplate=function(){if(this.templateString!==this.__templateString||this.utils.isString(this.templateUrl)){var t=this.dom.serializeHtml(this.__templateString),e=this.element;this.innerTemplate=this.dom.appendChildren(e.childNodes),e.appendChild(t)}},t.prototype.contextChanged=function(t,e){this.utils.isArray(t)?this._setListener():(this._log.debug(this.type+" context set to something other than an Array."),t=[]),this._executeEvent([{object:t,type:"splice"}])},t.prototype.loaded=function(){var t=this.options.value,e=this.utils,i=e.isString,s=this.element,n=this._viewport=s.firstElementChild,o=this._scrollContainer=n.firstElementChild,r=this._loading=t.loading,a=this._animate=!0===t.animate,l=t.onItemsRequested,h=t.onRefresh,u=t.itemTemplate,p=t.scrollElement;if(this._container=o.firstElementChild,this.dom.addClass(s,v+this._validateOrientation(t.orientation)+(a?" plat-animated":"")),i(p)&&(p=this._document.querySelector(p)),e.isNode(p)&&(this._scrollContainer=p,this.dom.addClass(s,v+"no-scroller")),i(u)){var _=this._normalizeTemplateName(u),d=t.headerTemplate,c=i(d)?this._normalizeTemplateName(d):null;this._parseInnerTemplate(_,c),this._determineTemplates(u,_,c);var f=!(this._defaultGroup={name:null,control:this,itemContainer:this._container,element:s,index:null,itemCount:0,addQueue:[],animationQueue:[]});i(r)&&(i(l)?this._determineLoading(l,!1!==t.infiniteProgress):this._log.debug(this.type+' loading type specified as "'+r+'" but no option specifying an onItemsRequested handler.')),i(h)&&(f=!0,this._initializeRefresh(h)),this._initializeTracking("incremental"===r,f),e.isArray(this.context)?(this._setAliases(),this._setContainerHeight(),this.render(),this._setListener()):e.isNull(this.context)||this._log.debug(this.type+"'s context must be an Array.")}else this._log.debug("No item template or item template selector specified for "+this.type+".")},t.prototype.dispose=function(){for(var t=this._visibilityRemoveListeners;0<t.length;)t.pop()();this._removeScroll(),this.utils.isFunction(this.__rejectFn)&&(this.__rejectFn(),this.__resolveFn=this.__rejectFn=null)},t.prototype.render=function(t,e,i){var s=this.utils.isNumber,n=i||this._defaultGroup,o=n.control,r=this===o?this.context:o.context.items;s(t)||(t=0);var a=r.length-t,l=s(e)&&e<=a?e:a;this._createItems(t,l,n,0)},t.prototype.rerender=function(t){this.render(0,null,t)},t.prototype._childContextChanged=function(t,e,i){this._executeChildEvent(t,[{object:e||[],type:"splice"}])},t.prototype._setListener=function(){this.__listenerSet||(this.observeArray(this._executeEvent),this.__listenerSet=!0)},t.prototype._setAliases=function(){var t=this.options.value.aliases,e=this.utils;if(e.isObject(t))for(var i,s=this._aliases,n=e.isString,o=Object.keys(s),r=o.length,a=0;a<r;++a)n(i=t[o[a]])&&(s[o[a]]=i)},t.prototype._determineTemplates=function(t,e,i){var s,n=this.utils,o=this.bindableTemplates,r=this._templates;if(n.isString(i)&&(this._isGrouped=!0,this.dom.addClass(this._container,v+"grouped"),s=r[i],n.isNode(s)?(this._headerTemplate=i,this.bindableTemplates.add(i,s),delete r[i]):this._log.debug(E+' group header template "'+i+'" was not a template defined in the DOM.'),this._headerTemplatePromise=this._createGroupTemplate()),s=r[e],n.isNode(s))return this._itemTemplate=e,this.bindableTemplates.add(e,s),void delete r[e];var a=this.findProperty(t)||{};if(n.isFunction(a.value)){this._templateSelector=a.value.bind(a.control),this._templateSelectorKeys={};for(var l,h=Object.keys(r);0<h.length;)l=h.pop(),o.add(l,r[l]),delete r[l]}else this._log.debug(E+' item template "'+t+'" was neither a template defined in the DOM nor a template selector function in its control hiearchy.')},t.prototype._createGroupTemplate=function(){var t,e=this,i=this._document,s=this.bindableTemplates,n=this._headerTemplate,o=E+"-group",r=i.createElement("div"),a=i.createElement("div");return r.className=o,a.className=E+"-items",this.utils.isString(n)&&(t=s.templates[n].then(function(t){r.insertBefore(t.cloneNode(!0),null)})),this._Promise.resolve(t).then(function(){r.insertBefore(a,null),s.add(o,r)}).then(null,function(t){e._log.debug(e.type+" error: "+t)})},t.prototype._addGroups=function(t,e,s){for(var n=this,o=e,i=+(e+t),r=[];e<i;)r.push(this._bindGroup(e++));return this._Promise.all(r).then(function(t){for(var e=t.length,i=0;i<e;++i)n._addGroup(i+o,t[i],i<s)})},t.prototype._addGroup=function(t,e,i){var n,o,r=this,a=this.utils,s=this.context,l=this._groups||(this._groups={}),h=s[t],u=h.group,p=e.childNodes[1],_=p.lastElementChild,d=this.controls[t],c=l[u]={name:u,index:t,element:p,itemContainer:_,control:d,itemCount:0,addQueue:[],animationQueue:[]},f="items";if(d.dispose=function(){g.prototype.dispose.call(r),delete l[u]},d.observe(function(t,e){var i=t.group;if(i!==u&&a.isObject(t)){var s=l[u];delete l[u],s.name=i,l[i]=s,u=i,n(),o(),n=d.observe(r._childContextChanged.bind(r,u),f),o=d.observeArray(r._executeChildEvent.bind(r,u),f)}}),n=d.observe(this._childContextChanged.bind(this,u),f),o=d.observeArray(this._executeChildEvent.bind(this,u),f),this._createItems(0,(h.items||[]).length,c,0),i){var m=this._defaultGroup.animationQueue,v={animation:this._animator.enter(e,q,this._container).then(function(){var t=m.indexOf(v);-1<t&&m.splice(t,1),a.requestAnimationFrame(r._setGroupContainerPadding.bind(r,p))}),op:null};m.push(v)}else this._container.insertBefore(e,null),a.requestAnimationFrame(this._setGroupContainerPadding.bind(this,p))},t.prototype._bindGroup=function(t){return this.bindableTemplates.bind(E+"-group",t,this._getAliases(this.context,t))},t.prototype._createItems=function(t,e,i,s){var n=this,o=this.utils,r=i||this._defaultGroup,a=r.control,l=this._isVertical,h=this===a;if(h&&this._isGrouped)this._headerTemplatePromise.then(function(){n._addGroups(e,t,s)}).then(null,function(t){n._log.debug(n.type+" error: "+t)});else{var u,p=r.addQueue,_=function(){var t=p.indexOf(u);-1!==t&&p.splice(t,1),h||(r.element.removeAttribute(S),l||h||!n._isGrouped||o.requestAnimationFrame(n._setGroupContainerWidth.bind(n,r.itemContainer)))},d=function(t){n._log.debug(n.type+" error: "+(o.isString(t.message)?t.message:t))};if(o.isFunction(this._templateSelector)){var c=[];r.itemCount+=e;for(var f=0;f<e;++f,++t)c.push(this._renderUsingFunction(t,r));var m=this.itemsLoaded=this._Promise.all(c).then(function(t){for(var e=t.length,i=0;i<e;++i)n._appendRenderedItem(t[i],r,i<s)}).then(_,d);p.push(m)}else{var v=this._itemTemplate;o.isUndefined(this.bindableTemplates.templates[v])||(this._disposeFromIndex(t,r),r.itemCount+=e,u=this._addItems(t,e,r,s).then(_,d),p.push(u))}}},t.prototype._addItems=function(t,e,i,s){var n,o,r=this,a=i||this._defaultGroup,l=a.control,h=a.itemContainer,u=+(t+e),p=[],_=this._itemTemplate,d=l.bindableTemplates,c=t;for(o=this===l?(n="",this.context):(n="items.",l.context.items);t<u;)p.push(d.bind(_,n+t,this._getAliases(o,t++)));return 0<p.length&&(this.itemsLoaded=this._Promise.all(p).then(function(t){if(0<s)for(var e=t.length,i=0;i<e;++i)i<s?r._appendAnimatedItem(t[i],a):h.insertBefore(t[i],null);else r._appendItems(t,h);r._updateResource(c-1,l),r.utils.isFunction(r.__resolveFn)&&(r.__resolveFn(),r.__resolveFn=r.__rejectFn=null)}).catch(function(t){r.utils.postpone(function(){r._log.debug(t)})})),this.itemsLoaded},t.prototype._renderUsingFunction=function(l,t){var h,u,e,p=this,i=this._Promise,_=this.utils,d=t||this._defaultGroup,c=d.control;return this===c?(h=l,u=this.context):(h="items."+l,u=c.context.items,e=d.name),i.resolve(this._templateSelectorPromise).then(function(){return p._templateSelectorPromise=i.resolve(p._templateSelector(u[l],l,e))}).then(function(t){var e=c.bindableTemplates,i=e.templates,s=c.controls,n=p._normalizeTemplateName(t),o=d.name,r=p._templateSelectorKeys[o],a=l<s.length;if(_.isUndefined(r)&&(r=p._templateSelectorKeys[o]={}),!_.isUndefined(i[n])){if(a){if(n===r[l])return;return r[l]=n,e.replace(l,n,h,p._getAliases(u,l))}return r[l]=n,e.bind(n,h,p._getAliases(u,l))}p._log.debug(p.type+' template "'+t+'" was not found.'),a&&p._TemplateControlFactory.dispose(s[l])})},t.prototype._appendRenderedItem=function(t,e,i){var s=this.utils,n=e||this._defaultGroup;if(!s.isNull(t)&&!s.isArray(t)){if(!0===i){var o=n.animationQueue,r={animation:this._animator.enter(t,q,n.itemContainer).then(function(){var t=o.indexOf(r);-1!==t&&o.splice(t,1)}),op:null};o.push(r)}else n.itemContainer.insertBefore(t,null);s.isFunction(this.__resolveFn)&&(this.__resolveFn(),this.__resolveFn=null)}},t.prototype._updateResource=function(t,e){var i=e.controls;t<0||t>=i.length||i[t].resources.add(this._getAliases(this===e?this.context:e.context.items,t))},t.prototype._getAliases=function(t,e){var i=0==(1&e),s={},n=this._aliases,o="literal";return s[n.index]={value:e,type:o},s[n.even]={value:i,type:o},s[n.odd]={value:!i,type:o},s[n.first]={value:0===e,type:o},s[n.last]={value:e===t.length-1,type:o},s},t.prototype._appendItems=function(t,e){this.dom.appendChildren(t,e)},t.prototype._appendAnimatedItem=function(t,e){if(this.utils.isNode(t)){var i=e.animationQueue,s={animation:this._animator.enter(t,q,e.itemContainer).then(function(){var t=i.indexOf(s);-1!==t&&i.splice(t,1)}),op:null};i.push(s)}},t.prototype._removeItems=function(t,e,i){for(var s=this._TemplateControlFactory.dispose,n=i.control,o=n.controls,r=t+e,a=t<r;r-- >t;)s(o[r]);this._updateResource(o.length-1,n),this!==n&&(0===o.length?i.element.setAttribute(S,""):a&&this._isGrouped&&!this._isVertical&&this.utils.requestAnimationFrame(this._setGroupContainerWidth.bind(this,i.itemContainer)))},t.prototype._disposeFromIndex=function(t,e){for(var i=(e||this._defaultGroup).control,s=i.controls,n=this._TemplateControlFactory.dispose,o=s.length,r=t<o;o-- >t;)n(s[o]);this!==i&&(0===s.length?e.element.setAttribute(S,""):r&&this._isGrouped&&!this._isVertical&&this.utils.requestAnimationFrame(this._setGroupContainerWidth.bind(this,e.itemContainer)))},t.prototype._determineLoading=function(t,e){var i,s=this,n=this.findProperty(t)||{};if(this.utils.isFunction(n.value))switch(this._requestItems=n.value.bind(n.control),this._loading){case"infinite":var o,r=ot;o=this.addEventListener(this._scrollContainer,"scroll",function(){s._scrollReady&&(s._scrollReady=!1,r=s.utils.requestAnimationFrame(function(){s._scrollReady=!0,s._onScroll()}))},!1),this._removeScroll=function(){s._scrollReady=!1,r(),o()},e&&((i=this._loadingProgressRing=this._document.createElement("div")).className=v+"infinite",i.insertBefore(this._generateProgressRing(),null)),this.itemsLoaded.then(this._onScroll.bind(this));break;case"incremental":(i=this._loadingProgressRing=this._document.createElement("div")).className=v+"incremental",i.setAttribute(S,""),i.insertBefore(this._generateProgressRing(),null),this.element.insertBefore(i,null)}else this._log.debug(E+' onItemsRequested function "'+t+'" was not found.')},t.prototype._onScroll=function(){var t=this._scrollContainer,e=this._scrollPosition,i=this._isVertical?t.scrollTop+t.offsetHeight:t.scrollLeft+t.offsetWidth;i<e?this._scrollPosition=i:i<e+5||(this._scrollPosition=i,this._handleScroll())},t.prototype._handleScroll=function(){var e=this,t=this._scrollContainer,i=.8*(this._isVertical?t.scrollHeight:t.scrollWidth);if(0!==i&&this._scrollPosition>=i){var s=this.utils,n=this._requestItems();if(!1===n)this._removeScroll();else if(s.isPromise(n)){var o=this._loadingProgressRing,r=!s.isNull(o),a=this._container;this._scrollReady=!1,r&&s.requestAnimationFrame(function(){a.insertBefore(o,null)}),n.then(function(t){r&&s.requestAnimationFrame(function(){a.removeChild(o)}),!1!==t&&(e._scrollReady=!0)})}else s.postpone(function(){e.itemsLoaded.then(function(){e._scrollReady&&e._handleScroll()})})}},t.prototype._initializeRefresh=function(t){var e=this.findProperty(t)||{};if(this.utils.isFunction(e.value)){this._refresh=e.value.bind(e.control);var i=this._refreshProgressRing=this._document.createElement("div");i.className=v+"refresh",i.setAttribute(S,""),i.insertBefore(this._generateProgressRing(),null),this.element.insertBefore(i,null)}else this._log.debug(E+' onRefresh function "'+t+'" was not found.')},t.prototype._initializeTracking=function(t,e){if(t||e){var i,s;this._setTransform(),s=this._isVertical?(i=Q+"down",Q+"up"):(i=Q+"right",Q+"left");var n,o,r=this._viewport;this.addEventListener(r,W,this._touchStart,!1),t&&(n=this._touchEndLoad,o=this._trackLoad,this.addEventListener(r,H,n,!1),this.addEventListener(r,$,n,!1),this.addEventListener(r,Y,n,!1),this.addEventListener(r,i,o,!1),this.addEventListener(r,s,o,!1)),e&&(n=this._touchEndRefresh,o=this._trackRefresh,this.addEventListener(r,H,n,!1),this.addEventListener(r,$,n,!1),this.addEventListener(r,Y,n,!1),this.addEventListener(r,i,o,!1),this.addEventListener(r,s,o,!1))}},t.prototype._touchStart=function(t){var e=this;if(0===this._touchState){if(!this._isVertical){var i=Math.ceil(t.offsetY);if(this._viewport.offsetHeight-20<=i)return}this._touchState=1,this._lastTouch={x:t.clientX,y:t.clientY},this.utils.isNull(this._touchAnimationThenable)?this._touchState=2:this._touchAnimationThenable.cancel().then(function(){e._touchAnimationThenable=null,e._touchState=2})}},t.prototype._touchEndLoad=function(t){var e=this._isLoading;if(this._isLoading=!1,e){var i,s,n=this._scrollContainer;s=this._isVertical?(i=n.scrollTop+n.offsetHeight,n.scrollHeight):(i=n.scrollLeft+n.offsetWidth,n.scrollWidth),i+1<s?this._touchState=0:this._touchEnd(t,!1)}else this._isRefreshing||(this._touchState=0)},t.prototype._touchEndRefresh=function(t){var e=this._isRefreshing;this._isRefreshing=!1,e?0<(this._isVertical?this._scrollContainer.scrollTop:this._scrollContainer.scrollLeft)?this._touchState=0:this._touchEnd(t,!0):this._isLoading||(this._touchState=0)},t.prototype._touchEnd=function(t,e){var i=this,s=this._touchState,n=this._hasMoved;if(this._hasMoved=!1,!(s<2)&&n){var o,r={},a=this.dom,l=this._viewport,h=e?this._refreshProgressRing:this._loadingProgressRing,u=3===s;if(u){o=this._isVertical?"translate3d(0,"+(e?h.offsetHeight:-h.offsetHeight)+"px,0)":"translate3d("+(e?h.offsetWidth:-h.offsetWidth)+"px,0,0)"}else o=this._preTransform;r[this._transform]=o,this._touchAnimationThenable=this._animator.animate(l,D,{properties:r}).then(function(){return i._touchState=4,i._hasMoved=!1,i._touchAnimationThenable=null,u?i._Promise.resolve(e?i._refresh():i._requestItems()):(a.removeClass(l,v+"manipulation-prep"),h.setAttribute(S,""),i._Promise.resolve())}).then(function(){if(u)return a.removeClass(h,v+"play"),r[i._transform]=i._preTransform,i._touchAnimationThenable=i._animator.animate(l,D,{properties:r}).then(function(){i._touchState=0,i._touchAnimationThenable=null,a.removeClass(l,v+"manipulation-prep"),h.setAttribute(S,"")});i._touchState=0}).then(null,function(t){i._touchState=0,i._log.debug(i.type+" error: "+t)})}},t.prototype._trackLoad=function(t){if(!this._isRefreshing){if(!this._isLoading){var e=this._scrollContainer,i=void 0,s=void 0;if(this._isVertical){if("up"!==t.direction.y)return;i=e.scrollTop+e.offsetHeight,s=e.scrollHeight}else{if("left"!==t.direction.x)return;i=e.scrollLeft+e.offsetWidth,s=e.scrollWidth}if(i+1<s)return;this._isLoading=!0}this._track(t,!1)}},t.prototype._trackRefresh=function(t){if(!this._isLoading){if(!this._isRefreshing){if(this._isVertical){if("down"!==t.direction.y||0<this._scrollContainer.scrollTop)return}else if("right"!==t.direction.x||0<this._scrollContainer.scrollLeft)return;this._isRefreshing=!0}this._track(t,!0)}},t.prototype._track=function(t,e){var i=this,s=this._touchState;if(2===s||3===s){var n=this._calculateTranslation(t,e);this.utils.requestAnimationFrame(function(){i._viewport.style[i._transform]=n})}},t.prototype._calculateTranslation=function(t,e){var i,s,n=this._isVertical,o=e?this._refreshProgressRing:this._loadingProgressRing;return s=n?(i=t.clientY-this._lastTouch.y,o.offsetHeight):(i=t.clientX-this._lastTouch.x,o.offsetWidth),e&&i<0||!e&&0<i?i=0:this._hasMoved?Math.abs(i)>=s?this._touchState<3&&(this._touchState=3,this.dom.addClass(o,v+"play")):3===this._touchState&&(this._touchState=2,this.dom.removeClass(o,v+"play")):(this._hasMoved=!0,this.dom.addClass(this._viewport,v+"manipulation-prep"),o.removeAttribute(S)),n?"translate3d(0,"+i+"px,0)":"translate3d("+i+"px,0,0)"},t.prototype._setTransform=function(){var t=this._viewport.style,e=this.utils.isUndefined,i=this._compat.vendorPrefix;e(this._preTransform=t[i.lowerCase+"Transform"])?e(this._preTransform=t[i.upperCase+"Transform"])?(this._preTransform=t.transform,this._transform="transform"):this._transform=i.upperCase+"Transform":this._transform=i.lowerCase+"Transform"},t.prototype._parseInnerTemplate=function(t,e){for(var i,s,n,o=this._templates,r=Array.prototype.slice,a=this.dom.appendChildren,l=this._document,h=!this.utils.isNull(e),u=r.call(this.innerTemplate.childNodes);0<u.length;)(i=u.pop()).nodeType===Node.ELEMENT_NODE&&(s=this._normalizeTemplateName(i.nodeName),h&&s===e?(n=l.createElement("div")).className=v+"header":n=l.createDocumentFragment(),a(i.childNodes,n),o[s]=n)},t.prototype._executeEvent=function(t){var e="_"+t[0].type;this.utils.isFunction(this[e])&&this[e](t)},t.prototype._executeChildEvent=function(t,e){var i=this.utils,s="_"+e[0].type;if(i.isFunction(this[s])){var n=this._groups[t];if(i.isNull(n))return;this[s](e,n)}},t.prototype._push=function(t,e){var i=t[0],s=i.addedCount;this._createItems(i.index,s,e,this._animate?s:0)},t.prototype._pop=function(t,e){var i=this,s=e||this._defaultGroup,n=s.addQueue,o=t[0],r=o.object.length;if(0!==o.removed.length){var a=o.object.length;0<s.itemCount&&s.itemCount--,this._Promise.all(n).then(function(){i._animate?i._animateItems(r,1,U,s,"leave",!1).then(function(){i._removeItems(a,1,s)}):i._removeItems(a,1,s)})}},t.prototype._unshift=function(t,e){if(this.utils.isFunction(this._templateSelector))this.rerender(e);else{var i=e||this._defaultGroup,s=t[0],n=s.addedCount;if(this._animate){var o=i.animationQueue,r=o.length;this._animateItems(0,n,q,i,null,0<r&&"clone"===o[r-1].op)}this._createItems(s.object.length-n,n,i,0)}},t.prototype._shift=function(t,e){var i=this,s=e||this._defaultGroup,n=s.addQueue,o=t[0];if(0!==o.removed.length){this._animate&&0===n.length&&(n=n.concat([this._animateItems(0,1,U,s,"clone",!0)]));var r=o.object.length;0<s.itemCount&&s.itemCount--,this._Promise.all(n).then(function(){i._removeItems(r,1,s)})}},t.prototype._splice=function(t,e){var i=this,s=this.utils,n=t[0],o=e||this._defaultGroup,r=n.addedCount,a=o.itemCount,l=(o.control,o.addQueue),h=this._animate;if(s.isNull(r)){h&&this._cancelCurrentAnimations();var u=n.object.length,p=a-u;if(a<u){if(s.isFunction(this._templateSelector))return void(s.isNull(n.index)?this.rerender(o):this.render(n.index,r,o));this._createItems(a,-p,o,0)}else u<a&&(o.itemCount>=p?o.itemCount-=p:o.itemCount=0,this._Promise.all(l).then(function(){i._removeItems(a-p,p,o)}))}else{var _=n.removed.length,d=o.animationQueue;if(_<r){var c=r-_,f=void 0;if(s.isFunction(this._templateSelector))return void(s.isNull(n.index)?this.rerender(o):this.render(n.index,r,o));if(h){f=r;var m=d.length,v=n.index;a<r-v&&(f=a-v),this._animateItems(v,f,q,o,null,0<m&&"clone"===d[m-1].op),f=r-f}else f=0;this._createItems(n.object.length-c,c,o,f)}else if(r<_){var g=0<r;h&&!g&&0===l.length&&(l=l.concat([this._animateItems(n.index,_,U,o,"clone",!0)]));var y=_-r;o.itemCount>=y?o.itemCount-=y:o.itemCount=0,this._Promise.all(l).then(function(){if(h&&g){var t=d.length;i._animateItems(n.index,r,q,o,null,0<t&&"clone"===d[t-1].op)}i._removeItems(a-y,y,o)})}}},t.prototype._animateItems=function(t,e,i,s,n,o){switch(n){case"clone":return this._handleClonedContainerAnimation(this._getAnimatedNodes(t,e,s),i,s,!0===o);case"leave":return this._handleLeave(this._getAnimatedNodes(t,e,s),i,s);default:return this._handleSimpleAnimation(this._getAnimatedNodes(t,e,s),i,s,!0===o)}},t.prototype._getAnimatedNodes=function(t,e,i){if(this._isGrouped&&i===this._defaultGroup){var s=3*t;return Array.prototype.slice.call(i.itemContainer.childNodes,s,3*e+s)}var n=this.utils.isNode,o=Array.prototype.slice.call(i.itemContainer.childNodes),r=t+e-1,a=i.control.controls;a.length<=r&&(r=a.length-1);var l=a[t].startNode,h=a[r].endNode;if(!n(l)||!n(h))return[];var u=o.indexOf(l),p=o.indexOf(h);return-1===u||-1===p?[]:o.slice(u,p+1)},t.prototype._handleSimpleAnimation=function(t,e,i,s){if(0===t.length)return this._Promise.resolve();i.itemContainer;var n,o=i.animationQueue,r=this._animator.create(t,e),a=r.current.then(function(){var t=o.indexOf(n);-1!==t&&o.splice(t,1)}),l=function(){return r.previous.then(function(){a.start()}),a};if(n={animation:a,op:null},s&&0<o.length){var h=this._cancelCurrentAnimations().then(l);return o.push(n),h}return o.push(n),l()},t.prototype._handleLeave=function(t,e,i){if(0===t.length)return this._Promise.resolve();i.itemContainer;var s,n=i.animationQueue,o=this._animator.leave(t,e).then(function(){var t=n.indexOf(s);-1!==t&&n.splice(t,1)});return s={animation:o,op:"leave"},n.push(s),o},t.prototype._handleClonedContainerAnimation=function(t,e,i,s){if(0===t.length)return this._Promise.resolve();var n,o,r=i.itemContainer,a=r.cloneNode(!0),l=i.animationQueue,h=this.utils.isNull,u=this._animator.create(t,e),p=u.current.then(function(){var t=l.indexOf(o);-1<t&&l.splice(t,1),h(n)||n.replaceChild(r,a)}),_=function(){return n=r.parentNode,h(n)||p.isCanceled()||(n.replaceChild(a,r),u.previous.then(function(){p.start()})),p};if(o={animation:p,op:"clone"},s&&0<l.length){var d=this._cancelCurrentAnimations().then(_);return l.push(o),d}return l.push(o),_()},t.prototype._cancelCurrentAnimations=function(t){for(var e=(t||this._defaultGroup).animationQueue,i=[],s=e.length,n=0;n<s;++n)i.push(e[n].animation.cancel());return this._Promise.all(i)},t.prototype._normalizeTemplateName=function(t){if(this.utils.isString(t))return t.toLowerCase().replace(this._nodeNormalizeRegex,"")},t.prototype._generateProgressRing=function(){var t=this._document,e=t.createElement("div"),i=t.createElement("div");return e.className=E+"-ring "+v+"ring "+v+"ring-0",i.className=v+"animated-ring",e.insertBefore(i,null),e},t.prototype._validateOrientation=function(t){return this.utils.isUndefined(t)?"vertical":("vertical"===t?e=t:"horizontal"===t?(e=t,this._isVertical=!1):(this._log.debug('Invalid orientation "'+t+'" for '+this.type+'. Defaulting to "vertical."'),e="vertical"),e);var e},t.prototype._setContainerHeight=function(){if(!this._isVertical&&this._isGrouped){var t=this.element,e=t.offsetHeight;e?((e-=this._getScrollBarWidth())<0&&(e=0),this._container.style.height=e+"px"):this._addVisibilityListener(this._setContainerHeight.bind(this),t)}},t.prototype._setGroupContainerWidth=function(t){var e=t.scrollWidth;e?t.parentElement.style.width=e+"px":this._addVisibilityListener(this._setGroupContainerWidth.bind(this,t),t)},t.prototype._setGroupContainerPadding=function(t){if(t.offsetHeight){var e=t.firstElementChild,i=e.offsetHeight;i?t.style.paddingTop=i+"px":this._addVisibilityListener(this._setGroupContainerPadding.bind(this,t),e)}else this._addVisibilityListener(this._setGroupContainerPadding.bind(this,t),t)},t.prototype._getScrollBarWidth=function(){var t=this._document,e=t.body,i=t.createElement("div"),s=t.createElement("div"),n=i.style,o=s.style;n.width=n.height=o.height="100px",o.width="50px",o.position="absolute",o.top=o.left="0px",o.visibility=o.overflow="hidden",s.insertBefore(i,null),e.insertBefore(s,null);var r=i.offsetHeight;o.overflow="scroll";var a=i.offsetHeight;return r===a&&(a=s.clientHeight),e.removeChild(s),r-a},t.prototype._addVisibilityListener=function(e,t){var i,s=this,n=this._visibilityRemoveListeners;i=this.dom.whenVisible(this.utils.requestAnimationFrame.bind(this,function(){e();var t=n.indexOf(i);-1!==t&&n.splice(t,1),0===n.length&&s.element.removeAttribute(A)}),t),0===n.length&&this.element.setAttribute(A,""),n.push(i)},t._inject={_document:r,_window:o,_compat:n,_animator:a,_Promise:s,_TemplateControlFactory:l},t}(plat.ui.TemplateControl);t.Listview=Ct,plat.register.control(E,Ct);var xt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.templateString='<div class="plat-navbar-left">\n    <div class="plat-navbar-items" plat-control="'+L+'" plat-context="left">\n        <div class="plat-navbar-item" plat-control="'+k+'" plat-options="{ html: content, compile: true }" plat-tap="leftAction(@index)"></div>\n    </div>\n</div>\n<div class="plat-navbar-center">\n    <div class="plat-navbar-items" plat-control="'+L+'" plat-context="center">\n        <div class="plat-navbar-item" plat-control="'+k+'" plat-options="{ html: content, compile: true }" plat-tap="centerAction(@index)"></div>\n    </div>\n</div>\n<div class="plat-navbar-right">\n    <div class="plat-navbar-items" plat-control="'+L+'" plat-context="right">\n        <div class="plat-navbar-item" plat-control="'+k+'" plat-options="{ html: content, compile: true }" plat-tap="rightAction(@index)"></div>\n    </div>\n</div>\n',t.context={left:[{content:"",action:ot}],center:[{content:"",action:ot}],right:[{content:"",action:ot}]},t.hasOwnContext=!0,t._overrides={left:!1,center:!1,right:!1},t}return __extends(t,e),t.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,P+" "+(t||""))},t.prototype.initialize=function(){this.setClasses()},t.prototype.setTemplate=function(){var t=this.utils.isNull,e=this.innerTemplate;if(!t(e))for(var i,s,n=this._document,o=this._overrides,r=Array.prototype.slice,a=this.dom.appendChildren,l=r.call(e.childNodes),h=this.element,u=r.call(h.children);0<l.length;)if((i=l.shift()).nodeType===Node.ELEMENT_NODE)switch(i.nodeName.toLowerCase()){case"left":o.left=!0,(s=n.createElement("div")).className=P+"-left",s.setAttribute(I,"left"),h.replaceChild(a(r.call(i.childNodes),s),u[0]);break;case"center":o.center=!0,(s=n.createElement("div")).className=P+"-center",s.setAttribute(I,"center"),h.replaceChild(a(r.call(i.childNodes),s),u[1]);break;case"right":o.right=!0,(s=n.createElement("div")).className=P+"-right",s.setAttribute(I,"right"),h.replaceChild(a(r.call(i.childNodes),s),u[2])}},t.prototype.loaded=function(){var t=(this.options||{}).value||{},e=this.utils.isString(t.position)&&"bottom"===t.position.toLowerCase()?"-bottom":"-top";this.dom.addClass(this.element,P+e)},t.prototype.setLeft=function(t){this._setComponent("left",t)},t.prototype.setCenter=function(t){this._setComponent("center",t)},t.prototype.setRight=function(t){this._setComponent("right",t)},t.prototype.leftAction=function(t,e){this._executeAction(e,"left",t)},t.prototype.centerAction=function(t,e){this._executeAction(e,"center",t)},t.prototype.rightAction=function(t,e){this._executeAction(e,"right",t)},t.prototype._setComponent=function(t,e){var i=this.context;if(!this.utils.isArray(e)){if(this._overrides[t])return this._parseComponent(e),void(i[t]=e);e=[e]}for(var s=e.length;0<s--;)this._parseComponent(e[s],i[t][s]);i[t]=e},t.prototype._parseComponent=function(t,e){var i,s,n,o,r=this.utils,a=r.isObject,l=a(e);if(l&&r.isUndefined(t.content)&&(t.content=e.content),r.isFunction(t.action)||(t.action=l?e.action:ot),a(i=t.customActions))for(o=(s=Object.keys(i)).length;0<o--;)this[n=s[o]]=i[n]},t.prototype._executeAction=function(t,e,i){var s=this.utils,n=this.context[e];s.isArray(n)&&!s.isNull(i)&&(n=n[i]),s.isFunction(n.action)?n.action(t):this._log.debug("An action function is not defined for the component "+n+".")},t._inject={_document:r},t}(plat.ui.TemplateControl);t.Navbar=xt,plat.register.control(P,xt,null,!0);var Tt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.templateString='<div plat-control="'+f+'" class="plat-image-ring"></div>\n',t._isBackground=!1,t._img=t._document.createElement("img"),t}return __extends(t,e),t.prototype.setClasses=function(t,e){this.dom.addClass(e||this.element,N+" "+(t||""))},t.prototype.initialize=function(){this.setClasses()},t.prototype.loaded=function(){var t,e=this.element,i=this.utils,s=i.isString,n=i.isObject,o=this.attributes,r=this.options;if(s(t=o[z]))o.observe(this._setSrc,z);else{if(!s(t=o.src))return;o.observe(this._setSrc,"src")}n(r)&&n(r.value)&&(this._isBackground=!0===r.value.isBackground),this._isBackground&&this.dom.addClass(e,v+"background"),this._loader=e.firstElementChild,this._NodeManagerStatic.hasMarkup(t)||this._setSrc(t)},t.prototype._setSrc=function(t,e){var i=this,s=this._img,n=this.element,o=this.dom,r=v+"load-image",a=N+"-error",l=this._loader;o.addClass(s,r),s.src=t,s.onload=function(){i.utils.requestAnimationFrame(function(){if(o.removeClass(n,a),i._isBackground)return n.style.backgroundImage='url("'+t+'")',n.contains(s)&&n.removeChild(s),void(n.contains(l)&&n.removeChild(l));o.removeClass(s,r),n.contains(l)&&n.removeChild(l)})},s.onerror=function(){i.utils.requestAnimationFrame(function(){o.addClass(n,a),n.contains(s)&&n.removeChild(s),n.contains(l)&&n.removeChild(l)})},n.insertBefore(l,null),n.insertBefore(s,null)},t._inject={_compat:n,_document:r,_NodeManagerStatic:"$NodeManagerStatic"},t}(plat.ui.TemplateControl);t.Image=Tt,plat.register.control(N,Tt)}(platui||(platui={})),module.exports=platui;